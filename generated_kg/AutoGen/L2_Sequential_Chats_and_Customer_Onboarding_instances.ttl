# Execution time: 99.65 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The source code contains runtime/control constructs (lambda functions, boolean flags, SDK functions, and explicit sender/recipient roles) that are not expressible directly with existing classes/properties. These are captured as literal strings in Config and Prompt descriptions where possible.
# - The ontology does not provide explicit properties for "sender" vs "recipient" of a Task or a chat turn. To preserve this information, sender/recipient are encoded in dcterms:description on Task individuals.
# - The ontology does not provide a property for "summary method" or structured "summary args" on Task; these are modeled as Config individuals attached to Tasks via :hasConfig and the detailed summary prompt is modeled as a :Prompt.
# - The ontology's :performedByAgent property restricts range to :LLMAgent; because some chat senders are human (customer_proxy_agent) we used beam:participatedIn and humanParticipatedIn to capture participation for human agents and beam:participatedIn for agent participation. We avoid using :performedByAgent for human senders.
# - The ontology cannot represent executable code or lambdas; any such logic (e.g., is_termination_msg lambda) is preserved as a string literal in corresponding Config individuals.
# - Numeric and boolean runtime parameters (max_turns, clear_history, code_execution_config, human_input_mode) are stored as :Config entries using :configKey and :configValue (values encoded as strings) because the ontology lacks dedicated data properties for these.
# - No new classes or properties were added. All modeling used only existing classes/properties.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@base <http://www.w3id.org/agentic-ai/onto#> .

############################################################
# Language model
############################################################

:LM_gpt3_5_turbo rdf:type :LanguageModel ;
    dcterms:title "gpt-3.5-turbo" ;
    dcterms:description "{\"model\": \"gpt-3.5-turbo\"}" .

############################################################
# Prompts (system and task prompts)
############################################################

:prompt_onboarding_personal_info_system rdf:type :Prompt ;
    :promptInstruction "You are a helpful customer onboarding agent,\nyou are here to help new customers get started with our product.\nYour job is to gather customer's name and location.\nDo not ask for other information. Return 'TERMINATE' \nwhen you have gathered all the information." ;
    :promptOutputIndicator "TERMINATE" ;
    dcterms:title "Onboarding Personal Information Agent system message" ;
    dcterms:description "System message provided when constructing the Onboarding Personal Information Agent." .

:prompt_onboarding_topic_preference_system rdf:type :Prompt ;
    :promptInstruction "You are a helpful customer onboarding agent,\nyou are here to help new customers get started with our product.\nYour job is to gather customer's preferences on news topics.\nDo not ask for other information.\nReturn 'TERMINATE' when you have gathered all the information." ;
    :promptOutputIndicator "TERMINATE" ;
    dcterms:title "Onboarding Topic Preference Agent system message" ;
    dcterms:description "System message provided when constructing the Onboarding Topic preference Agent." .

:prompt_customer_engagement_system rdf:type :Prompt ;
    :promptInstruction "You are a helpful customer service agent\nhere to provide fun for the customer based on the user's\npersonal information and topic preferences.\nThis could include fun facts, jokes, or interesting stories.\nMake sure to make it engaging and fun!\nReturn 'TERMINATE' when you are done." ;
    :promptOutputIndicator "TERMINATE" ;
    dcterms:title "Customer Engagement Agent system message" ;
    dcterms:description "System message provided when constructing the Customer Engagement Agent." .

:prompt_task_collect_personal_info rdf:type :Prompt ;
    :promptInstruction "Hello, I'm here to help you get started with our product. Could you tell me your name and location?" ;
    :promptContext "initial chat message from Onboarding Personal Information Agent to customer proxy" ;
    dcterms:title "Task prompt: collect personal info" ;
    dcterms:description "User-facing message content for the personal information collection chat turn." .

:prompt_task_collect_topic_preferences rdf:type :Prompt ;
    :promptInstruction "Great! Could you tell me what topics you are interested in reading about?" ;
    :promptContext "chat message from Onboarding Topic preference Agent to customer proxy" ;
    dcterms:title "Task prompt: collect topic preferences" ;
    dcterms:description "User-facing message content for the topic preference collection chat turn." .

:prompt_task_customer_proxy_send_to_engagement rdf:type :Prompt ;
    :promptInstruction "Let's find something fun to read." ;
    :promptContext "message from the customer proxy to the Customer Engagement Agent" ;
    dcterms:title "Customer proxy message to engagement agent" ;
    dcterms:description "User-facing message to request engagement content." .

:prompt_summary_customer_info_json rdf:type :Prompt ;
    :promptInstruction "Return the customer information into as JSON object only: {'name': '', 'location': ''}" ;
    :promptOutputIndicator "JSON object with keys 'name' and 'location'" ;
    dcterms:title "Summary prompt: extract customer info as JSON" ;
    dcterms:description "Summary prompt used after the personal information chat to produce a compact JSON artifact." .

############################################################
# Agents
############################################################

:onboarding_personal_information_agent rdf:type :LLMAgent ;
    rdfs:label "Onboarding Personal Information Agent" ;
    :agentID "onboarding_personal_information_agent" ;
    :agentRole "personal_information_collector" ;
    :agentPrompt :prompt_onboarding_personal_info_system ;
    :hasAgentConfig :cfg_onboarding_personal_llm_config, :cfg_onboarding_personal_codeexec_config, :cfg_onboarding_personal_human_input_mode ;
    :useLanguageModel :LM_gpt3_5_turbo ;
    dcterms:description "LLM-based agent built to gather customer's name and location. Configured with llm_config {\"model\": \"gpt-3.5-turbo\"}." .

:cfg_onboarding_personal_llm_config rdf:type :Config ;
    :configKey "llm_config" ;
    :configValue "{\"model\": \"gpt-3.5-turbo\"}" ;
    dcterms:description "LLM configuration as provided in the source: llm_config={\"model\": \"gpt-3.5-turbo\"}" .

:cfg_onboarding_personal_codeexec_config rdf:type :Config ;
    :configKey "code_execution_config" ;
    :configValue "False" ;
    dcterms:description "Indicates code execution disabled for this agent (code_execution_config=False)." .

:cfg_onboarding_personal_human_input_mode rdf:type :Config ;
    :configKey "human_input_mode" ;
    :configValue "NEVER" ;
    dcterms:description "Indicates human input mode set to NEVER for this agent." .

:onboarding_topic_preference_agent rdf:type :LLMAgent ;
    rdfs:label "Onboarding Topic preference Agent" ;
    :agentID "onboarding_topic_preference_agent" ;
    :agentRole "topic_preference_collector" ;
    :agentPrompt :prompt_onboarding_topic_preference_system ;
    :hasAgentConfig :cfg_onboarding_topic_llm_config, :cfg_onboarding_topic_codeexec_config, :cfg_onboarding_topic_human_input_mode ;
    :useLanguageModel :LM_gpt3_5_turbo ;
    dcterms:description "LLM-based agent built to gather customer topic preferences. Configured with llm_config {\"model\": \"gpt-3.5-turbo\"}." .

:cfg_onboarding_topic_llm_config rdf:type :Config ;
    :configKey "llm_config" ;
    :configValue "{\"model\": \"gpt-3.5-turbo\"}" ;
    dcterms:description "LLM configuration for topic preference agent." .

:cfg_onboarding_topic_codeexec_config rdf:type :Config ;
    :configKey "code_execution_config" ;
    :configValue "False" ;
    dcterms:description "Indicates code execution disabled for this agent." .

:cfg_onboarding_topic_human_input_mode rdf:type :Config ;
    :configKey "human_input_mode" ;
    :configValue "NEVER" ;
    dcterms:description "Indicates human input mode set to NEVER for this agent." .

:customer_engagement_agent rdf:type :LLMAgent ;
    rdfs:label "Customer Engagement Agent" ;
    :agentID "customer_engagement_agent" ;
    :agentRole "engagement_generator" ;
    :agentPrompt :prompt_customer_engagement_system ;
    :hasAgentConfig :cfg_customer_engagement_llm_config, :cfg_customer_engagement_codeexec_config, :cfg_customer_engagement_human_input_mode, :cfg_customer_engagement_is_termination_msg ;
    :useLanguageModel :LM_gpt3_5_turbo ;
    dcterms:description "LLM-based agent that produces engaging content (fun facts, jokes, stories) using collected customer information and topic preferences. Termination is detected by message content matching 'terminate'." .

:cfg_customer_engagement_llm_config rdf:type :Config ;
    :configKey "llm_config" ;
    :configValue "{\"model\": \"gpt-3.5-turbo\"}" ;
    dcterms:description "LLM configuration for customer engagement agent." .

:cfg_customer_engagement_codeexec_config rdf:type :Config ;
    :configKey "code_execution_config" ;
    :configValue "False" ;
    dcterms:description "Indicates code execution disabled for this agent." .

:cfg_customer_engagement_human_input_mode rdf:type :Config ;
    :configKey "human_input_mode" ;
    :configValue "NEVER" ;
    dcterms:description "Indicates human input mode set to NEVER for this agent." .

:cfg_customer_engagement_is_termination_msg rdf:type :Config ;
    :configKey "is_termination_msg" ;
    :configValue "lambda msg: \"terminate\" in msg.get(\"content\").lower()" ;
    dcterms:description "Termination detection logic provided as a literal string; source code used a lambda function to check occurrence of 'terminate' in the message content." .

:customer_proxy_agent rdf:type :HumanAgent ;
    rdfs:label "customer_proxy_agent" ;
    :agentID "customer_proxy_agent" ;
    :agentRole "customer_proxy" ;
    :hasAgentConfig :cfg_customer_proxy_llm_config, :cfg_customer_proxy_codeexec_config, :cfg_customer_proxy_human_input_mode, :cfg_customer_proxy_is_termination_msg ;
    dcterms:description "Human proxy representing the customer. Human input mode ALWAYS. Termination detection implemented by lambda in code; preserved as literal." .

:cfg_customer_proxy_llm_config rdf:type :Config ;
    :configKey "llm_config" ;
    :configValue "False" ;
    dcterms:description "Indicates no LLM backing for customer proxy (llm_config=False in source)." .

:cfg_customer_proxy_codeexec_config rdf:type :Config ;
    :configKey "code_execution_config" ;
    :configValue "False" ;
    dcterms:description "Code execution disabled for customer proxy." .

:cfg_customer_proxy_human_input_mode rdf:type :Config ;
    :configKey "human_input_mode" ;
    :configValue "ALWAYS" ;
    dcterms:description "Human input mode set to ALWAYS for the customer proxy." .

:cfg_customer_proxy_is_termination_msg rdf:type :Config ;
    :configKey "is_termination_msg" ;
    :configValue "lambda msg: \"terminate\" in msg.get(\"content\").lower()" ;
    dcterms:description "Termination detection logic preserved as string for the human proxy." .

############################################################
# Tasks (chat turns)
############################################################

:task_collect_personal_info rdf:type :Task ;
    dcterms:title "Collect Personal Information (chat turn 1)" ;
    dcterms:description "sender: onboarding_personal_information_agent; recipient: customer_proxy_agent; summary_method: reflection_with_llm; summary_args: { 'summary_prompt': \"Return the customer information into as JSON object only: {'name': '', 'location': ''}\" }; max_turns: 2; clear_history: True" ;
    :taskPrompt :prompt_task_collect_personal_info ;
    :hasConfig :cfg_task1_max_turns, :cfg_task1_clear_history, :cfg_task1_summary_method ;
    :producedResource :resource_customer_info_json ;
    dcterms:comment "This Task models the chat where the onboarding personal information agent asks the customer for name and location." .

:cfg_task1_max_turns rdf:type :Config ;
    :configKey "max_turns" ;
    :configValue "2" ;
    dcterms:description "Maximum chat turns allowed for this task (max_turns=2)." .

:cfg_task1_clear_history rdf:type :Config ;
    :configKey "clear_history" ;
    :configValue "True" ;
    dcterms:description "Indicates chat history is cleared after this task (clear_history=True)." .

:cfg_task1_summary_method rdf:type :Config ;
    :configKey "summary_method" ;
    :configValue "reflection_with_llm" ;
    dcterms:description "Indicates the summary method used on the chat history." .

:resource_customer_info_json rdf:type beam:Instance ;
    dcterms:title "Customer information JSON" ;
    dcterms:description "Structured output expected from summary: JSON object of the form {'name': '', 'location': ''}." .

# second chat (topic preference)
:task_collect_topic_preferences rdf:type :Task ;
    dcterms:title "Collect Topic Preferences (chat turn 2)" ;
    dcterms:description "sender: onboarding_topic_preference_agent; recipient: customer_proxy_agent; summary_method: reflection_with_llm; max_turns: 1; clear_history: False" ;
    :taskPrompt :prompt_task_collect_topic_preferences ;
    :hasConfig :cfg_task2_max_turns, :cfg_task2_clear_history, :cfg_task2_summary_method ;
    dcterms:comment "This Task models the chat where the onboarding topic preference agent asks the customer about topics of interest." .

:cfg_task2_max_turns rdf:type :Config ;
    :configKey "max_turns" ;
    :configValue "1" ;
    dcterms:description "Maximum chat turns allowed for this task (max_turns=1)." .

:cfg_task2_clear_history rdf:type :Config ;
    :configKey "clear_history" ;
    :configValue "False" ;
    dcterms:description "Indicates chat history is not cleared after this task (clear_history=False)." .

:cfg_task2_summary_method rdf:type :Config ;
    :configKey "summary_method" ;
    :configValue "reflection_with_llm" ;
    dcterms:description "Summary method for topic preference task." .

# third chat (customer proxy -> engagement)
:task_customer_proxy_to_engagement rdf:type :Task ;
    dcterms:title "Customer Proxy to Engagement Agent (chat turn 3)" ;
    dcterms:description "sender: customer_proxy_agent; recipient: customer_engagement_agent; message: \"Let's find something fun to read.\"; summary_method: reflection_with_llm; max_turns: 1" ;
    :taskPrompt :prompt_task_customer_proxy_send_to_engagement ;
    :hasConfig :cfg_task3_max_turns, :cfg_task3_summary_method ;
    dcterms:comment "This Task models the customer proxy asking the engagement agent to provide fun content based on collected info." .

:cfg_task3_max_turns rdf:type :Config ;
    :configKey "max_turns" ;
    :configValue "1" ;
    dcterms:description "Maximum chat turns for the engagement request task." .

:cfg_task3_summary_method rdf:type :Config ;
    :configKey "summary_method" ;
    :configValue "reflection_with_llm" ;
    dcterms:description "Summary method used in this task." .

############################################################
# Participation links (agents participated in tasks)
############################################################

# For LLM agents, use beam:participatedIn to indicate they participate in tasks (as senders/active agents).
:onboarding_personal_information_agent beam:participatedIn :task_collect_personal_info .
:onboarding_topic_preference_agent beam:participatedIn :task_collect_topic_preferences .
:customer_engagement_agent beam:participatedIn :task_customer_proxy_to_engagement .

# For the human customer proxy, use humanParticipatedIn (subproperty of beam:participatedIn).
:customer_proxy_agent :humanParticipatedIn :task_collect_personal_info, :task_collect_topic_preferences, :task_customer_proxy_to_engagement .

############################################################
# Workflow (sequence of chat steps)
############################################################

:CustomerOnboardingWorkflow rdf:type :WorkflowPattern ;
    dcterms:title "Customer Onboarding Sequential Chats" ;
    :hasWorkflowStep :step1_collect_personal_info, :step2_collect_topic_preferences, :step3_engagement_request ;
    dcterms:description "A workflow pattern composed of three sequential chat steps to onboard a customer: (1) collect personal info, (2) collect topic preferences, (3) request engagement content." .

:step1_collect_personal_info rdf:type :StartStep, :WorkflowStep ;
    :hasAssociatedTask :task_collect_personal_info ;
    :stepOrder 1 ;
    rdfs:label "Step 1: Collect personal info" ;
    :nextStep :step2_collect_topic_preferences ;
    dcterms:description "Start step: the onboarding personal information agent asks for name and location." .

:step2_collect_topic_preferences rdf:type :WorkflowStep ;
    :hasAssociatedTask :task_collect_topic_preferences ;
    :stepOrder 2 ;
    rdfs:label "Step 2: Collect topic preferences" ;
    :nextStep :step3_engagement_request ;
    dcterms:description "Second step: the onboarding topic preference agent asks about news topic preferences." .

:step3_engagement_request rdf:type :WorkflowStep, :EndStep ;
    :hasAssociatedTask :task_customer_proxy_to_engagement ;
    :stepOrder 3 ;
    rdfs:label "Step 3: Customer requests engagement content" ;
    dcterms:description "Final step: customer proxy requests the Customer Engagement Agent produce fun content; agent terminates when done." .

############################################################
# Summary prompt artifact link (task1 summary)
############################################################

# The first task references a summary prompt to produce a JSON resource. 
:task_collect_personal_info :hasPrompt :prompt_summary_customer_info_json .

############################################################
# Additional metadata and relationships
############################################################

# Agents may interact (interactsWith) - preserved if present in code as relationships
# In this notebook agents interact via chats; represent interactions
:onboarding_personal_information_agent :interactsWith :customer_proxy_agent .
:onboarding_topic_preference_agent :interactsWith :customer_proxy_agent .
:customer_engagement_agent :interactsWith :customer_proxy_agent .

# End of instance data.