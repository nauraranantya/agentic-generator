# Execution time: 92.41 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks explicit properties to represent "embedder" vs "language model" distinctions and their parameters (e.g., API-level model names for embeddings vs LLMs). I encoded both as LanguageModel (for gpt-4o) and as Config entries for the embedding model name ("text-embedding-3-small") to preserve fidelity.
# - The ontology has no property for representing environment variables or secret handling semantics. I preserved references to environment variables (process.env.*) as config values, but API keys/credentials are not represented beyond these placeholders.
# - The ontology does not include explicit properties for "conversation thread parameters" (threadId vs resourceId semantics). I represented threads as beam:Instance resources and preserved the literal thread IDs; memoryOptions are modeled as Config instances attached to Tasks.
# - The ontology does not include properties to describe stream behavior (textStream) or async streaming semantics. I preserved the fact of streaming in literal form inside descriptions and promptInstruction fields rather than modeling stream mechanics.
# - The ontology does not provide a dedicated property for "storage connector type" (e.g., MongoDBStore) and "vector store" metadata. I modeled these as Tool individuals with hasToolConfig entries to keep the connection/config semantics.
# - No classes/properties were added or modified; modeling choices used existing classes (Tool, Config, Prompt, Task, Memory, LanguageModel, Instance, Team, etc.) and existing properties only.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .

#################################################################
# System / Team
#################################################################

:mastraSystem a :Team ;
    rdfs:label "Mastra System" ;
    rdfs:comment "Represents the MAStra instance configured with agents: chefAgent and memoryAgent." ;
    :hasAgentMember :chefAgent ;
    :hasAgentMember :memoryAgent ;
    :hasSystemConfig :mastraSystemConfig .

:mastraSystemConfig a :Config ;
    :configKey "mastra.system.agents" ;
    :configValue "chefAgent,memoryAgent" ;
    rdfs:label "Mastra system basic config" .

#################################################################
# Agents
#################################################################

:chefAgent a :LLMAgent ;
    rdfs:label "Chef Agent (instance)" ;
    :agentID "chef-agent" ;
    :agentRole "chef" ;
    :agentPrompt :chefAgentInstructionsPrompt ;
    :useLanguageModel :gpt4o_model ;
    :hasKnowledge :mastraMemory ;
    :hasAgentConfig :chefAgentConfig ;
    :hasAgentCapability :capability_recipe_suggestion ;
    rdfs:comment "Agent constructed as: new Agent({ id: 'chef-agent', name: 'Chef Agent', instructions: <instructions>, model: openai('gpt-4o'), memory })" .

:memoryAgent a :LLMAgent ;
    rdfs:label "Memory Agent (instance)" ;
    :agentID "memory-agent" ;
    :agentRole "memory" ;
    :agentPrompt :memoryAgentInstructionsPrompt ;
    :useLanguageModel :gpt4o_model ;
    :hasKnowledge :mastraMemory ;
    :hasAgentConfig :memoryAgentConfig ;
    :hasAgentCapability :capability_memory_recall ;
    rdfs:comment "Agent constructed as: new Agent({ id: 'memory-agent', name: 'Memory Agent', instructions: <instructions>, model: openai('gpt-4o'), memory })" .

#################################################################
# Language Models and Model Tools
#################################################################

:gpt4o_model a :LanguageModel ;
    rdfs:label "gpt-4o" ;
    rdfs:comment "Language model referenced in code as openai('gpt-4o'). Modeled here as a LanguageModel instance to preserve selection of model." .

:embedding_model_text_embedding_3_small a :LanguageModel ;
    rdfs:label "text-embedding-3-small" ;
    rdfs:comment "Embedding model referenced in code as openai.embedding('text-embedding-3-small'). Represented here as a LanguageModel instance for fidelity." .

:openaiTool a :Tool ;
    rdfs:label "OpenAI SDK (tool)" ;
    :hasToolConfig :openaiToolConfig ;
    rdfs:comment "Representing the usage of the OpenAI SDK via openai(...) calls in the source code." .

:openaiToolConfig a :Config ;
    :configKey "sdk" ;
    :configValue "openai (used as openai('gpt-4o') and openai.embedding('text-embedding-3-small'))" ;
    rdfs:label "OpenAI SDK configuration placeholder" .

#################################################################
# Memory / KnowledgeBase and Storage Tools
#################################################################

:mastraMemory a :Memory ;
    rdfs:label "Mastra Memory (KnowledgeBase instance)" ;
    rdfs:comment "Shared Memory instance used by both agents. Constructed with a MongoDBStore and MongoDBVector, semantic recall options and an embedder." ;
    :hasConfig :memoryConfig ;
    :containsResource :memoryStorageResource .

:memoryConfig a :Config ;
    rdfs:label "Memory options and embedder configuration" ;
    :configKey "lastMessages" ;
    :configValue "10" ;
    ; :configKey "semanticRecall.topK" ; :configValue "3" .
# Because configKey/configValue are single-valued properties per triple, repeat as separate config individuals for each logical setting:

:memoryConfig_lastMessages a :Config ;
    :configKey "lastMessages" ;
    :configValue "10" ;
    rdfs:label "memory option lastMessages" .

:memoryConfig_semanticRecall_topK a :Config ;
    :configKey "semanticRecall.topK" ;
    :configValue "3" ;
    rdfs:label "memory option semanticRecall.topK" .

:memoryConfig_semanticRecall_messageRange a :Config ;
    :configKey "semanticRecall.messageRange" ;
    :configValue "2" ;
    rdfs:label "memory option semanticRecall.messageRange" .

:memoryConfig_embedder a :Config ;
    :configKey "embedder" ;
    :configValue "openai.embedding('text-embedding-3-small')" ;
    rdfs:label "memory embedder config" .

# Storage and vector components implemented as Tools
:mongoDBStore a :Tool ;
    rdfs:label "MongoDBStore (tool)" ;
    rdfs:comment "Storage backend used by Memory.storage in code (MongoDBStore). The code uses process.env.MONGODB_URI and dbName." ;
    :hasToolConfig :mongoDBStoreConfig .

:mongoDBStoreConfig a :Config ;
    :configKey "url" ;
    :configValue "process.env.MONGODB_URI" ;
    rdfs:label "MongoDBStore URL (env variable placeholder)" .

:mongoDBStoreConfig_dbName a :Config ;
    :configKey "dbName" ;
    :configValue "process.env.MONGODB_DB_NAME || 'mastra_memory'" ;
    rdfs:label "MongoDBStore dbName configuration (default mastra_memory)" .

:mongoDBVector a :Tool ;
    rdfs:label "MongoDBVector (vector store tool)" ;
    rdfs:comment "Vector store used for semantic recall via MongoDB-backed vectors (MongoDBVector)." ;
    :hasToolConfig :mongoDBVectorConfig .

:mongoDBVectorConfig a :Config ;
    :configKey "uri" ;
    :configValue "process.env.MONGODB_URI" ;
    rdfs:label "MongoDBVector uri (env variable placeholder)" .

:mongoDBVectorConfig_dbName a :Config ;
    :configKey "dbName" ;
    :configValue "process.env.MONGODB_DB_NAME || 'mastra_memory'" ;
    rdfs:label "MongoDBVector dbName configuration (default mastra_memory)" .

# Memory instance references its storage & vector tools
:mastraMemory :hasConfig :memoryConfig_lastMessages, :memoryConfig_semanticRecall_topK, :memoryConfig_semanticRecall_messageRange, :memoryConfig_embedder ;
              rdfs:comment "Memory configuration broken into multiple Config individuals to preserve each key/value pair." ;
              :hasConfig :mongoDBStoreConfig, :mongoDBStoreConfig_dbName, :mongoDBVectorConfig, :mongoDBVectorConfig_dbName .

#################################################################
# Capabilities
#################################################################

:capability_recipe_suggestion a :Capability ;
    rdfs:label "Recipe suggestion" ;
    rdfs:comment "Capability: suggest recipes and high-level steps given available ingredients; described by the Chef Agent instructions." .

:capability_memory_recall a :Capability ;
    rdfs:label "Memory recall and conversation continuity" ;
    rdfs:comment "Capability: recall past messages and maintain long-running conversation states." .

#################################################################
# Prompts (Agent Instructions + Task prompts)
#################################################################

:chefAgentInstructionsPrompt a :Prompt ;
    rdfs:label "Chef Agent instructions (system prompt)" ;
    :promptInstruction """You are Michel, a practical and experienced home chef who helps people cook great meals with whatever ingredients they have available. Your first priority is understanding what ingredients and equipment the user has access to, then suggesting achievable recipes. You explain cooking steps clearly and offer substitutions when needed, maintaining a friendly and encouraging tone throughout.""" ;
    rdfs:comment "From code: instructions passed to the Chef Agent constructor." .

:memoryAgentInstructionsPrompt a :Prompt ;
    rdfs:label "Memory Agent instructions (system prompt)" ;
    :promptInstruction """You are an AI agent with the ability to automatically recall memories from previous interactions. You may have conversations that last hours, days, months, or years. If you don't know it already you should ask for the users name and some info about them.""" ;
    rdfs:comment "From code: instructions passed to the Memory Agent constructor." .

# Prompt used in chat.ts initial system message (includes dynamic timestamp in source; preserved as template)
:chatSystemMessagePrompt a :Prompt ;
    rdfs:label "Chat system message (chat.ts)" ;
    :promptInstruction """Chat with user started now ${new Date().toISOString()}. Don't mention this message. This means some time may have passed between this message and the one before. The user left and came back again. Say something to start the conversation up again.""" ;
    rdfs:comment "Used as the initial system message in src/chat.ts before starting an interactive loop. Template includes runtime timestamp generation in the code; here preserved as literal template string." .

# Prompts used in index.ts for Chef interactions
:chefInitialIngredientsPrompt a :Prompt ;
    rdfs:label "Chef initial ingredients prompt" ;
    :promptInstruction """In my kitchen I have: pasta, canned tomatoes, garlic, olive oil, and some dried herbs (basil and oregano). What can I make? Please keep your answer brief, only give me the high level steps.""" ;
    rdfs:comment "First prompt in src/index.ts to chefAgent.stream(...)." .

:chefFriendsIngredientsPrompt a :Prompt ;
    rdfs:label "Chef friend's ingredients prompt" ;
    :promptInstruction """Now I'm over at my friend's house, and they have: chicken thighs, coconut milk, sweet potatoes, and some curry powder.""" ;
    rdfs:comment "Second prompt in src/index.ts to chefAgent.stream(...)." .

:chefMemoryQueryPrompt a :Prompt ;
    rdfs:label "Chef memory query prompt" ;
    :promptInstruction """What did we cook before I went to my friends house?""" ;
    rdfs:comment "Third prompt in src/index.ts that includes memoryOptions: { lastMessages: 3 } in the stream call." .

#################################################################
# Conversation Threads & Resources
#################################################################

:resource_SOME_USER_ID a beam:Resource ;
    rdfs:label "SOME_USER_ID" ;
    rdfs:comment "Resource identifier used as memory.resource in stream calls (literal string 'SOME_USER_ID' in code)." .

# Explicit conversation thread instances used in chat.ts (two commented alternatives preserved)
:thread_39873fbf_84d6_425e_8c1b_8afd798d72a4 a beam:Instance ;
    rdfs:label "thread:39873fbf-84d6-425e-8c1b-8afd798d72a4" ;
    rdfs:comment "Specific thread ID used in src/chat.ts (explicit assignment in code). Represented as a beam:Instance to model a conversation thread." .

:thread_random_uuid_example a beam:Instance ;
    rdfs:label "thread:randomUUID()" ;
    rdfs:comment "In code a randomUUID() is used; example placeholder preserved." .

#################################################################
# Tasks (interactions and stream calls)
#################################################################

:task_chef_initialQuery a :Task ;
    rdfs:label "Chef initial recipe suggestion task" ;
    :taskPrompt :chefInitialIngredientsPrompt ;
    :performedByAgent :chefAgent ;
    :requiresResource :resource_SOME_USER_ID ;
    :producedResource :recipeSuggestion_1 ;
    :hasConfig :chefInitialTaskConfig ;
    rdfs:comment "Represents the first stream() call in src/index.ts to the chef agent with threadId and resourceId." .

:chefInitialTaskConfig a :Config ;
    :configKey "call.params" ;
    :configValue "threadId: randomUUID(), resourceId: 'SOME_USER_ID'" .

:task_chef_friendsQuery a :Task ;
    rdfs:label "Chef friend's ingredients recipe suggestion task" ;
    :taskPrompt :chefFriendsIngredientsPrompt ;
    :performedByAgent :chefAgent ;
    :requiresResource :resource_SOME_USER_ID ;
    :producedResource :recipeSuggestion_2 ;
    :hasConfig :chefFriendsTaskConfig ;
    rdfs:comment "Represents the second stream() call in src/index.ts to the chef agent with the same threadId/resourceId." .

:chefFriendsTaskConfig a :Config ;
    :configKey "call.params" ;
    :configValue "threadId: same as previous, resourceId: 'SOME_USER_ID'" .

:task_chef_memoryQuery a :Task ;
    rdfs:label "Chef memory query task (asks what was cooked earlier)" ;
    :taskPrompt :chefMemoryQueryPrompt ;
    :performedByAgent :chefAgent ;
    :requiresResource :resource_SOME_USER_ID ;
    :producedResource :recipeMemoryAnswer_1 ;
    :hasConfig :chefMemoryQueryConfig ;
    rdfs:comment "Represents the third stream() call in src/index.ts that includes memoryOptions: { lastMessages: 3 }." .

:chefMemoryQueryConfig a :Config ;
    :configKey "memoryOptions.lastMessages" ;
    :configValue "3" ;
    rdfs:label "Memory options used in chef memory query" .

# Chat agent tasks (interactive loop)
:task_chat_initialSystemMessage a :Task ;
    rdfs:label "Chat initial system message task" ;
    :taskPrompt :chatSystemMessagePrompt ;
    :performedByAgent :memoryAgent ;
    :requiresResource :resource_SOME_USER_ID ;
    :producedResource :welcomeMessage_1 ;
    rdfs:comment "Initial system message in src/chat.ts invoking memoryAgent.stream([...system message...], { memory: { resource, thread } })." .

:task_chat_interactiveLoop a :Task ;
    rdfs:label "Chat interactive loop task" ;
    :performedByAgent :memoryAgent ;
    :requiresResource :resource_SOME_USER_ID ;
    :hasConfig :chatInteractiveLoopConfig ;
    rdfs:comment "Represents the ongoing interactive loop in src/chat.ts where user input is read and forwarded to memoryAgent.stream(prompt, { memory: { thread, resource } })." .

:chatInteractiveLoopConfig a :Config ;
    :configKey "loop.implementation" ;
    :configValue "CLI Readline loop with stream() calls writing to stdout for each chunk in textStream" ;
    rdfs:label "Interactive loop implementation note" .

#################################################################
# Produced Resources / Outputs
#################################################################

:recipeSuggestion_1 a beam:Resource ;
    rdfs:label "Recipe suggestion: pasta-based suggestions" ;
    :promptOutputIndicator "High-level steps for recipes matching: pasta, canned tomatoes, garlic, olive oil, dried herbs" ;
    rdfs:comment "Represents the output resource expected from chefAgent when given the initial ingredients prompt." .

:recipeSuggestion_2 a beam:Resource ;
    rdfs:label "Recipe suggestion: chicken-curry suggestions" ;
    :promptOutputIndicator "High-level steps for recipes matching: chicken thighs, coconut milk, sweet potatoes, curry powder" ;
    rdfs:comment "Represents the output resource expected from chefAgent when given friend's ingredients." .

:recipeMemoryAnswer_1 a beam:Resource ;
    rdfs:label "Memory-based recipe recall" ;
    :promptOutputIndicator "Answer describing what was cooked previously in the same conversation context" ;
    rdfs:comment "Represents the resource returned when chefAgent asks memory for previous cooking activity using memoryOptions." .

:welcomeMessage_1 a beam:Resource ;
    rdfs:label "Welcome/restart message" ;
    :promptOutputIndicator "Short message to restart conversation after user returns, per chat.ts system prompt" ;
    rdfs:comment "Produced by memoryAgent in response to the system message in chat.ts." .

#################################################################
# Relationships between tools, memory and agents
#################################################################

# Agents use tools & memory (modeled with existing properties)
:chefAgent :agentToolUsage :openaiTool, :mongoDBStore ;
chefAgent :agentResourceUsage :resource_SOME_USER_ID .

:memoryAgent :agentToolUsage :openaiTool, :mongoDBVector, :mongoDBStore ;
memoryAgent :agentResourceUsage :resource_SOME_USER_ID .

# Knowledge base contains storage resources (non-exhaustive)
:mastraMemory :containsResource :mongoDBStore, :mongoDBVector .

#################################################################
# Additional documentation / metadata preserved from code
#################################################################

:src_index_ts a :Instance ;
    rdfs:label "Source file: src/index.ts (semantic representation)" ;
    rdfs:comment """Sequence represented:
1) Call chefAgent.stream('In my kitchen I have: pasta,...', { threadId, resourceId })
2) Call chefAgent.stream('Now I'm over at my friend's house,...', { threadId, resourceId })
3) Call chefAgent.stream('What did we cook before I went to my friends house?', { threadId, resourceId, memoryOptions: { lastMessages: 3 } })
Note: Logging and streaming of textStream to stdout is part of the runtime behavior; preserved as descriptive metadata here.""" .

:src_chat_ts a :Instance ;
    rdfs:label "Source file: src/chat.ts (semantic representation)" ;
    rdfs:comment """Sequence represented:
1) Initialize thread variable (randomUUID() or hard-coded examples).
2) Use memoryAgent.stream([...system message...], { memory: { resource, thread } }) to start conversation.
3) Enter interactive loop reading user messages and calling memoryAgent.stream(prompt, { memory: { thread, resource } }) repeatedly.
Note: Behavior preserves the usage of 'thread' and 'resource' to scope memories across sessions.""" .

#################################################################
# End of instance population
#################################################################