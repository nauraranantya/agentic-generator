# Execution time: 122.63 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - Missing/partial source: The implementation for "guessVerifierAgent" was referenced in mastra/index.ts but its source code was not provided. I created a placeholder agent individual with minimal metadata; its detailed instructions, model, memory, and config are unknown.
# - Loop/suspend/resume semantics: The ontology does not provide explicit constructs for workflow control constructs such as "do until" loops, or explicit "suspend"/"resume" state objects. These execution semantics are preserved in human-readable descriptions attached to the corresponding Task and WorkflowStep instances (dc:description). A consuming system will need to interpret these descriptions to reconstruct control flow.
# - Runtime parameters and SDK concepts: Framework/runtime-specific constructs (e.g., call signatures, TypeScript/Zod schemas, function names, or exact SDK objects) cannot be represented directly. I kept exact prompt text, model identifiers, memory options, and configuration values as literals on Prompt and Config instances so an implementer can reconstruct equivalent runtime behavior.
# - Memory/vector tooling mapping: The code uses objects such as LibSQLVector and LibSQLStore and an embedding model. The ontology lacks a detailed Memory/Vector/Storage modeling pattern beyond Tool, Config and KnowledgeBase. I modeled these as Tool and Config instances and attached them to Agents and Memory instances. Some low-level runtime options (e.g., the "thread" concept) are preserved as literal config values on the Memory Config.
# - Data type fidelity: Some outputs (e.g., boolean gameWon) are kept as described properties and as produced Resource instances; boolean semantics must be enforced by the runtime when reconstructing the system.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dct: <http://purl.org/dc/terms/> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# System / Team: Mastra
#################################################################

:MastraSystem rdf:type :Team ;
    rdfs:label "Mastra (agentic system)" ;
    dct:description "Top-level system instance that composes agents, workflows, storage and logger used by the Heads-Up example." ;
    :hasAgentMember :FamousPersonAgent , :GameAgent , :GuessVerifierAgent ;
    :hasWorkflowPattern :HeadsUpWorkflow ;
    :hasSystemConfig :MastraStorageConfig .

:MastraStorageConfig rdf:type :Config ;
    rdfs:label "Mastra storage config" ;
    :configKey "storage.id" ;
    :configValue "heads-up-game-storage" ;
    dct:description "System-level storage configuration used by Mastra (file-backed LibSQL)." .

#################################################################
# Language Models (statistical models referenced)
#################################################################

:GPT4oModel rdf:type :LanguageModel ;
    rdfs:label "gpt-4o" ;
    dct:description "Language model identifier used for agent text generation (openai('gpt-4o'))." .

:TextEmbedding3SmallModel rdf:type :LanguageModel ;
    rdfs:label "text-embedding-3-small" ;
    dct:description "Embedding model identifier used for memory embedding (openai.embedding('text-embedding-3-small'))." .

#################################################################
# Tools and Resource Storage
#################################################################

:LibSQLStoreTool rdf:type :Tool ;
    rdfs:label "LibSQLStore (storage)" ;
    dct:description "Persistent storage provider used by the Mastra system to store observability and memory state (file:../mastra.db)." ;
    :hasToolConfig :LibSQLStoreConfig .

:LibSQLStoreConfig rdf:type :Config ;
    rdfs:label "LibSQLStoreConfig" ;
    :configKey "url" ;
    :configValue "file:../mastra.db" ;
    dct:description "Connection URL for LibSQLStore used by the system." .

:LibSQLVectorTool rdf:type :Tool ;
    rdfs:label "LibSQLVector (vector DB adapter)" ;
    dct:description "Vector store adapter used by agent Memory to store/retrieve embeddings." ;
    :hasToolConfig :LibSQLVectorConfig .

:LibSQLVectorConfig rdf:type :Config ;
    rdfs:label "LibSQLVectorConfig" ;
    :configKey "connectionUrl" ;
    :configValue "file:../mastra.db" ;
    dct:description "Connection URL for LibSQLVector instance (file:../mastra.db)." .

#################################################################
# Knowledge / Memory
#################################################################

:FamousPersonMemory rdf:type :Memory ;
    rdfs:label "Famous person generator memory" ;
    dct:description """Memory used by the Famous Person Generator agent.
- vector store adapter: LibSQLVector (connectionUrl: file:../mastra.db)
- embedder model: text-embedding-3-small
- memory options (semanticRecall.topK=10, messageRange=1, lastMessages=5)
- memory resource ID in code: 'heads-up-game'
- thread name in code: 'famous-person-generator'""" ;
    :hasConfig :FamousPersonMemory_OptionsConfig .

:FamousPersonMemory_OptionsConfig rdf:type :Config ;
    rdfs:label "FamousPersonMemoryOptions" ;
    :configKey "memory.options" ;
    :configValue "{\"lastMessages\":5,\"semanticRecall\":{\"topK\":10,\"messageRange\":1},\"resource\":\"heads-up-game\",\"thread\":\"famous-person-generator\"}" ;
    dct:description "Serialized memory options from the agent instantiation code." .

#################################################################
# Agents (LLMAgents)
#################################################################

:FamousPersonAgent rdf:type :LLMAgent ;
    rdfs:label "Famous Person Generator (agent)" ;
    :agentID "famous-person-generator" ;
    :agentRole "generator" ;
    dct:description "Agent that generates the name of a famous person for the Heads-Up game. Uses memory to avoid repeating names." ;
    :agentPrompt :FamousPersonAgentPrompt ;
    :useLanguageModel :GPT4oModel ;
    :hasKnowledge :FamousPersonMemory ;
    :agentToolUsage :LibSQLVectorTool ;
    :agentResourceUsage :HeadsUpGameDBResource ;
    :hasAgentConfig :FamousPersonAgent_ModelConfig , :FamousPersonAgent_MemoryConfig .

:FamousPersonAgentPrompt rdf:type :Prompt ;
    rdfs:label "Famous Person Generator - Agent Instructions" ;
    :promptInstruction """You are a famous person generator for a "Heads Up" guessing game.

Generate the name of a well-known famous person who:
- Is recognizable to most people
- Has distinctive characteristics that can be described with yes/no questions
- Is appropriate for all audiences
- Has a clear, unambiguous name

IMPORTANT: Use your memory to check what famous people you've already suggested and NEVER repeat a person you've already suggested.

Examples: Albert Einstein, BeyoncÃ©, Leonardo da Vinci, Oprah Winfrey, Michael Jordan

Return only the person's name, nothing else.""" ;
    :promptContext "Agent instructions and constraints for generating a single famous person's name." .

:FamousPersonAgent_ModelConfig rdf:type :Config ;
    rdfs:label "FamousPersonAgentModelConfig" ;
    :configKey "model" ;
    :configValue "gpt-4o" ;
    dct:description "Model used by the Famous Person Generator agent." .

:FamousPersonAgent_MemoryConfig rdf:type :Config ;
    rdfs:label "FamousPersonAgentMemoryConfig" ;
    :configKey "memory.embedder" ;
    :configValue "text-embedding-3-small" ;
    dct:description "Embedder and memory options used by the agent; summarized for reconstruction." .

:GameAgent rdf:type :LLMAgent ;
    rdfs:label "Game Agent" ;
    :agentID "game-agent" ;
    :agentRole "game-assistant" ;
    dct:description "Agent that answers yes/no questions and evaluates guesses during the Heads-Up game. Knows the famous person's name but must not reveal it." ;
    :agentPrompt :GameAgentPrompt ;
    :useLanguageModel :GPT4oModel ;
    :hasAgentConfig :GameAgent_ModelConfig .

:GameAgentPrompt rdf:type :Prompt ;
    rdfs:label "Game Agent - Agent Instructions" ;
    :promptInstruction """You are a helpful game assistant for a "Heads Up" guessing game.

CRITICAL: You know the famous person's name but you must NEVER reveal it in any response.

When a user asks a question about the famous person:
- Answer truthfully based on the famous person provided
- Keep responses concise and friendly
- NEVER mention the person's name, even if it seems natural
- NEVER reveal gender, nationality, or other characteristics unless specifically asked about them
- Answer yes/no questions with clear "Yes" or "No" responses
- Be consistent - same question asked differently should get the same answer
- Ask for clarification if a question is unclear
- If multiple questions are asked at once, ask them to ask one at a time

When they make a guess:
- If correct: Congratulate them warmly
- If incorrect: Politely correct them and encourage them to try again

Encourage players to make a guess when they seem to have enough information.

You must return a JSON object with:
- response: Your response to the user
- gameWon: true if they guessed correctly, false otherwise""" ;
    :promptContext "Agent instructions and required structured JSON output (response, gameWon)." .

:GameAgent_ModelConfig rdf:type :Config ;
    rdfs:label "GameAgentModelConfig" ;
    :configKey "model" ;
    :configValue "gpt-4o" ;
    dct:description "Model used by the Game Agent." .

:GuessVerifierAgent rdf:type :LLMAgent ;
    rdfs:label "Guess Verifier Agent (placeholder)" ;
    :agentID "guess-verifier-agent" ;
    :agentRole "verifier" ;
    dct:description "Placeholder agent referenced in system composition. Implementation source not provided; details (instructions, model, memory, config) are unknown." .

#################################################################
# Workflow Pattern: Heads-Up Workflow and Steps
#################################################################

:HeadsUpWorkflow rdf:type :WorkflowPattern ;
    rdfs:label "heads-up-workflow" ;
    dct:description "Workflow that implements the Heads-Up guessing game. The workflow: start-step -> repeated game-step until gameWon -> win-step. The 'do until' loop must be interpreted by the runtime as: repeat game-step until the 'gameWon' output becomes true." ;
    :hasWorkflowStep :StartWorkflowStep , :GameWorkflowStep , :WinWorkflowStep .

### Workflow Steps

:StartWorkflowStep rdf:type :StartStep ;
    rdfs:label "start-step" ;
    :stepOrder 1 ;
    :hasAssociatedTask :StartTask ;
    :nextStep :GameWorkflowStep ;
    dct:description "Initial step that requests generation of a famous person's name and initializes guessCount to 0." .

:GameWorkflowStep rdf:type :WorkflowStep ;
    rdfs:label "game-step" ;
    :stepOrder 2 ;
    :hasAssociatedTask :GameTask ;
    :nextStep :WinWorkflowStep ;
    dct:description """Main interactive loop step. Behavior:
- If no resumeData.userMessage: suspend the workflow with a message instructing the user how to play.
- Otherwise: provide the famous person's name and the user message to the Game Agent.
- The Game Agent returns a structured object with 'response' and 'gameWon' boolean.
- Increment guessCount on each resume.
- The workflow engine repeats this step until 'gameWon' == true (dountil semantics).""" .

:WinWorkflowStep rdf:type :EndStep ;
    rdfs:label "win-step" ;
    :stepOrder 3 ;
    :hasAssociatedTask :WinTask ;
    dct:description "Final step that handles game-win logic (logging/returning final outputs)." .

#################################################################
# Tasks representing step behavior
#################################################################

:StartTask rdf:type :Task ;
    rdfs:label "Start Task (generate famous person)" ;
    dct:description """Task logic (semantic description, original source behavior preserved):
- Input: { start: boolean }
- Action: Use the Famous Person Generator agent to 'Generate a famous person's name' with model parameters { temperature: 1.2, topP: 0.9 } and memory context:
  memory.resource = 'heads-up-game', memory.thread = 'famous-person-generator'
- Output: { famousPerson: string, guessCount: 0 }
- Performed by the Famous Person Generator agent.
Notes: The agent must return only the person's name as a plain string. The runtime must strip whitespace and set guessCount to 0.""" ;
    :taskPrompt :StartTaskPrompt ;
    :performedByAgent :FamousPersonAgent ;
    :producedResource :Resource_FamousPerson , :Resource_GuessCount ;
    :requiresResource :HeadsUpGameDBResource ;
    :contributesToObjective :HeadsUpObjective .

:StartTaskPrompt rdf:type :Prompt ;
    rdfs:label "Start Task Prompt" ;
    :promptInstruction "Generate a famous person's name" ;
    :promptContext "Simple generation prompt used by the start step." ;
    :promptOutputIndicator "A single famous person's name as a plain string." .

:GameTask rdf:type :Task ;
    rdfs:label "Game Task (Q/A and guess handling)" ;
    dct:description """Task logic (semantic description, original source preserved):
- Input: { famousPerson: string, guessCount: number }
- Resume Schema: { userMessage: string }
- Suspend Schema: { suspendResponse: string }
- If no resumeData.userMessage: suspend with message "I'm thinking of a famous person. Ask me yes/no questions to figure out who it is!"
- Otherwise, call the Game Agent with an instruction template which provides the famousPerson and the user's message and requests a structured JSON output:
  output: { response: string, gameWon: boolean }
- The structured response's 'gameWon' indicates whether the user guessed correctly.
- Increment guessCount each time the agent is called (for each resume with a userMessage).
- Returns: { famousPerson, gameWon, agentResponse, guessCount }.
- Performed by the Game Agent (the agent must never reveal the famous person's name).
- The runtime must enforce the JSON structure in the agent response and extract 'response' and 'gameWon' fields.""" ;
    :taskPrompt :GameTaskPrompt ;
    :performedByAgent :GameAgent ;
    :producedResource :Resource_AgentResponse , :Resource_GameWon , :Resource_GuessCount ;
    :requiresResource :HeadsUpGameDBResource ;
    :contributesToObjective :HeadsUpObjective .

:GameTaskPrompt rdf:type :Prompt ;
    rdfs:label "Game Task Prompt (template)" ;
    :promptInstruction """
        The famous person is: ${famousPerson}
        The user said: "${userMessage}"
        Please respond appropriately. If this is a guess, tell me if it's correct.
      """ ;
    :promptContext "Template prompt provided with placeholders ${famousPerson} and ${userMessage}." ;
    :promptOutputIndicator """Structured JSON object with:
- response: string
- gameWon: boolean
Note: The Game Agent must return a JSON object conforming to this shape.""" .

:WinTask rdf:type :Task ;
    rdfs:label "Win Task (finalization)" ;
    dct:description """Finalization task:
- Input: { famousPerson: string, gameWon: boolean, agentResponse: string, guessCount: number }
- Action: Log/return the final values (famousPerson, gameWon, guessCount) and complete the workflow.
- In the original source, this step writes console.log messages for the famousPerson, gameWon and guessCount.
- Output: { famousPerson, gameWon, guessCount }.
Notes: No agent call required for this step in the provided implementation.""" ;
    :producedResource :Resource_FamousPerson , :Resource_GameWon , :Resource_GuessCount ;
    :contributesToObjective :HeadsUpObjective .

#################################################################
# Resources (data/artifacts created or consumed)
#################################################################

:HeadsUpGameDBResource rdf:type beam:Instance ;
    rdfs:label "heads-up-game" ;
    dct:description "Persistent memory/resource ID used by FamousPersonAgent and by the workflow memory thread 'famous-person-generator'." .

:Resource_FamousPerson rdf:type beam:Instance ;
    rdfs:label "famousPerson (resource)" ;
    dct:description "String resource holding the generated famous person's name produced by the start-step task." .

:Resource_GuessCount rdf:type beam:Instance ;
    rdfs:label "guessCount (resource)" ;
    dct:description "Integer resource tracking the number of guesses made by the user; produced & updated by the workflow." .

:Resource_AgentResponse rdf:type beam:Instance ;
    rdfs:label "agentResponse (resource)" ;
    dct:description "String resource containing the textual response from the Game Agent on a user question or guess." .

:Resource_GameWon rdf:type beam:Instance ;
    rdfs:label "gameWon (resource)" ;
    dct:description "Boolean-like resource indicating whether the game has been won (true) or not (false). The runtime must treat this as a boolean flag produced by the Game Agent's structured output." .

#################################################################
# Workflow Objective(s)
#################################################################

:HeadsUpObjective rdf:type :Objective ;
    rdfs:label "Heads-Up game objective" ;
    dct:description "Objective: run an interactive Heads-Up guessing game to let the user identify a famous person via yes/no questions and guesses." ;
    :contributesToGoal :PlayGameGoal .

:PlayGameGoal rdf:type :Goal ;
    rdfs:label "Play Heads-Up Game" ;
    dct:description "Top-level goal for the workflow/system: enable a complete game session and determine if the player guesses the famous person correctly." .

#################################################################
# Links between workflow steps/tasks and agents/tools
#################################################################

### Associate workflow steps with their tasks (already set above via hasAssociatedTask on Step instances),
### associate tasks with agents via performedByAgent and link usages of tools/resources.

#################################################################
# Miscellaneous notes preserved as descriptions
#################################################################

# End of TTL instance data.