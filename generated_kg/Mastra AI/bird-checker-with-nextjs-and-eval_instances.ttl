# Execution time: 147.07 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks a dedicated property/class to represent structured input schemas (e.g., zod schemas). I stored the tool input schema as a Config (configKey/configValue) literal.
# - The ontology has no explicit class or property to express "evaluation" artifacts or scoring functions in a structured manner. I modeled the eval run as a Task with producedResource describing expected vs. actual outputs.
# - There is no property for external API endpoints (Unsplash API) or code execution details; these are represented as Config or description literals.
# - No property exists to capture typed enumerations; enum values (query options) are preserved as literal lists in Config.
# - Implementation / framework details (Next.js UI components, exact code, function names) were intentionally omitted per instructions; server vs client separation is represented only where semantically meaningful (environment type, system config).
# - No new classes or properties were created; items that cannot be modeled precisely are represented as literals on existing Config/Prompt/Resource individuals.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dct: <http://purl.org/dc/terms/> .

###############################################################################
# System / Deployment
###############################################################################

:MastraDeployment rdf:type :Team ;
    rdfs:label "Mastra Deployment (Bird Checker)" ;
    :hasAgentMember :birdAgent ;
    :hasSystemConfig :MastraSystemConfig ;
    dct:description "Deployment of the Bird Checker composed using Mastra: maps an agent id to a running LLM agent component." .

:MastraSystemConfig rdf:type :Config ;
    rdfs:label "Mastra system config" ;
    :configKey "agents" ;
    :configValue "{ 'birdAgent': 'bird-agent' }" ;
    dct:description "Mapping of agents as defined in src/mastra/index.ts (mastra.agents)." .

:WebEnvironment rdf:type :Environment ;
    rdfs:label "Web UI Environment" ;
    :envType "nextjs + browser UI (visualization of images, interactive tags)" ;
    dct:description "Operational environment of the Bird Checker (user selects tags in UI which trigger image retrieval and agent analysis)." .

###############################################################################
# Goals / Objectives
###############################################################################

:IdentifyBirdsGoal rdf:type :Goal ;
    rdfs:label "Identify birds and species from images" ;
    dct:description "Primary goal: determine whether images contain birds, identify species when present, and summarize the location." .

:Objective_AccuracyCheck rdf:type :Objective ;
    rdfs:label "Accuracy evaluation objective" ;
    dct:description "Objective to measure whether the agent identifies birds and species correctly (used by evaluation)." ;
    :contributesToGoal :IdentifyBirdsGoal .

###############################################################################
# Agents, Language Models, Capabilities, Knowledge
###############################################################################

:birdAgent rdf:type :LLMAgent ;
    rdfs:label "Bird Agent" ;
    :agentID "bird-agent" ;
    :agentRole "analyze images to detect birds, identify species and location" ;
    :agentPrompt :BirdAgent_InstructionsPrompt ;
    :hasAgentConfig :BirdAgent_Config ;
    :useLanguageModel :Claude3Model ;
    :hasKnowledge :BirdExamplesKB ;
    :hasAgentCapability :AnalyzeImageCapability ;
    :operatesIn :WebEnvironment ;
    dct:description "LLM-based agent used to inspect an image and return a structured bird detection response." .

:Claude3Model rdf:type :LanguageModel ;
    rdfs:label "anthropic/claude-3-haiku-20240307" ;
    dct:description "Language model selected for the agent (string as appears in source code)." .

:AnalyzeImageCapability rdf:type :Capability ;
    rdfs:label "analyze image (detect bird, species, location)" ;
    dct:description "Capability assigned to birdAgent: view image, determine if a bird is present, return species scientific name and a short human-readable location summary." .

:BirdAgent_Config rdf:type :Config ;
    rdfs:label "Bird Agent Config" ;
    :configKey "model" ;
    :configValue "anthropic(claude-3-haiku-20240307)" ;
    dct:description "Agent configuration indicating model choice. (From agents/index.ts)" .

:BirdAgent_InstructionsPrompt rdf:type :Prompt ;
    rdfs:label "Bird Agent Instructions (agent-level)" ;
    :promptContext "agent instructions (default context for agent)" ;
    :promptInstruction "You can view an image and figure out if it is a bird or not. You can also figure out the species of the bird and where the picture was taken." ;
    :promptOutputIndicator "{ bird: boolean, species: string, location: string }" ;
    dct:description "High-level instruction string from the agent definition (keeps agent behavior consistent across tasks)." .

:BirdExamplesKB rdf:type :KnowledgeBase ;
    rdfs:label "Bird detection examples (IMAGES dataset)" ;
    dct:description "Small dataset / examples used by evaluation and tests. Contains sample images and expected outputs as literals." .

###############################################################################
# Tools
###############################################################################

:GetRandomImageTool rdf:type :Tool ;
    rdfs:label "Get a random image from unsplash" ;
    dct:description "Gets a random image from Unsplash based on the selected option (query enum). Declared as a tool in src/mastra/tools." ;
    :hasToolConfig :GetRandomImageTool_Config ;
    :hasCapability :FetchImageCapability ;
    :resourceUsage :UnsplashAPI_Resource .

:FetchImageCapability rdf:type :Capability ;
    rdfs:label "fetch random image from Unsplash" ;
    dct:description "Tool capability: call Unsplash search API for a random image matching provided query and return a selected image object." .

:GetRandomImageTool_Config rdf:type :Config ;
    rdfs:label "GetRandomImage tool config" ;
    :configKey "inputSchema" ;
    :configValue "z.object({ query: z.enum(['wildlife','feathers','flying','birds']) })" ;
    dct:description "Input schema for the tool (preserved as literal). Implementation calls Unsplash REST API; network and key managed at runtime." .

:UnsplashAPI_Resource rdf:type beam:Resource ;
    rdfs:label "Unsplash API (external resource)" ;
    dct:description "External API used by GetRandomImageTool: https://api.unsplash.com/search/photos" ;
    dct:reference "https://api.unsplash.com/search/photos" .

###############################################################################
# Prompts and Prompted Tasks (image-level)
###############################################################################

:AnalyzeImagePrompt rdf:type :Prompt ;
    rdfs:label "Analyze image prompt (task-level)" ;
    :promptInstruction """view this image and let me know if it's a bird or not, and the scientific name of the bird without any explanation. Also summarize the location for this picture in one or two short sentences understandable by a high school student""" ;
    :promptInputData "imageUrl" ;
    :promptOutputIndicator "z.object({ bird: z.boolean(), species: z.string(), location: z.string() })" ;
    dct:description "Prompt text sent with the image to the agent (from src/lib/mastra/actions.promptClaude user message - exact wording preserved)." .

###############################################################################
# Tasks and Produced/Required Resources
###############################################################################

:Task_GetRandomImage rdf:type :Task ;
    rdfs:label "Get Random Image Task" ;
    dct:description "Task to fetch a random image from Unsplash using a user-selected query option (wildlife, feathers, flying, birds)." ;
    :performedBy :GetRandomImageTool ;
    :producedResource :ImageResource_Generic ;
    :requiresResource :UnsplashAPI_Resource ;
    :requiresCapability :FetchImageCapability .

:ImageResource_Generic rdf:type beam:Instance, beam:Resource ;
    rdfs:label "Image resource (unsplash result)" ;
    dct:description "A resource that represents an image object returned by Unsplash. Contains URLs and photographer attribution in the runtime system; structurally represented here as a generic resource." .

:Task_AnalyzeImage rdf:type :Task ;
    rdfs:label "Analyze Image Task" ;
    dct:description "Task to analyze an image and determine whether it is a bird, the species scientific name, and a short location summary. Implemented via the birdAgent (agent.generate with an image and a text instruction)." ;
    :performedByAgent :birdAgent ;
    :requiresResource :ImageResource_Generic ;
    :taskPrompt :AnalyzeImagePrompt ;
    :producedResource :BirdResponseResource ;
    :requiresCapability :AnalyzeImageCapability .

:BirdResponseResource rdf:type beam:Resource ;
    rdfs:label "BirdResponse (structured agent output)" ;
    dct:description "Structured output format expected from the agent: { bird: boolean, species: string, location: string }." ;
    dct:title "BirdResponse" .

###############################################################################
# Workflow pattern and steps
###############################################################################

:BirdCheckerWorkflow rdf:type :WorkflowPattern ;
    rdfs:label "Bird Checker Workflow Pattern" ;
    dct:description "High-level workflow: Start -> Get Image -> Analyze Image -> End. Describes how UI tags trigger image fetch and analysis by the agent." ;
    :hasWorkflowStep :Step_Start, :Step_GetImage, :Step_AnalyzeImage, :Step_End .

:Step_Start rdf:type :StartStep ;
    rdfs:label "Start" ;
    :stepOrder 1 ;
    dct:description "Initial step: user loads the UI or triggers a tag click (e.g., 'wildlife')." ;
    :nextStep :Step_GetImage .

:Step_GetImage rdf:type :WorkflowStep ;
    rdfs:label "Get image" ;
    :stepOrder 2 ;
    :hasAssociatedTask :Task_GetRandomImage ;
    :nextStep :Step_AnalyzeImage ;
    dct:description "Selects a tag value -> call tool to fetch a random image for that query." .

:Step_AnalyzeImage rdf:type :WorkflowStep ;
    rdfs:label "Analyze image" ;
    :stepOrder 3 ;
    :hasAssociatedTask :Task_AnalyzeImage ;
    :nextStep :Step_End ;
    dct:description "Sends the image and analysis prompt to the birdAgent; returns structured BirdResponse." .

:Step_End rdf:type :EndStep ;
    rdfs:label "End" ;
    :stepOrder 4 ;
    dct:description "Terminal step; UI displays results and attribution to the photographer." .

###############################################################################
# Sample dataset resources (IMAGES used by evaluation)
###############################################################################

:Image_IsBird rdf:type beam:Instance, beam:Resource ;
    rdfs:label "IMAGES.isBird image (sample)" ;
    dct:description "Sample image expected to be a bird (IMAGES.isBird in src/lib/evals/data.ts)." ;
    dct:reference "https://images.unsplash.com/photo-1730510011925-e064a259f722?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w2NzI1Mzd8MHwxfHNlYXJjaHwxN3x8ZmVhdGhlcnN8ZW58MHx8Mnx8MTczMTQyMjI5MXww&ixlib=rb-4.0.3&q=80&w=1080" ;
    dct:title "isBird sample" ;
    dct:description "expected bird: true; expected species: Ardea herodias" .

:Image_NotBird rdf:type beam:Instance, beam:Resource ;
    rdfs:label "IMAGES.notBird image (sample)" ;
    dct:description "Sample image expected to NOT be a bird (IMAGES.notBird in src/lib/evals/data.ts)." ;
    dct:reference "https://images.unsplash.com/photo-1470848051974-964b789cb6fa?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w2NzI1Mzd8MHwxfHNlYXJjaHwzNXx8d2lsZGxpZmV8ZW58MHx8fHwxNzMyMTIwMTMyfDA&ixlib=rb-4.0.3&q=80&w=1080" ;
    dct:title "notBird sample" ;
    dct:description "expected bird: false; expected species: Panthera leo" .

###############################################################################
# Evaluation task that uses agent to score outputs
###############################################################################

:Task_Eval_BirdDetection rdf:type :Task ;
    rdfs:label "Bird detection evaluation (Is a bird)" ;
    dct:description "Evaluation task that runs the agent on sample images and compares results to expected labels and species. Mirrors src/lib/evals/index.eval.ts." ;
    :requiresResource :Image_IsBird, :Image_NotBird ;
    :performedByAgent :birdAgent ;
    :producedResource :EvalResults_BirdDetection ;
    :contributesToObjective :Objective_AccuracyCheck .

:EvalResults_BirdDetection rdf:type beam:Resource ;
    rdfs:label "Evaluation results (bird detection)" ;
    dct:description "Contains scoring results for the evaluation (containsScorer: checks bird boolean and that species string contains expected scientific name). Represented as a resource literal in the system." .

###############################################################################
# Misc artifacts (UI-related metadata, tags)
###############################################################################

:Tag_Wildlife rdf:type beam:Instance ;
    rdfs:label "tag:wildlife" ;
    dct:description "Tag option presented in UI: 'wildlife'." .

:Tag_Feathers rdf:type beam:Instance ;
    rdfs:label "tag:feathers" ;
    dct:description "Tag option presented in UI: 'feathers'." .

:Tag_Flying rdf:type beam:Instance ;
    rdfs:label "tag:flying" ;
    dct:description "Tag option presented in UI: 'flying'." .

:Tag_Birds rdf:type beam:Instance ;
    rdfs:label "tag:birds" ;
    dct:description "Tag option presented in UI: 'birds'." .

###############################################################################
# Associations and other semantic links
###############################################################################

# Agent <-> Goal
:birdAgent :hasAgentGoal :IdentifyBirdsGoal .

# System/Team <-> Workflow
:MastraDeployment :hasWorkflowPattern :BirdCheckerWorkflow .

# Tool config pointer to env var usage (literal)
:GetRandomImageTool_Config :configKey "unsplash_api" ;
    :configValue "Uses NEXT_PUBLIC_UNSPLASH_ACCESS_KEY at runtime; performs search/photos with query, random page and order_by relevant/latest" ;
    dct:description "Notes about request construction (page randomization, order_by option) preserved from implementation in system-tools.ts." .

# Tool uses bond to the Image resource produced
:Task_GetRandomImage :producedResource :ImageResource_Generic .

# The analyze task expects the BirdResponse format
:Task_AnalyzeImage :producedResource :BirdResponseResource .

# Agent knowledge base contains the sample images (for eval)
:BirdExamplesKB dct:description "Contains at least two sample images used for evaluation (Image_IsBird, Image_NotBird)" .
:BirdExamplesKB rdf:type :KnowledgeBase .
:BirdExamplesKB rdfs:seeAlso :Image_IsBird, :Image_NotBird .

# Evaluation task contribution
:Task_Eval_BirdDetection :contributesToObjective :Objective_AccuracyCheck .

# Additional configs: tool runtime hints and UI mapping
:UI_Interaction_Config rdf:type :Config ;
    rdfs:label "UI interaction config (tags -> queries)" ;
    :configKey "tagToQuery" ;
    :configValue "{ 'Wildlife' : 'wildlife', 'Feathers' : 'feathers', 'Flying' : 'flying', 'Birds' : 'birds' }" ;
    dct:description "Mapping of UI button tags to tool query enum (used by client code to set the query parameter)." .

###############################################################################
# Labels & human descriptions (preserve fidelity)
###############################################################################

:BirdResponseResource dct:description """Agent output object details:
- bird: boolean -> whether the image contains a bird (yes/no)
- species: string -> scientific name (expected concise, no additional explanation)
- location: string -> one or two short sentences summarizing where picture was taken, understandable by a high school student
(From src/lib/mastra/actions.promptClaude and zod output schema)""" .

:GetRandomImageTool dct:description """Tool configured to:
- Accept named query: one of [wildlife, feathers, flying, birds]
- Call Unsplash search/photos endpoint with that query
- Randomize page (0..19) and order_by (relevant|latest)
- Return a single image object with alt_description, urls (regular/raw), and user attribution
(Implementation details stored as literals in config; code-level details not modeled)""" .

:AnalyzeImagePrompt dct:description "Exact task-level prompt string preserved (see :AnalyzeImagePrompt :promptInstruction). It is sent together with an image payload to the birdAgent." .

###############################################################################
# End of instance data
###############################################################################