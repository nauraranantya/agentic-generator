# Execution time: 73.62 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks specialized classes/properties for structured input/output schemas (e.g., Zod schemas) and for executable logic. I represented schemas and execution logic as Config entries (key/value pairs) attached to Tool and Memory using existing :hasToolConfig / :hasConfig properties.
# - There is no explicit class for "External API" or "Storage backend"; I modeled external services (geocoding, open-meteo) and produced data as beam:Resource instances and memory storage information as Config entries.
# - There is no property to describe the code-level execution mapping (e.g., method bodies, error-throwing). Those semantics are preserved as literal strings in Config entries but not executable.
# - The ontology cannot represent some framework-specific constructs (e.g., use of @mastra/core Agent construction, logger classes, openai(...) factory call). I retained their semantics (agent identity, model name, logger present) as literals in Configs or descriptions.
# - For multi-key configurations, multiple Config individuals are created (one per key/value) since Config is an atomic class with configKey/configValue properties.
# - No new classes or properties were added. Where mapping was not exact, information is preserved as literal text in existing annotation/data properties.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

#################################################################
# Instances describing the Mastra-based Weather Agent solution
#################################################################

### LLMAgent: weather-agent
:weather-agent rdf:type :LLMAgent ;
    rdfs:label "Weather Agent" ;
    :agentID "weather-agent" ;
    :agentRole "Weather assistant" ;
    :useLanguageModel :gpt4o-model ;
    :agentPrompt :weather-agent-prompt ;
    :agentToolUsage :get-weather-tool ;
    :hasKnowledge :weather-agent-memory ;
    :hasAgentConfig :weather-agent-config .
    
# Agent's configuration (high-level runtime info)
:weather-agent-config rdf:type :Config ;
    :configKey "agentInstantiation" ;
    :configValue "Constructed via Mastra Agent with id 'weather-agent', name 'Weather Agent', model openai('gpt-4o'), tools: { get-weather }, memory: LibSQL-backed Memory" .

### Language Model used by the agent
:gpt4o-model rdf:type :LanguageModel ;
    <http://purl.org/dc/terms/title> "gpt-4o" ;
    <http://purl.org/dc/terms/description> "OpenAI model used by the agent via a model factory call openai('gpt-4o'). No further model parameters available in source." .

### Prompt used by the agent (agentPrompt)
:weather-agent-prompt rdf:type :Prompt ;
    rdfs:label "Weather Agent - System Instructions" ;
    :promptInstruction """You are a helpful weather assistant that provides accurate weather information.

Your primary function is to help users get weather details for specific locations. When responding:
- Always ask for a location if none is provided
- If giving a location with multiple parts (e.g. "New York, NY"), use the most relevant part (e.g. "New York")
- Include relevant details like humidity, wind conditions, and precipitation
- Keep responses concise but informative

Use the weatherTool to fetch current weather data.
""" ;
    :promptInputData "location: string — City name (if missing, agent must ask the user for location)" ;
    :promptOutputIndicator "Concise weather response including temperature, feelsLike, humidity, windSpeed, windGust, conditions, and the normalized location name. Also include clarifying question if location absent." .

### Tool: get-weather
:get-weather-tool rdf:type :Tool ;
    rdfs:label "get-weather" ;
    <http://purl.org/dc/terms/description> "Get current weather for a location" ;
    :hasCapability :capability-get-current-weather ;
    :hasToolConfig :get-weather-config-id,
                    :get-weather-config-inputSchema,
                    :get-weather-config-outputSchema,
                    :get-weather-config-execute,
                    :get-weather-config-endpoints,
                    :get-weather-config-errorHandling,
                    :get-weather-config-conditionsMap .

# Tool capability
:capability-get-current-weather rdf:type :Capability ;
    rdfs:label "fetch-current-weather" ;
    rdfs:comment "Capability to obtain current weather information for a specified location by calling geocoding and weather APIs and mapping the response to a structured output." .

# Tool configuration entries (one Config per key/value)
:get-weather-config-id rdf:type :Config ;
    :configKey "id" ;
    :configValue "get-weather" .

:get-weather-config-inputSchema rdf:type :Config ;
    :configKey "inputSchema" ;
    :configValue """zod.object({
  location: z.string().describe("City name")
}) — expects a single parameter 'location' (string).""" .

:get-weather-config-outputSchema rdf:type :Config ;
    :configKey "outputSchema" ;
    :configValue """{
  temperature: number,
  feelsLike: number,
  humidity: number,
  windSpeed: number,
  windGust: number,
  conditions: string,
  location: string
} — tool returns a flattened weather object (units inherited from open-meteo: temperature in °C, wind speed in m/s, humidity as relative humidity percent).""" .

:get-weather-config-execute rdf:type :Config ;
    :configKey "execute" ;
    :configValue """Execution logic summarized:
1. Use geocoding API to resolve 'location' to { latitude, longitude, name } via:
   https://geocoding-api.open-meteo.com/v1/search?name=<encoded location>&count=1
2. If no geocoding result -> throw Error: Location '<location>' not found.
3. Use Open-Meteo forecast endpoint to request current fields:
   https://api.open-meteo.com/v1/forecast?latitude=<latitude>&longitude=<longitude>&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,wind_gusts_10m,weather_code
4. Map response to tool output keys:
   temperature <- data.current.temperature_2m
   feelsLike <- data.current.apparent_temperature
   humidity <- data.current.relative_humidity_2m
   windSpeed <- data.current.wind_speed_10m
   windGust <- data.current.wind_gusts_10m
   conditions <- getWeatherCondition(data.current.weather_code) using local mapping table
   location <- geocoding result name
""" .

:get-weather-config-endpoints rdf:type :Config ;
    :configKey "endpoints" ;
    :configValue """Geocoding endpoint:
https://geocoding-api.open-meteo.com/v1/search?name=<location>&count=1

Weather endpoint:
https://api.open-meteo.com/v1/forecast?latitude=<lat>&longitude=<lon>&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,wind_gusts_10m,weather_code
""" .

:get-weather-config-errorHandling rdf:type :Config ;
    :configKey "errorHandling" ;
    :configValue "If geocoding returns no result -> throw an error (Location '<location>' not found). Otherwise propagate fetch/network errors. Agent should catch and surface to user appropriately." .

:get-weather-config-conditionsMap rdf:type :Config ;
    :configKey "weatherCodeMapping" ;
    :configValue """Mapping of open-meteo weather_code to textual conditions (used by getWeatherCondition):
{
  0: 'Clear sky',
  1: 'Mainly clear',
  2: 'Partly cloudy',
  3: 'Overcast',
  45: 'Foggy',
  48: 'Depositing rime fog',
  51: 'Light drizzle',
  53: 'Moderate drizzle',
  55: 'Dense drizzle',
  56: 'Light freezing drizzle',
  57: 'Dense freezing drizzle',
  61: 'Slight rain',
  63: 'Moderate rain',
  65: 'Heavy rain',
  66: 'Light freezing rain',
  67: 'Heavy freezing rain',
  71: 'Slight snow fall',
  73: 'Moderate snow fall',
  75: 'Heavy snow fall',
  77: 'Snow grains',
  80: 'Slight rain showers',
  81: 'Moderate rain showers',
  82: 'Violent rain showers',
  85: 'Slight snow showers',
  86: 'Heavy snow showers',
  95: 'Thunderstorm',
  96: 'Thunderstorm with slight hail',
  99: 'Thunderstorm with heavy hail'
}
Default: 'Unknown'
""" .

### Memory (KnowledgeBase) used by the agent
:weather-agent-memory rdf:type :Memory ;
    rdfs:label "weather-agent-memory" ;
    rdfs:comment "Memory instance configured with a LibSQLStore; used by the agent for conversation/history storage and options as configured." ;
    :hasConfig :mem-config-storage-id,
                :mem-config-storage-url,
                :mem-config-semanticRecall,
                :mem-config-workingMemory,
                :mem-config-lastMessages .

:mem-config-storage-id rdf:type :Config ;
    :configKey "storage.id" ;
    :configValue "ai-sdk-v5-storage" .

:mem-config-storage-url rdf:type :Config ;
    :configKey "storage.url" ;
    :configValue "file:./mastra.db" .

:mem-config-semanticRecall rdf:type :Config ;
    :configKey "semanticRecall" ;
    :configValue "false" .

:mem-config-workingMemory rdf:type :Config ;
    :configKey "workingMemory.enabled" ;
    :configValue "false" .

:mem-config-lastMessages rdf:type :Config ;
    :configKey "lastMessages" ;
    :configValue "5" .

### Task representing "fetch current weather"
:task-fetch-current-weather rdf:type :Task ;
    rdfs:label "Fetch current weather" ;
    <http://purl.org/dc/terms/description> "Task to fetch current weather for a specified location. Implemented by invoking the 'get-weather' tool. The agent will ask the user for a location if not provided." ;
    :performedByAgent :weather-agent ;
    :performedBy :get-weather-tool ;
    :producedResource :weather-data-resource ;
    :requiresResource :geocoding-api, :open-meteo-api .

# External API resources (modeled as beam:Resource)
:geocoding-api rdf:type beam:Resource ;
    rdfs:label "open-meteo geocoding API" ;
    <http://purl.org/dc/terms/reference> "https://geocoding-api.open-meteo.com/v1/search" ;
    <http://purl.org/dc/terms/description> "Used to translate a location name into coordinates (latitude, longitude) and normalized name." .

:open-meteo-api rdf:type beam:Resource ;
    rdfs:label "open-meteo forecast API" ;
    <http://purl.org/dc/terms/reference> "https://api.open-meteo.com/v1/forecast" ;
    <http://purl.org/dc/terms/description> "Used to fetch current weather metrics including temperature_2m, apparent_temperature, relative_humidity_2m, wind_speed_10m, wind_gusts_10m, weather_code." .

# Produced resource: structured weather data
:weather-data-resource rdf:type beam:Resource ;
    rdfs:label "WeatherData" ;
    <http://purl.org/dc/terms/description> """Structured weather data produced by the 'Fetch current weather' task/tool. Fields:
- temperature: number (°C) from temperature_2m
- feelsLike: number (°C) from apparent_temperature
- humidity: number (%) from relative_humidity_2m
- windSpeed: number (m/s) from wind_speed_10m
- windGust: number (m/s) from wind_gusts_10m
- conditions: string (mapped from weather_code)
- location: string (normalized place name from geocoding result)
""" .

#################################################################
# Meta / runtime (logger, platform) described as configs (no SDK classes)
#################################################################

:mastra-runtime rdf:type beam:System ;
    rdfs:label "Mastra runtime (descriptive)" ;
    <http://purl.org/dc/terms/description> "Descriptive instance for the runtime that instantiates the agent(s). Not an executable mapping in ontology; used to hold high-level configuration/literals." ;
    :hasConfig :mastra-config-logger, :mastra-config-agents .

:mastra-config-logger rdf:type :Config ;
    :configKey "logger" ;
    :configValue "PinoLogger with name 'Mastra' and level 'info' (used for runtime logging)." .

:mastra-config-agents rdf:type :Config ;
    :configKey "agents" ;
    :configValue "Registered agents: { weatherAgent -> :weather-agent }" .

#################################################################
# Additional linking / provenance
#################################################################

# Record that the weather agent participated in the task (provenance-like)
:weather-agent-participation rdf:type :Task ;
    rdfs:label "weather-agent participation placeholder" ;
    <http://purl.org/dc/terms/description> "A provenance-style record that the agent participates in the fetch current weather task." ;
    :performedByAgent :weather-agent ;
    :producedResource :weather-data-resource .

# End of instances.