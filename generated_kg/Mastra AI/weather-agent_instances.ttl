# Execution time: 105.13 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks explicit constructs for representing structured input/output schemas (e.g., Zod schemas), streaming outputs, and step mapping functions. I represent schemas and mapping logic as literal strings on Prompt and Config individuals.
# - There is no dedicated class/property for "Tool input schema" or "Tool output schema"; I model those as Prompt individuals and attach them to Tools via hasToolConfig and taskPrompt where appropriate.
# - There is no property for "model selection list / fallback" or "maxRetries"; I model such runtime configuration in Config individuals and link them with hasAgentConfig / hasToolConfig / hasSystemConfig.
# - There is no explicit class for "Resource produced by a step" beyond beam:Resource; I use beam:Resource individuals and connect them with producedResource.
# - There is no property to represent streaming responses or programmatic step mapping (.map functions). Those are captured as text in Prompt or Config literals (so the semantics are preserved as text but not executable).
# - I did not model implementation-specific code (TypeScript functions, fetch calls, or SDK specifics). Instead I preserved the logic and parameters (endpoints, schemas, instruction text, behavior rules) as literal descriptions attached to Tools, Tasks, Prompts, Configs, and Resources.
# - No classes or properties were added or modified; only individuals (instances) were added in accordance with the provided ontology.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# System / Team
#################################################################

:mastra-system rdf:type :Team ;
  rdfs:label "Mastra System" ;
  <http://purl.org/dc/terms/title> "Mastra agent-based system" ;
  <http://purl.org/dc/terms/description> "System coordinating weather agents, tools and workflows (Mastra instance configured with LibSQL storage and multiple workflows)." ;
  :hasAgentMember :weatherAgent , :weatherReporterAgent ;
  :hasWorkflowPattern :wf_weather_workflow , :wf_weather_workflow_with_tool_and_agent ;
  :hasSystemConfig :config_mastrasystem_storage .

:config_mastrasystem_storage rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Mastra storage configuration" ;
  :configKey "storage.id" ;
  :configValue "weather-agent-storage" ;
  <http://purl.org/dc/terms/description> "LibSQL storage configuration for Mastra (id and url)" ;
  :configKey "storage.url" ;
  :configValue "file:./mastra.db" .

#################################################################
# Language Models
#################################################################

:lm_openai_gpt4o rdf:type :LanguageModel ;
  rdfs:label "openai:gpt-4o" ;
  <http://purl.org/dc/terms/description> "OpenAI GPT-4o model instance used by agents." .

:lm_openai_gpt4o_mini rdf:type :LanguageModel ;
  rdfs:label "openai:gpt-4o-mini" ;
  <http://purl.org/dc/terms/description> "OpenAI GPT-4o-mini model variant used as alternative." .

:lm_anthropic_claude3_sonnet rdf:type :LanguageModel ;
  rdfs:label "anthropic:claude-3-5-sonnet-20241022" ;
  <http://purl.org/dc/terms/description> "Anthropic Claude model variant used as one of agent's models." .

#################################################################
# Agents
#################################################################

:weatherAgent rdf:type :LLMAgent ;
  :agentID "weather-agent" ;
  rdfs:label "Weather Agent" ;
  <http://purl.org/dc/terms/description> "LLM agent that provides weather information and activity planning. Uses multiple models and the weather tool. MaxRetries = 3. Has instructions for asking location, translating non-English names, including humidity/wind/precipitation, concise responses." ;
  :agentRole "weather assistant" ;
  :agentPrompt :weatherAgent_instructions_prompt ;
  :hasAgentConfig :config_weatherAgent_runtime ;
  :agentToolUsage :weatherTool ;
  :useLanguageModel :lm_anthropic_claude3_sonnet , :lm_openai_gpt4o , :lm_openai_gpt4o_mini .

:weatherAgent_instructions_prompt rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> """
You are a helpful weather assistant that provides accurate weather information.

Your primary function is to help users get weather details for specific locations. When responding:
- Always ask for a location if none is provided
- If the location name isn't in English, please translate it
- If giving a location with multiple parts (e.g. "New York, NY"), use the most relevant part (e.g. "New York")
- Include relevant details like humidity, wind conditions, and precipitation
- Keep responses concise but informative

Use the weatherTool to fetch current weather data.
""" ;
  <http://purl.org/dc/terms/title> "Weather Agent instructions" .

:config_weatherAgent_runtime rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Weather Agent runtime config" ;
  :configKey "maxRetries" ;
  :configValue "3" ;
  :configKey "tools" ;
  :configValue "weatherTool (get-weather)" ;
  <http://purl.org/dc/terms/description> "Agent runtime configuration (model list, tool access and retries). Models: anthropic:claude-3-5-sonnet-20241022, openai:gpt-4o, openai:gpt-4o-mini" .

:weatherReporterAgent rdf:type :LLMAgent ;
  :agentID "weatherExplainerAgent" ;
  rdfs:label "Weather Explainer Agent" ;
  <http://purl.org/dc/terms/description> "Agent that explains weather reports in a reporter style. Receives city input and explains weather like a weather reporter. Uses openai:gpt-4o." ;
  :agentPrompt :weatherReporterAgent_instructions_prompt ;
  :useLanguageModel :lm_openai_gpt4o .

:weatherReporterAgent_instructions_prompt rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> """
You are a weather explainer. You have access to input that will help you get weather-specific activities for any city. 
The tool uses agents to plan the activities, you just need to provide the city. Explain the weather report like a weather reporter.
""" ;
  <http://purl.org/dc/terms/title> "Weather Explainer Agent instructions" .

#################################################################
# Tools
#################################################################

:weatherTool rdf:type :Tool ;
  rdfs:label "get-weather" ;
  <http://purl.org/dc/terms/description> "Tool to get current weather for a location. Wraps geocoding and open-meteo APIs and returns a simplified weather object (temperature, feelsLike, humidity, windSpeed, windGust, conditions, location)." ;
  :hasToolConfig :config_weatherTool_api , :config_weatherTool_schema ;
  :hasCapability :capability_get_weather .

:capability_get_weather rdf:type :Capability ;
  rdfs:label "Fetch current weather capability" ;
  <http://purl.org/dc/terms/description> "Fetches geocoding for a city and retrieves current weather fields. Input: { location: string }. Output: { temperature, feelsLike, humidity, windSpeed, windGust, conditions, location }." .

:config_weatherTool_api rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Weather tool API endpoints" ;
  :configKey "geocoding_url_template" ;
  :configValue "https://geocoding-api.open-meteo.com/v1/search?name={location}&count=1" ;
  :configKey "forecast_url_template" ;
  :configValue "https://api.open-meteo.com/v1/forecast?latitude={lat}&longitude={lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,wind_gusts_10m,weather_code" ;
  <http://purl.org/dc/terms/description> "API templates used internally by the tool to obtain location coordinates and the forecast." .

:config_weatherTool_schema rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Weather tool I/O schemas (Zod-like)" ;
  :configKey "inputSchema" ;
  :configValue "{ location: string }" ;
  :configKey "outputSchema" ;
  :configValue "{ temperature: number, feelsLike: number, humidity: number, windSpeed: number, windGust: number, conditions: string, location: string }" ;
  <http://purl.org/dc/terms/description> "Serialized input/output schema. Represented as strings since the ontology has no structured schema type." .

#################################################################
# Workflow Patterns and Steps (workflow: weather-workflow)
#################################################################

:wf_weather_workflow rdf:type :WorkflowPattern ;
  rdfs:label "weather-workflow" ;
  <http://purl.org/dc/terms/description> "Workflow that fetches weather for a city and plans activities. Input schema: { city: string }. Produces activities text." ;
  :hasWorkflowStep :wf_step_fetch_weather , :wf_step_plan_activities .

:wf_step_fetch_weather rdf:type :WorkflowStep ;
  rdfs:label "fetch-weather step" ;
  <http://purl.org/dc/terms/title> "fetch-weather" ;
  <http://purl.org/dc/terms/description> "Step that obtains a daily forecast for a city. Fetches daily temperature, precipitationChance, and weather codes and produces an array of forecast objects." ;
  :stepOrder 1 ;
  :hasAssociatedTask :task_fetch_weather ;
  :taskPrompt :prompt_fetchWeather_input_schema .

:task_fetch_weather rdf:type :Task ;
  rdfs:label "fetch-weather task" ;
  <http://purl.org/dc/terms/description> "Fetches weather forecast for a given city and produces forecast array resource. Semantics: take city -> produce daily forecast array with fields date, maxTemp, minTemp, precipitationChance, condition, location." ;
  :producedResource :resource_forecast_array ;
  :requiresResource :resource_external_geocoding_api , :resource_external_forecast_api ;
  :performedBy :weatherTool .

:resource_forecast_array rdf:type beam:Resource ;
  rdfs:label "forecast array" ;
  <http://purl.org/dc/terms/description> """
Forecast array produced by fetch-weather:
Array of objects with schema:
[{ date: string, maxTemp: number, minTemp: number, precipitationChance: number, condition: string, location: string }]
""" .

:prompt_fetchWeather_input_schema rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "{ city: string }" ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> "The step expects a trigger containing city name. It will produce daily forecasts for that city." ;
  <http://purl.org/dc/terms/title> "fetch-weather input schema" .

# External resources (APIs) as Resources
:resource_external_geocoding_api rdf:type beam:Resource ;
  rdfs:label "open-meteo geocoding API" ;
  <http://purl.org/dc/terms/reference> "https://geocoding-api.open-meteo.com" ;
  <http://purl.org/dc/terms/description> "Used to convert city names to lat/lon." .

:resource_external_forecast_api rdf:type beam:Resource ;
  rdfs:label "open-meteo forecast API" ;
  <http://purl.org/dc/terms/reference> "https://api.open-meteo.com" ;
  <http://purl.org/dc/terms/description> "Used to fetch daily or hourly forecast values." .

#################################################################
# Workflow Pattern: weather-workflow-with-tool-and-agent
#################################################################

:wf_weather_workflow_with_tool_and_agent rdf:type :WorkflowPattern ;
  rdfs:label "weather-workflow-with-tool-and-agent" ;
  <http://purl.org/dc/terms/description> "Workflow that uses the weather tool to get forecast and then delegates planning to a reporting agent. Input schema: { location: string }" ;
  :hasWorkflowStep :wf2_step_tool_get_weather , :wf2_step_map_prompt , :wf2_step_agent_report .

:wf2_step_tool_get_weather rdf:type :WorkflowStep ;
  rdfs:label "weather step from tool" ;
  <http://purl.org/dc/terms/title> "weatherTool step" ;
  <http://purl.org/dc/terms/description> "A step created from the weather tool. Accepts { location } and returns a forecast-like structure (tool output schema)." ;
  :stepOrder 1 ;
  :hasAssociatedTask :task_weather_tool_call ;
  :taskPrompt :prompt_weatherTool_schema .

:task_weather_tool_call rdf:type :Task ;
  rdfs:label "weather tool call task" ;
  <http://purl.org/dc/terms/description> "Task that calls the get-weather tool. Input: { location: string }. Output: simplified current weather object (temperature, feelsLike, humidity, windSpeed, windGust, conditions, location)." ;
  :performedBy :weatherTool ;
  :producedResource :resource_tool_forecast_current .

:prompt_weatherTool_schema rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "{ location: string }" ;
  <http://www.w3id.org/agentic-ai/onto#promptOutputIndicator> "{ temperature: number, feelsLike: number, humidity: number, windSpeed: number, windGust: number, conditions: string, location: string }" ;
  <http://purl.org/dc/terms/title> "Weather tool I/O schema as prompt-like artifact" .

:resource_tool_forecast_current rdf:type beam:Resource ;
  rdfs:label "current weather (tool output)" ;
  <http://purl.org/dc/terms/description> "Object returned by the weather tool with current weather metrics and location as a string." .

# Mapping step: transforms tool output into a prompt for agent
:wf2_step_map_prompt rdf:type :WorkflowStep ;
  rdfs:label "map prompt step" ;
  <http://purl.org/dc/terms/title> "map prompt" ;
  <http://purl.org/dc/terms/description> "Mapping step that converts the previous step's output into a prompt for the agent. Logic: prompt = 'Forecast data: ' + JSON.stringify(inputData) (from tool). This mapping is represented as a prompt template." ;
  :stepOrder 2 ;
  :taskPrompt :prompt_mapping_forecast_to_agent ;
  :hasAssociatedTask :task_map_to_prompt .

:prompt_mapping_forecast_to_agent rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> "Constructs a prompt string for an agent given forecast data. Template: 'Forecast data: ' + JSON.stringify(inputData)" ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "inputData = tool output (JSON)" ;
  <http://purl.org/dc/terms/title> "map forecast -> agent prompt" .

:task_map_to_prompt rdf:type :Task ;
  rdfs:label "map forecast to prompt task" ;
  <http://purl.org/dc/terms/description> "Takes the tool output and formats a short prompt string for the agent. Produces a single string resource." ;
  :producedResource :resource_agent_input_string ;
  :requiresResource :resource_tool_forecast_current .

:resource_agent_input_string rdf:type beam:Resource ;
  rdfs:label "agent input string" ;
  <http://purl.org/dc/terms/description> "A string like: 'Forecast data: { ... }' that will be provided to the weatherReporterAgent." .

# Agent step that consumes mapped prompt
:wf2_step_agent_report rdf:type :WorkflowStep ;
  rdfs:label "weather reporter agent step" ;
  <http://purl.org/dc/terms/title> "weatherReporterAgent step" ;
  <http://purl.org/dc/terms/description> "Step executed by a reporting agent that explains the weather and provides activities in reporter style. Input: agent input string." ;
  :stepOrder 3 ;
  :hasAssociatedTask :task_agent_explain_weather ;
  :performedByAgent :weatherReporterAgent .

:task_agent_explain_weather rdf:type :Task ;
  rdfs:label "plan activities / explain weather task" ;
  <http://purl.org/dc/terms/description> "Agent task that receives a prompt string and produces an explanatory text and activity suggestions. Uses the agent instruction template that enforces a specific output formatting (emoji sections, weather summary, activities, indoor alternatives, special considerations)." ;
  :requiresResource :resource_agent_input_string ;
  :producedResource :resource_activities_text .

:resource_activities_text rdf:type beam:Resource ;
  rdfs:label "activities text" ;
  <http://purl.org/dc/terms/description> """
Activities textual output produced by agent with a structured format per guidelines:
üìÖ [Day, Month Date, Year]
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üå°Ô∏è WEATHER SUMMARY
‚Ä¢ Conditions: ...
‚Ä¢ Temperature: ...
‚Ä¢ Precipitation: ...

... (sections for MORNING ACTIVITIES, AFTERNOON ACTIVITIES, INDOOR ALTERNATIVES, SPECIAL CONSIDERATIONS)
""" .

#################################################################
# Plan Activities (original weather-workflow planActivities)
#################################################################

:task_plan_activities rdf:type :Task ;
  rdfs:label "plan-activities" ;
  <http://purl.org/dc/terms/description> "Suggests activities based on weather conditions. Input: forecast array (or forecast object). The step constructs a prompt 'Based on the following weather forecast for {location}, suggest appropriate activities: {JSON}' and streams agent response. Produces an activities text resource." ;
  :requiresResource :resource_forecast_array , :resource_agent_input_string ;
  :producedResource :resource_activities_text ;
  :performedByAgent :weatherAgent ;
  :taskPrompt :prompt_planActivities_template .

:prompt_planActivities_template rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> """
Based on the following weather forecast for {location}, suggest appropriate activities:
{forecast_json}
""" ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "forecast_json (stringified forecast array or forecast[0])" ;
  <http://purl.org/dc/terms/title> "planActivities prompt template" .

#################################################################
# Additional resources: weather condition mapping tables (captured as knowledge)
#################################################################

:kb_weather_conditions rdf:type :KnowledgeBase ;
  rdfs:label "Weather condition code mapping" ;
  <http://purl.org/dc/terms/description> """
Mapping of numeric weather_code to textual description used by tool and steps. Example mappings included: 0: 'Clear sky', 1: 'Mainly clear', 2: 'Partly cloudy', 3: 'Overcast', 45: 'Foggy', 48: 'Depositing rime fog', 51: 'Light drizzle', ... 95: 'Thunderstorm', etc.
This knowledge base is referenced by fetch and tool logic when converting numeric weather codes into human-readable conditions.
""" .

#################################################################
# Connections: Which tasks belong to which workflow steps
#################################################################

# Link workflow steps to tasks (redundant with hasAssociatedTask but explicit)
:wf_step_fetch_weather :hasAssociatedTask :task_fetch_weather .
:wf_step_plan_activities :hasAssociatedTask :task_plan_activities .

#################################################################
# Additional Configs capturing the two separate agent definitions in code
#################################################################

:config_new_workflow_agent rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Local workflow-scoped agent configuration" ;
  :configKey "agent.id" ;
  :configValue "weather-agent" ;
  :configKey "agent.name" ;
  :configValue "Weather Agent (workflow-local)" ;
  :configKey "agent.model" ;
  :configValue "openai:gpt-4o" ;
  <http://purl.org/dc/terms/description> "A workflow-local agent instance (same semantic id as system agent). Contains detailed instructions for activity planning with strict output format (emoji sections and headers)." .

:prompt_activity_planner_instructions rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInstruction> """
You are a local activities and travel expert who excels at weather-based planning. Analyze the weather data and provide practical activity recommendations.

For each day in the forecast, structure your response exactly as follows:

üìÖ [Day, Month Date, Year]
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üå°Ô∏è WEATHER SUMMARY
‚Ä¢ Conditions: [brief description]
‚Ä¢ Temperature: [X¬∞C/Y¬∞F to A¬∞C/B¬∞F]
‚Ä¢ Precipitation: [X% chance]

üåÖ MORNING ACTIVITIES
Outdoor:
‚Ä¢ [Activity Name] - [Brief description including specific location/route]
  Best timing: [specific time range]
  Note: [relevant weather consideration]

üåû AFTERNOON ACTIVITIES
Outdoor:
‚Ä¢ [Activity Name] - [Brief description including specific location/route]
  Best timing: [specific time range]
  Note: [relevant weather consideration]

üè† INDOOR ALTERNATIVES
‚Ä¢ [Activity Name] - [Brief description including specific venue]
  Ideal for: [weather condition that would trigger this alternative]

‚ö†Ô∏è SPECIAL CONSIDERATIONS
‚Ä¢ [Any relevant weather warnings, UV index, wind conditions, etc.]

Guidelines:
- Suggest 2-3 time-specific outdoor activities per day
- Include 1-2 indoor backup options
- For precipitation >50%, lead with indoor activities
- All activities must be specific to the location
- Include specific venues, trails, or locations
- Consider activity intensity based on temperature
- Keep descriptions concise but informative

Maintain this exact formatting for consistency, using the emoji and section headers as shown.
""" ;
  <http://purl.org/dc/terms/title> "Activity planner instructions (strict format)" .

# Link the planner prompt to the weatherAgent as an additional prompt used by the agent when planning
:weatherAgent :hasPrompt :prompt_activity_planner_instructions .

#################################################################
# Resources describing schemas for workflows
#################################################################

:workflow_weather_input_prompt rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "{ city: string }" ;
  <http://purl.org/dc/terms/title> "weather-workflow input schema" ;
  <http://purl.org/dc/terms/description> "The workflow expects a city string as trigger input." .

:workflow_weather2_input_prompt rdf:type :Prompt ;
  <http://www.w3id.org/agentic-ai/onto#promptInputData> "{ location: string }" ;
  <http://purl.org/dc/terms/title> "weather-workflow-with-tool-and-agent input schema" ;
  <http://purl.org/dc/terms/description> "The workflow expects a location string that will be passed to the weather tool." .

:wf_weather_workflow :hasPrompt :workflow_weather_input_prompt .
:wf_weather_workflow_with_tool_and_agent :hasPrompt :workflow_weather2_input_prompt .

#################################################################
# Misc / Comments preserved as Configs
#################################################################

:config_comments rdf:type :Config ;
  <http://purl.org/dc/terms/title> "Implementation notes preserved" ;
  <http://purl.org/dc/terms/description> """
Notes captured from source:
- Some code sections instantiate a workflow-local Agent object (same id 'weather-agent') that uses openai('gpt-4o') and enforces a strict output formatting for planning activities.
- The weatherTool wraps external APIs and returns a normalized object for current weather.
- The system stores data in a LibSQLStore (file:./mastra.db).
- Memory and voice features are present in source code comments but not active; they are not modeled besides noting their existence in runtime config placeholders.
- Streaming of agent responses (textStream) is used to incrementally collect output; this is captured as a description in the task prompt but streaming semantics are not expressible in the ontology.
""" .

#################################################################
# End of individuals
#################################################################