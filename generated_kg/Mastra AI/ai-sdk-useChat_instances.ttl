# Execution time: 99.52 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology does not provide a native property to represent code, execution logic, or SDK/runtime details. All executable logic (HTTP calls, streaming behavior, function implementations) is represented as textual descriptions in Prompt or Config literals. This is an intentional limitation (no new properties/classes added).
# - Zod schemas and JavaScript function code are stored as string literals in Config instances (configKey: "inputSchema"/"outputSchema"/"triggerSchema") because the ontology lacks a structured schema class for validation types.
# - Streaming semantics (response.textStream and the incremental output assembly in planActivities) and asynchronous execution details are not modeled as separate runtime constructs; they are preserved only inside prompt/task descriptions.
# - There is no explicit property to mark a WorkflowPattern's trigger schema; hasConfig is reused to attach triggerSchema to the workflow.
# - The fetchWeather step in the workflow contains imperative network calls in source code; that implementation detail is captured in the task prompt/description as a summary and the forecast resource shape. The ontology cannot represent code flow, so exact step-by-step code is omitted.
# - Logger configuration and framework-specific constructs (Mastra, PinoLogger, SDK import references) are intentionally not modeled â€” they are implementation details outside the ontology's scope.
# - If any information appears duplicated across files (e.g., multiple agent objects named similarly), each semantic entity from the code is represented as a separate individual and linked explicitly (e.g., exported weather agent vs. planning agent used inside the workflow).

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

########################################################################
# Language model used by agents
########################################################################

:claude-3-5-sonnet-20241022
    a :LanguageModel ;
    rdfs:label "claude-3-5-sonnet-20241022" ;
    <http://purl.org/dc/terms/description> "Anthropic model identifier used by agents in this solution (as passed to the anthropic SDK in source code)." .

########################################################################
# Tool: get-weather
########################################################################

:get-weather-tool
    a :Tool ;
    rdfs:label "get-weather" ;
    <http://purl.org/dc/terms/title> "get-weather" ;
    <http://purl.org/dc/terms/description> "Get current weather for a location. Tool accepts an input { location: string } and returns an object containing temperature, feelsLike, humidity, windSpeed, windGust, conditions, and location." ;
    :hasCapability :get-weather-capability ;
    :hasToolConfig :getWeatherToolInputSchema, :getWeatherToolOutputSchema .

:get-weather-capability
    a :Capability ;
    rdfs:label "get weather capability" ;
    <http://purl.org/dc/terms/description> "Capability to obtain current weather information for a given location (geocoding + weather API calls, returns normalized weather fields)." .

:getWeatherToolInputSchema
    a :Config ;
    :configKey "inputSchema" ;
    :configValue """z.object({
  location: z.string().describe('City name'),
})""" .

:getWeatherToolOutputSchema
    a :Config ;
    :configKey "outputSchema" ;
    :configValue """z.object({
  temperature: z.number(),
  feelsLike: z.number(),
  humidity: z.number(),
  windSpeed: z.number(),
  windGust: z.number(),
  conditions: z.string(),
  location: z.string(),
})""" .

########################################################################
# Exported agent: weatherAgent (from src/mastra/agents/index.ts)
########################################################################

:weatherAgent
    a :LLMAgent ;
    :agentID "weather-agent" ;
    rdfs:label "Weather Agent" ;
    :agentRole "weather assistant" ;
    :agentPrompt :weatherAgentInstructions ;
    :hasAgentConfig :weatherAgentModelConfig ;
    :agentToolUsage :get-weather-tool ;
    :useLanguageModel :claude-3-5-sonnet-20241022 ;
    <http://purl.org/dc/terms/description> "Agent exported for the system that instructs: provide weather information, ask for location if missing, translate non-English names, prefer most relevant location part, include humidity/wind/precipitation, keep responses concise. Uses the get-weather tool to fetch current weather data." .

:weatherAgentInstructions
    a :Prompt ;
    rdfs:label "Weather Agent Instructions" ;
    :promptInstruction """
      You are a helpful weather assistant that provides accurate weather information.

      Your primary function is to help users get weather details for specific locations. When responding:
      - Always ask for a location if none is provided
      - If the location name isn't in English, please translate it
      - If giving a location with multiple parts (e.g. "New York, NY"), use the most relevant part (e.g. "New York")
      - Include relevant details like humidity, wind conditions, and precipitation
      - Keep responses concise but informative

      Use the weatherTool to fetch current weather data.
    """ .

:weatherAgentModelConfig
    a :Config ;
    :configKey "model" ;
    :configValue "claude-3-5-sonnet-20241022" .

########################################################################
# Internal planning agent used within workflow (src/mastra/workflows/index.ts)
########################################################################

:planningAgent
    a :LLMAgent ;
    rdfs:label "Weather Planning Agent" ;
    :agentID "planning-agent" ;
    :agentPrompt :planningAgentInstructions ;
    :hasAgentConfig :planningAgentModelConfig ;
    :useLanguageModel :claude-3-5-sonnet-20241022 ;
    <http://purl.org/dc/terms/description> "An agent used by the 'plan-activities' workflow step to transform a weather forecast into formatted day-by-day activity suggestions with strict formatting requirements." .

:planningAgentInstructions
    a :Prompt ;
    rdfs:label "Planning Agent Instructions (activity formatting template)" ;
    :promptInstruction """
        You are a local activities and travel expert who excels at weather-based planning. Analyze the weather data and provide practical activity recommendations.

        For each day in the forecast, structure your response exactly as follows:

        ðŸ“… [Day, Month Date, Year]
        â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

        ðŸŒ¡ï¸ WEATHER SUMMARY
        â€¢ Conditions: [brief description]
        â€¢ Temperature: [XÂ°C/YÂ°F to AÂ°C/BÂ°F]
        â€¢ Precipitation: [X% chance]

        ðŸŒ… MORNING ACTIVITIES
        Outdoor:
        â€¢ [Activity Name] - [Brief description including specific location/route]
          Best timing: [specific time range]
          Note: [relevant weather consideration]

        ðŸŒž AFTERNOON ACTIVITIES
        Outdoor:
        â€¢ [Activity Name] - [Brief description including specific location/route]
          Best timing: [specific time range]
          Note: [relevant weather consideration]

        ðŸ  INDOOR ALTERNATIVES
        â€¢ [Activity Name] - [Brief description including specific venue]
          Ideal for: [weather condition that would trigger this alternative]

        âš ï¸ SPECIAL CONSIDERATIONS
        â€¢ [Any relevant weather warnings, UV index, wind conditions, etc.]

        Guidelines:
        - Suggest 2-3 time-specific outdoor activities per day
        - Include 1-2 indoor backup options
        - For precipitation >50%, lead with indoor activities
        - All activities must be specific to the location
        - Include specific venues, trails, or locations
        - Consider activity intensity based on temperature
        - Keep descriptions concise but informative

        Maintain this exact formatting for consistency, using the emoji and section headers as shown.
      """ .

:planningAgentModelConfig
    a :Config ;
    :configKey "model" ;
    :configValue "claude-3-5-sonnet-20241022" .

########################################################################
# Workflow pattern: weather-workflow and its steps/tasks/resources
########################################################################

:weather-workflow
    a :WorkflowPattern ;
    rdfs:label "weather-workflow" ;
    :hasWorkflowStep :fetch-weather-step, :plan-activities-step ;
    :hasConfig :weatherWorkflowTriggerSchema ;
    <http://purl.org/dc/terms/description> "Workflow that fetches a weather forecast for a given city, then plans activities based on the forecast." .

:weatherWorkflowTriggerSchema
    a :Config ;
    :configKey "triggerSchema" ;
    :configValue """z.object({
  city: z.string().describe('The city to get the weather for'),
})""" .

# Workflow step 1: fetch-weather
:fetch-weather-step
    a :WorkflowStep ;
    rdfs:label "fetch-weather" ;
    :stepOrder 1 ;
    :hasAssociatedTask :fetchWeatherTask ;
    <http://purl.org/dc/terms/description> "Step that obtains a daily forecast (dates, temps, precipitation chance, weather condition, location) for a requested city." .

:fetchWeatherTask
    a :Task ;
    rdfs:label "Fetch Weather" ;
    <http://purl.org/dc/terms/description> "Fetches weather forecast for a given city by resolving the city name to coordinates and retrieving daily forecast data. Produces an array of forecast objects { date, maxTemp, minTemp, precipitationChance, condition, location }." ;
    :requiresResource :cityParam ;
    :producedResource :forecastResource ;
    :taskPrompt :fetchWeatherPrompt .

:cityParam
    a beam:Resource ;
    rdfs:label "city" ;
    <http://purl.org/dc/terms/description> "Trigger input parameter: the city string provided to the workflow (e.g., 'Seattle')." .

:forecastResource
    a beam:Resource ;
    rdfs:label "weather-forecast" ;
    <http://purl.org/dc/terms/description> """Array of daily forecast objects with the following structure:
[
  {
    date: string,
    maxTemp: number,
    minTemp: number,
    precipitationChance: number,
    condition: string,
    location: string
  },
  ...
]
This resource is the output of the fetch-weather task and the input to the plan-activities task.""" .

:fetchWeatherPrompt
    a :Prompt ;
    rdfs:label "Fetch Weather Prompt/Description" ;
    :promptInstruction """Summary of behavior:
- Resolve city string to coordinates via geocoding API (Open-Meteo geocoding endpoint).
- Call weather forecast API (Open-Meteo daily forecast) with latitude/longitude to retrieve daily time series: time, temperature_2m_max, temperature_2m_min, precipitation_probability_mean, weathercode.
- Map weather codes to human-readable condition strings.
- Return a JSON array where each element contains date, maxTemp, minTemp, precipitationChance, condition, location.
Note: Implementation uses external HTTP APIs; this is a semantic description of the step's intended function (no implementation-specific code is modeled here).""" ;
    :promptInputData """{ city: string }""" .

# Workflow step 2: plan-activities
:plan-activities-step
    a :WorkflowStep ;
    rdfs:label "plan-activities" ;
    :stepOrder 2 ;
    :hasAssociatedTask :planActivitiesTask ;
    <http://purl.org/dc/terms/description> "Step that takes a forecast array and uses an LLM agent to produce formatted activities recommendations." .

:planActivitiesTask
    a :Task ;
    rdfs:label "Plan Activities" ;
    <http://purl.org/dc/terms/description> "Suggests activities based on the weather forecast. Calls an LLM agent (planningAgent) with the forecast data; receives a streaming text response which is concatenated into the final activities output." ;
    :requiresResource :forecastResource ;
    :producedResource :activitiesResource ;
    :performedByAgent :planningAgent ;
    :taskPrompt :planActivitiesPrompt .

:planActivitiesPrompt
    a :Prompt ;
    rdfs:label "Plan Activities Prompt (runtime user prompt)" ;
    :promptInstruction """Based on the following weather forecast for {location}, suggest appropriate activities:
<JSON array of forecast objects>
(At runtime the workflow composes: `Based on the following weather forecast for ${inputData[0]?.location}, suggest appropriate activities:\n${JSON.stringify(inputData, null, 2)}` and sends it as a user message to the planning agent.)""" ;
    :promptInputData """forecast: [
  { date: string, maxTemp: number, minTemp: number, precipitationChance: number, condition: string, location: string },
  ...
]""" ;
    :promptOutputIndicator "A single text string containing the daily activity recommendations formatted per the planning agent instructions." .

:activitiesResource
    a beam:Resource ;
    rdfs:label "activities-text" ;
    <http://purl.org/dc/terms/description> "Textual output produced by the planning agent. Format: exact template as specified in planningAgent instructions (per-day headers, WEATHER SUMMARY, MORNING/AFTERNOON/INDOOR sections, SPECIAL CONSIDERATIONS). Typically a single concatenated string assembled from streamed LLM output." .

########################################################################
# System / Team that wires agents and workflows (src/mastra/index.ts)
########################################################################

:MastraSystem
    a :Team ;
    rdfs:label "Mastra Application System" ;
    :hasAgentMember :weatherAgent ;
    :hasWorkflowPattern :weather-workflow ;
    <http://purl.org/dc/terms/description> "Top-level application composition: registers weather workflow and the exported weather agent. Implementation used Mastra SDK to wire agents and workflows; that wiring is represented semantically here (agents + workflow membership)." .

########################################################################
# Additional semantic connections and capabilities
########################################################################

# The planning agent uses the language model (same model as weather agent)
:planningAgent :useLanguageModel :claude-3-5-sonnet-20241022 .

# weatherAgent also explicitly linked to tool usage (the exported agent uses the tool)
:weatherAgent :agentToolUsage :get-weather-tool .

# The get-weather tool's description of behavior (preserved as a description prompt)
:get-weather-tool :hasToolConfig :getWeatherToolImplementationNotes .

:getWeatherToolImplementationNotes
    a :Config ;
    :configKey "implementationNotes" ;
    :configValue """Implementation summary from source:
- Performs geocoding via https://geocoding-api.open-meteo.com/v1/search?name=<location>&count=1.
- Uses returned coordinates (latitude, longitude) to request current or forecast weather from Open-Meteo endpoints.
- Maps numeric weather_code to human-readable condition strings with a local mapping.
- Returns normalized object with fields: temperature, feelsLike, humidity, windSpeed, windGust, conditions, location.
Note: This captures the tool's intended external API interactions; the actual HTTP calls and error handling are implementation details not modeled as code here.""" .

########################################################################
# Linking capabilities and resources that cross tasks/tools
########################################################################

# Indicate that the fetchWeather task produces the forecastResource that planActivities consumes
:fetchWeatherTask :producedResource :forecastResource .
:planActivitiesTask :requiresResource :forecastResource .

# Indicate that the planningAgent is the performer of the planActivities task
:planActivitiesTask :performedByAgent :planningAgent .

########################################################################
# Provenance / human actor (optional mention in code)
########################################################################

:developer-FajarEkaputra
    a :HumanAgent ;
    rdfs:label "Fajar J. Ekaputra" ;
    <http://purl.org/dc/terms/description> "Contributor listed in ontology metadata; included here for provenance reasons." .

:developer-KabulKurniawan
    a :HumanAgent ;
    rdfs:label "Kabul Kurniawan" ;
    <http://purl.org/dc/terms/description> "Creator listed in ontology metadata; included here for provenance reasons." .