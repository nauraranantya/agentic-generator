# Execution time: 88.81 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks a structured datatype or dedicated property for serialized JSON schemas or typed input schemas. These are therefore stored as string literals in Config.configValue.
# - The ontology provides no explicit class/property to represent streaming event handlers, callbacks, or ordered event processing. Those behaviors are modeled as WorkflowStep individuals with descriptions but the runtime control flow (callbacks, handlers) cannot be expressed precisely.
# - UI-specific constructs (DOM updates, React state setters, images, CSS) and direct code execution semantics cannot be modeled. They are instead represented as abstract Resources (state artifacts) and Tasks that "produce" or "modify" those resources.
# - There is an apparent id mismatch in the source: Mastra agent is defined with id "test-agent" while client.getAgent('agent') uses id "agent". Both are modeled as separate LLMAgent individuals to preserve fidelity.
# - The ontology does not provide explicit properties to represent tool input validation rules (required fields) or function bodies. Those are preserved as string literals in Config and dcterms:description fields.
# - The agent "stream" call and the "processDataStream" callbacks (onToolCallPart, onToolResultPart, onToolCallDeltaPart, onTextPart) are modeled conceptually as workflow steps and task relations, but specific event sequencing, partial data deltas, or streaming token sequences are not expressible with the current schema.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

#################################################################
# Instances extracted from the solution source code
#################################################################

### Team / System: the client application that coordinates user, agents and tools
:ClientApp rdf:type :Team ;
           rdfs:label "Client Application (Vite + React) Team" ;
           dcterms:description "Represents the client-side application that coordinates a human user, one or more agents, and client-side tools. It contains system-level configuration for the Mastra client (baseUrl) and references the workflow used for streaming interactions." ;
           :hasSystemConfig :Config_MastraClient ;
           :hasAgentMember :Agent_Frontend , :Agent_Backend ;
           :hasWorkflowPattern :StreamingWorkflow .

### System configuration for MastraClient (base URL used in MastraClient instantiation)
:Config_MastraClient rdf:type :Config ;
                    rdfs:label "MastraClient configuration" ;
                    :configKey "baseUrl" ;
                    :configValue "http://localhost:4111" ;
                    dcterms:description "Configuration provided to MastraClient in the front-end code (MastraClient({ baseUrl: 'http://localhost:4111' }))." .

#################################################################
# Agents
#################################################################

### Frontend/runtime agent referenced by client.getAgent('agent')
:Agent_Frontend rdf:type :LLMAgent ;
                rdfs:label "Frontend Agent (runtime id: 'agent')" ;
                :agentID "agent" ;
                dcterms:description "Agent obtained by the client runtime via client.getAgent('agent'). This agent is used to stream messages from the browser to an LLM instance and to execute client-side tools. It receives user messages and coordinates tool calls and streaming responses in the client." ;
                :hasAgentConfig :Config_AgentFrontend ;
                :agentPrompt :Prompt_AgentInstructions ;
                :useLanguageModel :LM_gpt4o ;
                :agentToolUsage :Tool_changeColor , :Tool_changeLogoSize , :Tool_addPost ;
                :hasAgentGoal :Goal_InteractiveUI .

:Config_AgentFrontend rdf:type :Config ;
                      rdfs:label "Frontend agent configuration" ;
                      :configKey "runtimeNote" ;
                      :configValue "Frontend agent used by Mastra client (id 'agent'). Receives messages from the UI and maps clientTools for execution." .

### Backend/defined mastra agent
:Agent_Backend rdf:type :LLMAgent ;
               rdfs:label "Test Agent (defined in mastra config: 'test-agent')" ;
               :agentID "test-agent" ;
               dcterms:description "Agent defined in the mastra/agents configuration with instructions and model selection. Instruction: 'You are a browser client agent. You execute tools in the browser.' Model: openai('gpt-4o')." ;
               :hasAgentConfig :Config_AgentBackend ;
               :agentPrompt :Prompt_AgentInstructions ;
               :useLanguageModel :LM_gpt4o ;
               :agentToolUsage :Tool_changeColor , :Tool_changeLogoSize , :Tool_addPost ;
               :hasAgentGoal :Goal_InteractiveUI .

:Config_AgentBackend rdf:type :Config ;
                     rdfs:label "Mastra-defined agent configuration" ;
                     :configKey "name" ;
                     :configValue "Test Agent" ;
                     dcterms:description "Configuration entries provided to the Agent constructor in src/mastra/agents/index.ts (id: 'test-agent', name: 'Test Agent', instructions, model)." .

### Language model referenced
:LM_gpt4o rdf:type :LanguageModel ;
          rdfs:label "gpt-4o" ;
          dcterms:description "Language model referenced via openai('gpt-4o') in the mastra agent configuration. Provider: OpenAI (via openai SDK reference in source code)." .

### Agent instructions as a Prompt individual
:Prompt_AgentInstructions rdf:type :Prompt ;
                         rdfs:label "Agent instruction prompt (agent system instruction)" ;
                         :promptInstruction "You are a browser client agent. You execute tools in the browser." ;
                         :promptContext "System/instruction prompt provided to the agent in mastra configuration (src/mastra/agents/index.ts)." .

#################################################################
# Human user
#################################################################

:Human_User rdf:type :HumanAgent ;
            rdfs:label "End-user (browser) interacting with the client" ;
            dcterms:description "The human who types messages into the UI textarea and clicks Send to start streaming interactions with the agent." .

#################################################################
# Prompts representing user input and message handling
#################################################################

:Prompt_UserMessageTemplate rdf:type :Prompt ;
                           rdfs:label "User message prompt (runtime user input)" ;
                           :promptInstruction "Free-text message provided by the user in the client textarea" ;
                           :promptContext "At runtime, the value of the 'message' state in src/App.tsx is sent to the agent via agent.stream({ messages: prompt, clientTools: clientSideToolCallsMap })." .

#################################################################
# Tools (client-side tool calls defined in clientSideToolCallsMap)
#################################################################

### Tool: changeColor
:Tool_changeColor rdf:type :Tool ;
                  rdfs:label "changeColor" ;
                  dcterms:description "Client-side tool that changes the application background color. Declared in clientSideToolCallsMap in src/App.tsx." ;
                  :hasCapability :Capability_changeColor ;
                  :hasToolConfig :Config_changeColorSchema .

:Capability_changeColor rdf:type :Capability ;
                        rdfs:label "Change background color" ;
                        rdfs:comment "Capability to change the UI color state (expects a single string property 'color')." .

:Config_changeColorSchema rdf:type :Config ;
                         rdfs:label "changeColor input schema" ;
                         :configKey "inputSchema" ;
                         :configValue "{ \"type\": \"object\", \"properties\": { \"color\": { \"type\": \"string\" } }, \"required\": [\"color\"] }" ;
                         dcterms:description "JSON Schema (serialized) from clientSideToolCallsMap for changeColor. Required field: 'color'." .

### Tool: changeLogoSize
:Tool_changeLogoSize rdf:type :Tool ;
                     rdfs:label "changeLogoSize" ;
                     dcterms:description "Client-side tool that changes the size of the logo. Declared in clientSideToolCallsMap in src/App.tsx." ;
                     :hasCapability :Capability_changeLogoSize ;
                     :hasToolConfig :Config_changeLogoSizeSchema .

:Capability_changeLogoSize rdf:type :Capability ;
                          rdfs:label "Change logo size" ;
                          rdfs:comment "Capability to change the UI logo size. Expects 'height' and 'width' string properties." .

:Config_changeLogoSizeSchema rdf:type :Config ;
                            rdfs:label "changeLogoSize input schema" ;
                            :configKey "inputSchema" ;
                            :configValue "{ \"type\": \"object\", \"properties\": { \"height\": { \"type\": \"string\" }, \"width\": { \"type\": \"string\" } }, \"required\": [\"height\",\"width\"] }" ;
                            dcterms:description "JSON Schema (serialized) from clientSideToolCallsMap for changeLogoSize. Required fields: 'height', 'width'." .

### Tool: addPost
:Tool_addPost rdf:type :Tool ;
              rdfs:label "addPost" ;
              dcterms:description "Client-side tool that adds a new post to the 'posts' state array. Declared in clientSideToolCallsMap in src/App.tsx." ;
              :hasCapability :Capability_addPost ;
              :hasToolConfig :Config_addPostSchema .

:Capability_addPost rdf:type :Capability ;
                    rdfs:label "Add a new post" ;
                    rdfs:comment "Capability to append a new post entry containing 'color' and 'name' to the posts collection in the client." .

:Config_addPostSchema rdf:type :Config ;
                      rdfs:label "addPost input schema" ;
                      :configKey "inputSchema" ;
                      :configValue "{ \"type\": \"object\", \"properties\": { \"color\": { \"type\": \"string\" }, \"name\": { \"type\": \"string\" } }, \"required\": [\"color\",\"name\"] }" ;
                      dcterms:description "JSON Schema (serialized) from clientSideToolCallsMap for addPost. Required fields: 'color', 'name'." .

#################################################################
# Application state represented as resources (abstracted)
#################################################################

:Resource_backgroundColor rdf:type beam:Instance ;
                          rdfs:label "background color state" ;
                          dcterms:description "Abstract representation of the application background color state (corresponds to React state 'color' in src/App.tsx)." .

:Resource_logoSize rdf:type beam:Instance ;
                   rdfs:label "logo size state" ;
                   dcterms:description "Abstract representation of the logo size state (corresponds to React state 'logoSize' with keys 'height' and 'width')." .

:Resource_postsList rdf:type beam:Instance ;
                    rdfs:label "posts list state" ;
                    dcterms:description "Abstract representation of the posts array in client state (React state 'posts'). Items are objects with properties 'name' and 'color'." .

:Resource_responseText rdf:type beam:Instance ;
                       rdfs:label "response text stream" ;
                       dcterms:description "Cumulative response text displayed in the UI (state 'responseText' appended by streaming onTextPart handler)." .

#################################################################
# Tasks (semantic actions derived from the source code)
#################################################################

:Task_userSubmitsMessage rdf:type :Task ;
                         rdfs:label "User submits message" ;
                         dcterms:description "User types text into the UI textarea and clicks Send; triggers setting isStreaming flag, clears previous responseText, and calls streamIt with prompt equal to the message." ;
                         :performedByAgent :Agent_Frontend ;
                         :requiresResource :Resource_responseText ;
                         :contributesToObjective :Objective_UserInteraction .

:Task_streamMessageToAgent rdf:type :Task ;
                          rdfs:label "Stream message to agent" ;
                          dcterms:description "The agent.stream call is invoked with { messages: prompt, clientTools: clientSideToolCallsMap }. This initiates a streaming response from the language model which may include tool call events and text parts." ;
                          :performedByAgent :Agent_Frontend ;
                          :requiresResource :Resource_responseText ;
                          :contributesToObjective :Objective_UserInteraction .

:Task_processStreamEvents rdf:type :Task ;
                         rdfs:label "Process streamed events (tool calls, tool results, deltas, text parts)" ;
                         dcterms:description "The client processes the streaming response using response.processDataStream callbacks: onToolCallPart, onToolResultPart, onToolCallDeltaPart, onTextPart. onTextPart appends string parts to responseText. onToolCallPart executes matching client tool by name and args." ;
                         :performedByAgent :Agent_Frontend ;
                         :contributesToObjective :Objective_StreamHandling .

:Task_executeToolChangeColor rdf:type :Task ;
                            rdfs:label "Execute changeColor tool" ;
                            dcterms:description "When a tool call part for toolName 'changeColor' is received, the client executes the tool's execute function with args (props.color) which sets the application color state." ;
                            :performedBy :Tool_changeColor ;
                            :performedByAgent :Agent_Frontend ;
                            :producedResource :Resource_backgroundColor ;
                            :contributesToObjective :Objective_UIUpdate .

:Task_executeToolChangeLogoSize rdf:type :Task ;
                               rdfs:label "Execute changeLogoSize tool" ;
                               dcterms:description "Tool call for 'changeLogoSize' triggers execute with args { height, width } and updates logo size state." ;
                               :performedBy :Tool_changeLogoSize ;
                               :performedByAgent :Agent_Frontend ;
                               :producedResource :Resource_logoSize ;
                               :contributesToObjective :Objective_UIUpdate .

:Task_executeToolAddPost rdf:type :Task ;
                        rdfs:label "Execute addPost tool" ;
                        dcterms:description "Tool call for 'addPost' triggers execute with args { color, name } and appends a post object to the posts array." ;
                        :performedBy :Tool_addPost ;
                        :performedByAgent :Agent_Frontend ;
                        :producedResource :Resource_postsList ;
                        :contributesToObjective :Objective_UIUpdate .

:Task_appendTextToResponse rdf:type :Task ;
                          rdfs:label "Append text parts to the responseText state" ;
                          dcterms:description "Each onTextPart callback appends the delivered text fragment to responseText. This task is repeated as streaming text parts arrive and results in updating the UI display region." ;
                          :performedByAgent :Agent_Frontend ;
                          :producedResource :Resource_responseText ;
                          :contributesToObjective :Objective_StreamHandling .

#################################################################
# Objectives and Goals
#################################################################

:Objective_UserInteraction rdf:type :Objective ;
                           rdfs:label "Enable user-agent interactive messaging" ;
                           dcterms:description "Objective to allow a human user to send free-text messages to the agent and receive streaming responses." ;
                           :contributesToGoal :Goal_ProvideInteractiveExperience .

:Objective_StreamHandling rdf:type :Objective ;
                         rdfs:label "Handle streaming responses and events" ;
                         dcterms:description "Objective to properly process streaming data, including tool call events, tool results, deltas, and text parts." ;
                         :contributesToGoal :Goal_ProvideInteractiveExperience .

:Objective_UIUpdate rdf:type :Objective ;
                    rdfs:label "Apply UI updates requested via tool calls" ;
                    dcterms:description "Objective to apply client-side state changes (color, logo size, posts) as requested by tool calls from the agent." ;
                    :contributesToGoal :Goal_ProvideInteractiveExperience .

:Goal_InteractiveUI rdf:type :Goal ;
                    rdfs:label "Interactive browser UI driven by agent" ;
                    dcterms:description "Goal for the client app: enable an interactive UI where the language model/agent can instruct the browser to perform UI changes and stream text responses." .

:Goal_ProvideInteractiveExperience rdf:type :Goal ;
                                  rdfs:label "Provide interactive user experience" ;
                                  dcterms:description "Higher-level goal: deliver a streaming conversational experience with dynamic UI updates triggered by model-invoked tool calls." .

#################################################################
# Workflow Pattern: streaming interaction (high-level)
#################################################################

:StreamingWorkflow rdf:type :WorkflowPattern ;
                   rdfs:label "Streaming interaction workflow" ;
                   dcterms:description "High-level workflow pattern capturing the user submission, agent streaming, tool call processing, UI updates, and text rendering as separate steps." ;
                   :hasWorkflowStep :Step_01_Start ,
                                    :Step_02_StreamToAgent ,
                                    :Step_03_ProcessStreamEvents ,
                                    :Step_04_HandleToolCalls ,
                                    :Step_05_AppendText ,
                                    :Step_06_End .

:Step_01_Start rdf:type :StartStep ;
               rdfs:label "Start: user submits message" ;
               :stepOrder 1 ;
               :hasAssociatedTask :Task_userSubmitsMessage .

:Step_02_StreamToAgent rdf:type :WorkflowStep ;
                      rdfs:label "Stream message to agent" ;
                      :stepOrder 2 ;
                      :hasAssociatedTask :Task_streamMessageToAgent .

:Step_03_ProcessStreamEvents rdf:type :WorkflowStep ;
                            rdfs:label "Process streaming events" ;
                            :stepOrder 3 ;
                            :hasAssociatedTask :Task_processStreamEvents .

:Step_04_HandleToolCalls rdf:type :WorkflowStep ;
                        rdfs:label "Handle tool calls and execute tools" ;
                        :stepOrder 4 ;
                        :hasAssociatedTask :Task_executeToolChangeColor , :Task_executeToolChangeLogoSize , :Task_executeToolAddPost .

:Step_05_AppendText rdf:type :WorkflowStep ;
                    rdfs:label "Append text parts to UI" ;
                    :stepOrder 5 ;
                    :hasAssociatedTask :Task_appendTextToResponse .

:Step_06_End rdf:type :EndStep ;
             rdfs:label "End: streaming completed or cancelled" ;
             :stepOrder 6 ;
             dcterms:description "Marks completion of the streaming interaction; 'isStreaming' flag in client is set to false on completion (note: runtime state not modeled in ontology)." .

### Sequence relation between steps (where possible using nextStep)
:Step_01_Start :nextStep :Step_02_StreamToAgent .
:Step_02_StreamToAgent :nextStep :Step_03_ProcessStreamEvents .
:Step_03_ProcessStreamEvents :nextStep :Step_04_HandleToolCalls .
:Step_04_HandleToolCalls :nextStep :Step_05_AppendText .
:Step_05_AppendText :nextStep :Step_06_End .

#################################################################
# Relations: which tasks contribute to objectives (already asserted above);
# indicate which tools are used by the agents and which resources they produce (already asserted)
#################################################################

### Explicitly indicate that the frontend agent uses the language model and tools
:Agent_Frontend :useLanguageModel :LM_gpt4o ;
                :agentToolUsage :Tool_changeColor , :Tool_changeLogoSize , :Tool_addPost ;
                dcterms:description "Runtime agent obtained from the Mastra client; orchestrates streaming and tool execution in the browser." .

### Indicate resources produced by tasks (redundant assertions to ensure clarity)
:Task_executeToolChangeColor :producedResource :Resource_backgroundColor .
:Task_executeToolChangeLogoSize :producedResource :Resource_logoSize .
:Task_executeToolAddPost :producedResource :Resource_postsList .
:Task_appendTextToResponse :producedResource :Resource_responseText .

#################################################################
# Additional descriptive literals to preserve important strings and logic
#################################################################

# Preserve the clientSideToolCallsMap variable semantics as an overall config object
:Config_ClientSideToolCallsMap rdf:type :Config ;
                              rdfs:label "clientSideToolCallsMap (serialized description)" ;
                              :configKey "mapDescription" ;
                              :configValue "An object mapping tool names to declarations: changeColor (id 'changeColor', description 'Changes the background color', inputSchema: {color}, execute -> setColor), changeLogoSize (id 'changeLogoSize', description 'Changes the size of the logo', inputSchema: {height,width}, execute -> setLogoSize), addPost (id 'addPost', description 'Add a new post', inputSchema: {color,name}, execute -> push post to posts array)." ;
                              dcterms:description "Serialized summary of the clientSideToolCallsMap variable from src/App.tsx; preserves tool ids, descriptions, input schema and intended effects on client state." .

# Preserve the streamIt logic description
:Task_streamItLogic rdf:type :Task ;
                    rdfs:label "streamIt function logic (description)" ;
                    dcterms:description "Function streamIt obtains agent via client.getAgent('agent'), calls agent.stream with messages and clientTools; awaits a response object and calls response.processDataStream with handlers: onToolCallPart (executes tool from clientSideToolCallsMap using part.toolName and part.args), onToolResultPart (logs result), onToolCallDeltaPart (logs delta), onTextPart (appends text fragments to responseText state). The function also updates UI streaming flags and manages responseText clearing prior to start." ;
                    :performedByAgent :Agent_Frontend ;
                    :contributesToObjective :Objective_StreamHandling .

# End of instances file
