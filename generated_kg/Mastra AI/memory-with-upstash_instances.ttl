# Execution time: 80.87 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks explicit properties for "threadId", "resourceId", and "streaming session" metadata. These are modeled as Resources and Configs with descriptive literals.
# - The ontology does not provide a property specifically for "memoryOptions" or ephemeral per-call override parameters. We represent these as Config instances linked to the Task or Agent via hasConfig.
# - Implementation / SDK details (e.g., module names, function names, event streams, process.exit) are not modeled (per instructions). Where runtime behavior is relevant (e.g., "streaming", "randomUUID()"), it is captured as descriptive literals in resources/configs.
# - The ontology cannot represent code constructs (types, imports, files). These were omitted; only semantic artifacts (agents, prompts, tools, resources, configs, workflows, tasks, memory) are represented.
# - No new classes or properties were added. Some aspects (e.g., UpstashStore, PgVector, openai client) are modeled as Tools/Resources + Configs. This is an approximation because the ontology has no specialized connector class.
# - The "memory" implementation includes storage, vector DB, and options; these are split into Config individuals (one per meaningful parameter) and linked to the Memory instance using hasConfig. The ontology does not define finer-grained storage-specific properties, so details are kept in configKey/configValue literals.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# System / Team
#################################################################

:MastraSystem rdf:type :Team ;
    rdfs:label "Mastra system (agent orchestrator)" ;
    dcterms:title "Mastra" ;
    :hasAgentMember :ChefAgentInstance ,
                    :MemoryAgentInstance ;
    :hasSystemConfig :MastraSystemConfig ;
    rdfs:comment "Represents the Mastra orchestrator configured with two agents (chefAgent, memoryAgent) and shared memory backend." .

:MastraSystemConfig rdf:type :Config ;
    rdfs:label "Mastra system config" ;
    :configKey "agents" ;
    :configValue "chefAgent, memoryAgent" .

#################################################################
# Language model
#################################################################

:OpenAI_gpt4o_Model rdf:type :LanguageModel ;
    rdfs:label "gpt-4o (OpenAI model)" ;
    <http://purl.org/dc/terms/title> "gpt-4o" ;
    <http://purl.org/dc/terms/description> "Language model used by both agents via the OpenAI SDK (referenced as openai('gpt-4o') in source)." .

#################################################################
# Memory (KnowledgeBase) and storage tools/resources
#################################################################

:SharedConversationMemory rdf:type :Memory ;
    rdfs:label "Shared conversation memory" ;
    rdfs:comment "Memory used by agents for storing and recalling conversation history and embeddings. Configured with UpstashStore (key-value) storage and PgVector for vectors." ;
    :hasConfig :Memory_Storage_Upstash_Config ,
               :Memory_Vector_PgConfig ,
               :Memory_Options_DefaultConfig .

:Memory_Storage_Upstash_Tool rdf:type :Tool ;
    rdfs:label "UpstashStore (KV store adapter)" ;
    rdfs:comment "Represents the Upstash HTTP-backed storage used by the memory implementation." ;
    :hasToolConfig :Memory_Storage_Upstash_Config ;
    :hasCapability :Capability_StoreKV .

:Memory_Storage_Upstash_Config rdf:type :Config ;
    rdfs:label "Upstash store config" ;
    :configKey "memory.storage.adapter" ;
    :configValue "UpstashStore" ;
    <http://purl.org/dc/terms/description> "Configured with url=http://localhost:8089 and token='test_token' in source. Listed here as literal configuration for reconstruction." .

:Memory_Vector_PgTool rdf:type :Tool ;
    rdfs:label "PgVector (Postgres vector store adapter)" ;
    :hasToolConfig :Memory_Vector_PgConfig ;
    :hasCapability :Capability_VectorStorage .

:Memory_Vector_PgConfig rdf:type :Config ;
    rdfs:label "PgVector config" ;
    :configKey "memory.vector.connectionString" ;
    :configValue "postgresql://postgres:postgres@localhost:5433" ;
    <http://purl.org/dc/terms/description> "The PgVector adapter connection string." .

:Memory_Options_DefaultConfig rdf:type :Config ;
    rdfs:label "Memory default options" ;
    :configKey "memory.options.default" ;
    :configValue "{ lastMessages: 1, semanticRecall: { topK: 3, messageRange: 2 } }" ;
    <http://purl.org/dc/terms/description>
        "Default Memory construction options from source: lastMessages=1; semanticRecall.topK=3; semanticRecall.messageRange=2." .

:Capability_StoreKV rdf:type :Capability ;
    rdfs:label "Key-value storage capability" ;
    rdfs:comment "Capability representing storing/retrieving messages or data in a key-value store." .

:Capability_VectorStorage rdf:type :Capability ;
    rdfs:label "Vector DB capability" ;
    rdfs:comment "Capability representing vector embedding storage and semantic recall operations." .

#################################################################
# Agents (LLMAgents)
#################################################################

:ChefAgentInstance rdf:type :LLMAgent ;
    rdfs:label "Chef Agent (chef-agent)" ;
    :agentID "chef-agent" ;
    :agentRole "Chef" ;
    :hasAgentConfig :ChefAgent_Config_ModelPrompt ;
    :agentPrompt :ChefAgent_InstructionsPrompt ;
    :useLanguageModel :OpenAI_gpt4o_Model ;
    :hasKnowledge :SharedConversationMemory ;
    :interactsWith :MemoryAgentInstance ;
    <http://purl.org/dc/terms/description>
        "An agent that helps users cook with available ingredients. Created using: new Agent({ id: 'chef-agent', name: 'Chef Agent', memory, instructions: <instruction text>, model: openai('gpt-4o') })." .

:ChefAgent_Config_ModelPrompt rdf:type :Config ;
    rdfs:label "Chef agent model & metadata" ;
    :configKey "model" ;
    :configValue "openai('gpt-4o')" ;
    <http://purl.org/dc/terms/description> "Model binding for ChefAgent as specified in source." .

:ChefAgent_InstructionsPrompt rdf:type :Prompt ;
    rdfs:label "Chef Agent instructions (agent instructions)" ;
    :promptInstruction
        "You are Michel, a practical and experienced home chef who helps people cook great meals with whatever ingredients they have available. Your first priority is understanding what ingredients and equipment the user has access to, then suggesting achievable recipes. You explain cooking steps clearly and offer substitutions when needed, maintaining a friendly and encouraging tone throughout." ;
    :promptContext "Agent-level instructions for Chef Agent; used as persistent agent prompt." .

:MemoryAgentInstance rdf:type :LLMAgent ;
    rdfs:label "Memory Agent (memory-agent)" ;
    :agentID "memory-agent" ;
    :agentRole "Memory" ;
    :hasAgentConfig :MemoryAgent_Config_ModelPrompt ;
    :agentPrompt :MemoryAgent_InstructionsPrompt ;
    :useLanguageModel :OpenAI_gpt4o_Model ;
    :hasKnowledge :SharedConversationMemory ;
    :interactsWith :ChefAgentInstance ;
    <http://purl.org/dc/terms/description>
        "An agent designed to recall memories automatically and ask for user identifying information if missing. Created with instructions and the same memory backend." .

:MemoryAgent_Config_ModelPrompt rdf:type :Config ;
    rdfs:label "Memory agent model & metadata" ;
    :configKey "model" ;
    :configValue "openai('gpt-4o')" ;
    <http://purl.org/dc/terms/description> "Model binding for MemoryAgent as specified in source." .

:MemoryAgent_InstructionsPrompt rdf:type :Prompt ;
    rdfs:label "Memory Agent instructions (agent instructions)" ;
    :promptInstruction
        "You are an AI agent with the ability to automatically recall memories from previous interactions. You may have conversations that last hours, days, months, or years. If you don't know it already you should ask for the users name and some info about them." ;
    :promptContext "Agent-level instructions for Memory Agent; used as persistent agent prompt." .

#################################################################
# Tools and resources used by agents
#################################################################

:OpenAI_SDKTool rdf:type :Tool ;
    rdfs:label "OpenAI SDK client (conceptual tool)" ;
    :hasToolConfig :OpenAI_Config ;
    :hasCapability :Capability_LMAccess ;
    rdfs:comment "Conceptual representation of the OpenAI client used to call gpt-4o. SDK details are not modeled; configuration captured as literals." .

:OpenAI_Config rdf:type :Config ;
    rdfs:label "OpenAI client config" ;
    :configKey "openai.client" ;
    :configValue "openai('gpt-4o')" ;
    <http://purl.org/dc/terms/description> "Model binding in source code; API keys and runtime details are omitted." .

:Capability_LMAccess rdf:type :Capability ;
    rdfs:label "Language model access capability" ;
    rdfs:comment "Capability to invoke and stream responses from a language model." .

:Upstash_Resource rdf:type beam:Instance ;
    rdfs:label "Upstash HTTP store (resource)" ;
    <http://purl.org/dc/terms/description> "Represents the Upstash storage resource reachable at http://localhost:8089 with token 'test_token' as in source." .

:Pg_Vector_DB_Resource rdf:type beam:Instance ;
    rdfs:label "PgVector Postgres instance (resource)" ;
    <http://purl.org/dc/terms/description> "Represents the Postgres instance used by PgVector (connection string postgresql://postgres:postgres@localhost:5433)." .

#################################################################
# Conversation workflow pattern and steps (mapping index.ts usage)
#################################################################

:MastraConversationPattern rdf:type :WorkflowPattern ;
    rdfs:label "Mastra conversational flow (example run)" ;
    rdfs:comment "A pattern that captures the example conversation sequence executed in src/index.ts." ;
    :hasWorkflowStep :Step_Start ,
                     :Step_InitialIngredientsQuery ,
                     :Step_FriendIngredientsQuery ,
                     :Step_RecallPreviousCooking ,
                     :Step_End .

:Step_Start rdf:type :StartStep ;
    rdfs:label "Start" ;
    :stepOrder 0 ;
    :hasAssociatedTask :Task_SetupSession .

:Step_InitialIngredientsQuery rdf:type :WorkflowStep ;
    rdfs:label "User provides initial kitchen ingredients" ;
    :stepOrder 1 ;
    :hasAssociatedTask :Task_SuggestRecipes_FromIngredients .

:Step_FriendIngredientsQuery rdf:type :WorkflowStep ;
    rdfs:label "User provides friend's house ingredients" ;
    :stepOrder 2 ;
    :hasAssociatedTask :Task_SuggestRecipes_FromFriendIngredients .

:Step_RecallPreviousCooking rdf:type :WorkflowStep ;
    rdfs:label "User asks 'What did we cook before?'" ;
    :stepOrder 3 ;
    :hasAssociatedTask :Task_RecallPreviousRecipes .

:Step_End rdf:type :EndStep ;
    rdfs:label "End" ;
    :stepOrder 4 .

#################################################################
# Tasks and prompts (including all messages used in example)
#################################################################

:Task_SetupSession rdf:type :Task ;
    rdfs:label "Set up session and thread" ;
    :performedByAgent :MemoryAgentInstance ;
    :producedResource :ThreadSessionResource ;
    :hasConfig :Setup_ThreadConfig ;
    <http://purl.org/dc/terms/description>
        "Represents creating a thread/session id for streaming interactions. In source a randomUUID() is used for threadId; resourceId is set to 'SOME_USER_ID'." .

:ThreadSessionResource rdf:type beam:Instance ;
    rdfs:label "thread session resource" ;
    <http://purl.org/dc/terms/description> "Session/thread metadata for a run. threadId is generated using randomUUID() at runtime (source). resourceId used in calls is 'SOME_USER_ID'." .

:Setup_ThreadConfig rdf:type :Config ;
    rdfs:label "thread/session config" ;
    :configKey "threadId_generation" ;
    :configValue "randomUUID() used in source to generate threadId; example placeholder kept." ;
    <http://purl.org/dc/terms/description> "resourceId used: 'SOME_USER_ID' (literal from source)." .

# Task 1: initial kitchen prompt
:Task_SuggestRecipes_FromIngredients rdf:type :Task ;
    rdfs:label "Suggest recipes from user's listed ingredients" ;
    :performedByAgent :ChefAgentInstance ;
    :requiresResource :User_Ingredients_Initial ;
    :producedResource :RecipeSuggestions_Initial ;
    :hasPrompt :Prompt_InitialIngredients ;
    :hasConfig :TaskConfig_DefaultResponseStyle ;
    <http://purl.org/dc/terms/description>
        "User asks the agent: 'In my kitchen I have: pasta, canned tomatoes, garlic, olive oil, and some dried herbs (basil and oregano). What can I make? Please keep your answer brief, only give me the high level steps.' This exact string is captured in Prompt_InitialIngredients and used as input to the ChefAgent." .

:User_Ingredients_Initial rdf:type beam:Resource ;
    rdfs:label "User provided ingredients (initial)" ;
    <http://purl.org/dc/terms/description> "pasta, canned tomatoes, garlic, olive oil, dried herbs (basil and oregano)" .

:RecipeSuggestions_Initial rdf:type beam:Resource ;
    rdfs:label "Recipe suggestions (initial)" ;
    <http://purl.org/dc/terms/description> "Output resource containing brief high-level steps for recipes the Chef Agent suggests given the initial ingredients." .

:Prompt_InitialIngredients rdf:type :Prompt ;
    rdfs:label "Initial ingredients prompt (user message)" ;
    :promptInstruction
        "In my kitchen I have: pasta, canned tomatoes, garlic, olive oil, and some dried herbs (basil and oregano). What can I make? Please keep your answer brief, only give me the high level steps." ;
    :promptContext "User-provided ingredient list and instruction to keep answers brief and high-level." ;
    :promptOutputIndicator "Brief, high-level steps; list of recipe options." .

:TaskConfig_DefaultResponseStyle rdf:type :Config ;
    rdfs:label "Task response style config" ;
    :configKey "response.style" ;
    :configValue "brief, high-level steps" ;
    <http://purl.org/dc/terms/description> "Used to request concise recipe steps in the example." .

# Task 2: friend's house ingredients
:Task_SuggestRecipes_FromFriendIngredients rdf:type :Task ;
    rdfs:label "Suggest recipes from friend's ingredients" ;
    :performedByAgent :ChefAgentInstance ;
    :requiresResource :User_Ingredients_FriendsHouse ;
    :producedResource :RecipeSuggestions_FriendsHouse ;
    :hasPrompt :Prompt_FriendIngredients ;
    <http://purl.org/dc/terms/description>
        "User asks: 'Now I'm over at my friend's house, and they have: chicken thighs, coconut milk, sweet potatoes, and some curry powder.' Captured exactly in Prompt_FriendIngredients." .

:User_Ingredients_FriendsHouse rdf:type beam:Resource ;
    rdfs:label "User provided ingredients (friend's house)" ;
    <http://purl.org/dc/terms/description> "chicken thighs, coconut milk, sweet potatoes, curry powder" .

:RecipeSuggestions_FriendsHouse rdf:type beam:Resource ;
    rdfs:label "Recipe suggestions (friend's house)" ;
    <http://purl.org/dc/terms/description> "Output resource containing brief high-level steps for recipes suggested for friend's ingredients." .

:Prompt_FriendIngredients rdf:type :Prompt ;
    rdfs:label "Friend's ingredients prompt (user message)" ;
    :promptInstruction
        "Now I'm over at my friend's house, and they have: chicken thighs, coconut milk, sweet potatoes, and some curry powder." ;
    :promptContext "User-provided ingredient list at a friend's house." ;
    :promptOutputIndicator "Brief recipe suggestions and steps." .

# Task 3: recall previous cooking using memory recall options
:Task_RecallPreviousRecipes rdf:type :Task ;
    rdfs:label "Recall what was cooked previously" ;
    :performedByAgent :ChefAgentInstance ;
    :requiresResource :ThreadSessionResource ;
    :producedResource :RecipeRecall_Output ;
    :hasPrompt :Prompt_RecallPrevious ;
    :hasConfig :Task_MemoryOverride_Config ;
    <http://purl.org/dc/terms/description>
        "User asks: 'What did we cook before I went to my friends house?' In source, this call is made with memoryOptions: { lastMessages: 3 } to override recall settings for that call. That override is captured in Task_MemoryOverride_Config." .

:Prompt_RecallPrevious rdf:type :Prompt ;
    rdfs:label "Recall previous cooking prompt (user message)" ;
    :promptInstruction "What did we cook before I went to my friends house?" ;
    :promptContext "User queries conversation history; expects the ChefAgent to consult memory (via MemoryAgent/SharedConversationMemory)." ;
    :promptOutputIndicator "List or brief description of previous recipes or steps executed earlier in the same thread." .

:RecipeRecall_Output rdf:type beam:Resource ;
    rdfs:label "Recipe recall output" ;
    <http://purl.org/dc/terms/description> "Memory-influenced response listing what was cooked previously in the same thread/session." .

:Task_MemoryOverride_Config rdf:type :Config ;
    rdfs:label "Per-call memory options override" ;
    :configKey "memoryOptions" ;
    :configValue "{ lastMessages: 3 }" ;
    <http://purl.org/dc/terms/description>
        "Represents the override passed to agent.stream in the third call in src/index.ts. The code calls agent.stream(..., { memoryOptions: { lastMessages: 3 } }). Captured here as a Config attached to the Task that requested recall." .

#################################################################
# Links showing usage relationships
#################################################################

# Agents use tools/resources
:ChefAgentInstance :agentResourceUsage :OpenAI_SDKTool .
:MemoryAgentInstance :agentResourceUsage :OpenAI_SDKTool .
:ChefAgentInstance :agentToolUsage :Memory_Vector_PgTool .
:ChefAgentInstance :agentToolUsage :Memory_Storage_Upstash_Tool .
:MemoryAgentInstance :agentToolUsage :Memory_Vector_PgTool .
:MemoryAgentInstance :agentToolUsage :Memory_Storage_Upstash_Tool .

# Tools access resources (resourceUsage)
:Memory_Storage_Upstash_Tool :resourceUsage :Upstash_Resource .
:Memory_Vector_PgTool :resourceUsage :Pg_Vector_DB_Resource .
:OpenAI_SDKTool :resourceUsage :OpenAI_gpt4o_Model .

# Tasks -> Agents relationships
:Task_SuggestRecipes_FromIngredients :performedByAgent :ChefAgentInstance .
:Task_SuggestRecipes_FromFriendIngredients :performedByAgent :ChefAgentInstance .
:Task_RecallPreviousRecipes :performedByAgent :ChefAgentInstance .

# Tasks contribute to a higher-level objective (example)
:Objective_HelpUserCook rdf:type :Objective ;
    rdfs:label "Help user cook with available ingredients" ;
    rdfs:comment "High-level objective of the Mastra system demo run" ;
    :contributesToGoal :Goal_ImproveCookingExperience ;
    :hasRelatedPattern :MastraConversationPattern ;
    <http://purl.org/dc/terms/description> "Collective objective assigned to the Mastra system's agents to assist users in cooking with available ingredients." .

:Goal_ImproveCookingExperience rdf:type :Goal ;
    rdfs:label "Improve user's cooking experience" ;
    rdfs:comment "Goal that the team/agents pursue; to provide recipes, recall past interactions, and offer helpful substitutions." .

:Task_SuggestRecipes_FromIngredients :contributesToObjective :Objective_HelpUserCook .
:Task_SuggestRecipes_FromFriendIngredients :contributesToObjective :Objective_HelpUserCook .
:Task_RecallPreviousRecipes :contributesToObjective :Objective_HelpUserCook .

#################################################################
# Example artifacts and other descriptive resources
#################################################################

:Example_Index_Source rdf:type beam:Resource ;
    rdfs:label "src/index.ts (example run description)" ;
    <http://purl.org/dc/terms/description>
        "Describes the example orchestrated run: constructs threadId via randomUUID(); calls agent.stream with user messages; logs streaming chunks to stdout; final call includes memoryOptions { lastMessages: 3 }." .

:Example_Bubble_File rdf:type beam:Resource ;
    rdfs:label "src/bubble.ts (message bubble utility - UI/formatting only)" ;
    <http://purl.org/dc/terms/description>
        "A local formatting utility for console output (borders, wrapping). Not modeled as tool used by agents for decision making; included for completeness as a resource artifact." .

#################################################################
# Meta / provenance notes (descriptive)
#################################################################

:RunExample rdf:type beam:Instance ;
    rdfs:label "Example run (index.ts main())" ;
    <http://purl.org/dc/terms/description>
        "Sequence executed by src/index.ts: (1) call chefAgent.stream with initial ingredients; (2) call chefAgent.stream with friend's ingredients; (3) call chefAgent.stream to ask what was cooked before with memoryOptions override; then process.exit(0). Each call uses threadId and resourceId parameters; threadId is randomUUID() per run; resourceId set to 'SOME_USER_ID' in source." .

#################################################################
# End of Turtle instance population
#################################################################