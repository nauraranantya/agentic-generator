# Execution time: 79.72 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks direct properties to represent runtime/control-flow constructs (e.g., streaming APIs, event loops, or SDK function parameters). These are represented as Tasks, WorkflowSteps, and Prompt literals instead.
# - The ontology does not model code-level constructs (e.g., random UUID generation, Readline loop). Those are represented as contextual literals (promptContext / descriptions) rather than code artifacts.
# - The ontology does not provide explicit properties for structured nested configuration objects (e.g., memoryOptions.semanticRecall). We model each configuration key/value as separate Config individuals. This preserves fidelity but is a schema-level workaround.
# - The ontology does not have a specific class/property for "conversation thread id" vs "threadId" naming mismatch across source files; these are represented as a user Resource (beam:Instance) with descriptive literals.
# - The ontology does not distinguish between "system prompt" (special chat role) and other Prompts beyond Prompt class and promptInstruction/promptContext properties; system vs user role is recorded in promptContext.
# - Implementation details, package names, imports, and framework-specific functions (e.g., @mastra/core internals, agent.stream implementation) are intentionally omitted per instructions; we preserve the semantic intent (agents, memory, language model, prompts, workflows, tasks, resources).
# - No issues detected with reusing existing classes/properties to model agents, prompts, memory, language models, and workflows, but some semantic approximations were necessary as noted above.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# Instances extracted from the agent-based solution source
#################################################################

### System / Platform
:mastraSystem rdf:type :Team ;
              rdfs:label "Mastra System" ;
              dcterms:description "Represents the Mastra multi-agent system constructed in the source code (mastra with two agents: chefAgent and memoryAgent)." ;
              :hasAgentMember :ChefAgent , :MemoryAgent ;
              :hasWorkflowPattern :ChefConversationPattern , :MemoryConversationPattern .

#################################################################
# Language Model (shared)
#################################################################
:LM_gpt4o rdf:type :LanguageModel ;
          dcterms:title "gpt-4o" ;
          dcterms:description "The statistical language model used by agents via the OpenAI SDK in the implementation." .

#################################################################
# Memory (shared KnowledgeBase)
#################################################################
:mastraMemory rdf:type :Memory ;
              rdfs:label "Shared Memory (Mastra Memory)" ;
              dcterms:description "Memory instance used by both agents. Configured with lastMessages and semanticRecall options. Shared across agents in the implementation." ;
              :hasConfig :config_lastMessages_100 , :config_semanticRecall_topK_2 , :config_semanticRecall_messageRange_2 .

:config_lastMessages_100 rdf:type :Config ;
                         :configKey "lastMessages" ;
                         :configValue "100" ;
                         dcterms:description "Memory option: number of last messages retained (options.lastMessages = 100)." .

:config_semanticRecall_topK_2 rdf:type :Config ;
                             :configKey "semanticRecall.topK" ;
                             :configValue "2" ;
                             dcterms:description "Memory option: top K semantic recall results (semanticRecall.topK = 2)." .

:config_semanticRecall_messageRange_2 rdf:type :Config ;
                                     :configKey "semanticRecall.messageRange" ;
                                     :configValue "2" ;
                                     dcterms:description "Memory option: range of messages to consider for semantic recall (semanticRecall.messageRange = 2)." .

#################################################################
# Agents
#################################################################
:ChefAgent rdf:type :LLMAgent ;
           rdfs:label "Chef Agent (chef-agent)" ;
           :agentID "chef-agent" ;
           :agentRole "chef" ;
           dcterms:description "LLM-based agent implemented as 'chefAgent' in the code. Provides cooking suggestions based on supplied ingredients and context, gives high-level steps, suggests substitutions, and uses shared memory." ;
           :useLanguageModel :LM_gpt4o ;
           :hasKnowledge :mastraMemory ;
           :hasAgentConfig :config_lastMessages_100 , :config_semanticRecall_topK_2 , :config_semanticRecall_messageRange_2 ;
           :agentPrompt :prompt_chef_instructions .

:MemoryAgent rdf:type :LLMAgent ;
             rdfs:label "Memory Agent (memory-agent)" ;
             :agentID "memory-agent" ;
             :agentRole "memory" ;
             dcterms:description "LLM-based memory manager agent implemented as 'memoryAgent' in the code. Responsible for recalling previous interactions and asking for user identification when unknown." ;
             :useLanguageModel :LM_gpt4o ;
             :hasKnowledge :mastraMemory ;
             :hasAgentConfig :config_lastMessages_100 , :config_semanticRecall_topK_2 , :config_semanticRecall_messageRange_2 ;
             :agentPrompt :prompt_memory_instructions .

#################################################################
# Agent instruction prompts (agent-level prompts / role)
#################################################################
:prompt_chef_instructions rdf:type :Prompt ;
                          :promptInstruction "You are Michel, a practical and experienced home chef who helps people cook great meals with whatever ingredients they have available. Your first priority is understanding what ingredients and equipment the user has access to, then suggesting achievable recipes. You explain cooking steps clearly and offer substitutions when needed, maintaining a friendly and encouraging tone throughout." ;
                          :promptContext "This prompt is set as the chefAgent's instruction/role definition (provided as 'instructions' when the agent is created)." ;
                          dcterms:description "Role/instruction prompt attached to the Chef Agent instance." .

:prompt_memory_instructions rdf:type :Prompt ;
                          :promptInstruction "You are an AI agent with the ability to automatically recall memories from previous interactions. You may have conversations that last hours, days, months, or years. If you don't know it already you should ask for the users name and some info about them." ;
                          :promptContext "This prompt is set as the memoryAgent's instruction/role definition (provided as 'instructions' when the agent is created)." ;
                          dcterms:description "Role/instruction prompt attached to the Memory Agent instance." .

#################################################################
# Example runtime resources (user, thread, streams)
#################################################################
:resource_SOME_USER_ID rdf:type beam:Instance ;
                       dcterms:title "SOME_USER_ID" ;
                       dcterms:description "Placeholder resource identifier used in the source code to represent a user-specific memory resource (resource = 'SOME_USER_ID')." .

:thread_example_uuid rdf:type :Context ;
                     dcterms:title "f45a59b3-d9da-4a2a-8348-9386e4e621a3" ;
                     dcterms:description "Example fixed thread id present in chat.ts (thread explicitly set to `f45a59b3-d9da-4a2a-8348-9386e4e621a3`)." .

:agent_response_stream rdf:type beam:Instance ;
                       dcterms:title "agent.textStream" ;
                       dcterms:description "Represents the streaming text output produced by agent.stream in the implementation (modeled as a Resource instance)." .

#################################################################
# Workflow patterns and steps
#################################################################
:ChefConversationPattern rdf:type :WorkflowPattern ;
                        rdfs:label "Chef Conversation Pattern" ;
                        dcterms:description "Workflow demonstrating chefAgent usage: present ingredients, agent suggests recipe and high-level steps, demonstrate memory recall across threads/resources." ;
                        :hasWorkflowStep :ChefStep1_SystemPrompt , :ChefStep2_UserIngredients1 , :ChefStep3_UserIngredients2 , :ChefStep4_UserRecallQuery , :ChefStep5_End .

:ChefStep1_SystemPrompt rdf:type :StartStep ;
                        rdfs:label "Chef Step 1: Initial user question" ;
                        :stepOrder 1 ;
                        :hasAssociatedTask :Task_ChefInitialQuery .

:ChefStep2_UserIngredients1 rdf:type :WorkflowStep ;
                           rdfs:label "Chef Step 2: Second user ingredients (friend's house)" ;
                           :stepOrder 2 ;
                           :hasAssociatedTask :Task_ChefIngredientsFriend .

:ChefStep3_UserIngredients2 rdf:type :WorkflowStep ;
                           rdfs:label "Chef Step 3: Follow-up question to recall previous recipe" ;
                           :stepOrder 3 ;
                           :hasAssociatedTask :Task_ChefRecallQuery .

:ChefStep4_UserRecallQuery rdf:type :WorkflowStep ;
                          rdfs:label "Chef Step 4: Memory recall interaction" ;
                          :stepOrder 4 ;
                          :hasAssociatedTask :Task_MemoryRecall .

:ChefStep5_End rdf:type :EndStep ;
              rdfs:label "Chef Step 5: End" ;
              :stepOrder 5 ;
              :hasAssociatedTask :Task_EndConversation .

#################################################################
# Tasks (mapping code-level interactions into semantic tasks)
#################################################################
:Task_ChefInitialQuery rdf:type :Task ;
                       rdfs:label "Task: Initial Ingredients Query" ;
                       dcterms:description "User asks: 'In my kitchen I have: pasta, canned tomatoes, garlic, olive oil, and some dried herbs (basil and oregano). What can I make? Please keep your answer brief, only give me the high level steps.' This is passed as input to chefAgent.stream with threadId and resourceId context." ;
                       :performedByAgent :ChefAgent ;
                       :requiresResource :resource_SOME_USER_ID ;
                       :producedResource :agent_response_stream ;
                       :taskPrompt :prompt_chef_example_1 .

:Task_ChefIngredientsFriend rdf:type :Task ;
                            rdfs:label "Task: Ingredients at Friend's House" ;
                            dcterms:description "User asks: 'Now I'm over at my friend's house, and they have: chicken thighs, coconut milk, sweet potatoes, and some curry powder.' This is passed to chefAgent.stream with same threadId/resourceId to append to conversation memory." ;
                            :performedByAgent :ChefAgent ;
                            :requiresResource :resource_SOME_USER_ID ;
                            :producedResource :agent_response_stream ;
                            :taskPrompt :prompt_chef_example_2 .

:Task_ChefRecallQuery rdf:type :Task ;
                      rdfs:label "Task: Ask What We Cooked Before" ;
                      dcterms:description "User asks: 'What did we cook before I went to my friends house?' This demonstrates memory recall options with memoryOptions: lastMessages=false and semanticRecall configured." ;
                      :performedByAgent :ChefAgent ;
                      :requiresResource :resource_SOME_USER_ID ;
                      :producedResource :agent_response_stream ;
                      :taskPrompt :prompt_chef_example_3 .

:Task_MemoryRecall rdf:type :Task ;
                   rdfs:label "Task: Memory Agent Recall Operation" ;
                   dcterms:description "Memory agent performs semantic recall according to configured memory options and may ask for user identification when missing." ;
                   :performedByAgent :MemoryAgent ;
                   :requiresResource :resource_SOME_USER_ID ;
                   :producedResource :agent_response_stream ;
                   :taskPrompt :prompt_memory_recall_example .

:Task_EndConversation rdf:type :Task ;
                      rdfs:label "Task: End / Exit" ;
                      dcterms:description "Represents termination of the script after example interactions (process.exit in index.ts). Modeled as a conceptual task reflecting end of workflow." ;
                      :performedByAgent :ChefAgent .

#################################################################
# Prompt examples passed to agent.stream in the source code (preserve exact strings)
#################################################################
:prompt_chef_example_1 rdf:type :Prompt ;
                      :promptInstruction "In my kitchen I have: pasta, canned tomatoes, garlic, olive oil, and some dried herbs (basil and oregano). What can I make? Please keep your answer brief, only give me the high level steps." ;
                      :promptContext "Example user input passed to chefAgent.stream in src/index.ts (first call). Includes threadId and resourceId in options." ;
                      dcterms:description "Preserve original example prompt used to demonstrate the Chef Agent." ;
                      :promptOutputIndicator "High-level steps only; brief response requested." .

:prompt_chef_example_2 rdf:type :Prompt ;
                      :promptInstruction "Now I'm over at my friend's house, and they have: chicken thighs, coconut milk, sweet potatoes, and some curry powder." ;
                      :promptContext "Second user input passed to chefAgent.stream in src/index.ts (illustrates new ingredients context while retaining same thread/resource)." ;
                      dcterms:description "Second example prompt that continues the same conversation context via the threadId/resourceId pair." .

:prompt_chef_example_3 rdf:type :Prompt ;
                      :promptInstruction "What did we cook before I went to my friends house?" ;
                      :promptContext "Follow-up user query passed to chefAgent.stream, demonstrates the memory recall API options (memoryOptions: { lastMessages: false, semanticRecall: { topK: 3, messageRange: 3 } })." ;
                      :promptOutputIndicator "Expect agent to recall prior conversation content; memoryOptions override in call." ;
                      dcterms:description "This example includes custom memoryOptions used when calling agent.stream (see Task_ChefRecallQuery)." .

:prompt_memory_recall_example rdf:type :Prompt ;
                             :promptInstruction "Chat with user started now <ISO_TIMESTAMP>. Don't mention this message. This means some time may have passed between this message and the one before. The user left and came back again. Say something to start the conversation up again. If there are no other messages besides this one then this is a new conversation." ;
                             :promptContext "System-style message used in src/chat.ts at the start of the conversation loop. Timestamp is set dynamically at runtime; represented here with placeholder <ISO_TIMESTAMP> to preserve instruction semantics." ;
                             dcterms:description "Prompt instructing the Memory Agent how to handle resumed conversations and to ask for user context if needed." ;
                             :promptOutputIndicator "Start or re-start a conversation politely; if no other messages, treat as a new conversation." .

#################################################################
# Memory recall / options used for the specific recall call
#################################################################
:memoryOptions_override_for_recall rdf:type :Config ;
                                  :configKey "memoryOptions.lastMessages" ;
                                  :configValue "false" ;
                                  dcterms:description "Override used in the third chefAgent.stream call: memoryOptions.lastMessages = false" .

:memoryOptions_override_semanticRecall rdf:type :Config ;
                                      :configKey "memoryOptions.semanticRecall.topK" ;
                                      :configValue "3" ;
                                      dcterms:description "Override used in the third chefAgent.stream call: semanticRecall.topK = 3" .

:memoryOptions_override_messageRange rdf:type :Config ;
                                     :configKey "memoryOptions.semanticRecall.messageRange" ;
                                     :configValue "3" ;
                                     dcterms:description "Override used in the third chefAgent.stream call: semanticRecall.messageRange = 3" .

# Link the override configs to the recall Task (preserve call-specific configuration)
:Task_ChefRecallQuery :hasConfig :memoryOptions_override_for_recall , :memoryOptions_override_semanticRecall , :memoryOptions_override_messageRange .

#################################################################
# Representing the use relationships between agents, prompts, and resources
#################################################################
:ChefAgent :taskPrompt :prompt_chef_example_1 , :prompt_chef_example_2 , :prompt_chef_example_3 .
:MemoryAgent :taskPrompt :prompt_memory_recall_example .

# both agents use the same language model (openai/gpt-4o)
:ChefAgent :useLanguageModel :LM_gpt4o .
:MemoryAgent :useLanguageModel :LM_gpt4o .

#################################################################
# Additional contextual linking for reconstruction
#################################################################
:mastraSystem dcterms:description "Mastra object created with agents: chefAgent and memoryAgent (code: new Mastra({ agents: { chefAgent, memoryAgent } }))." .

# Mark that chef and memory agents are members of the system
:mastraSystem :hasAgentMember :ChefAgent , :MemoryAgent .

# Provide performedBy links from tasks to agents again (explicit)
:Task_ChefInitialQuery :performedByAgent :ChefAgent .
:Task_ChefIngredientsFriend :performedByAgent :ChefAgent .
:Task_ChefRecallQuery :performedByAgent :ChefAgent .
:Task_MemoryRecall :performedByAgent :MemoryAgent .

#################################################################
# Notes encoded as descriptions to preserve additional semantic detail
#################################################################
:ChefAgent dcterms:description "Constructed in src/mastra/agents/index.ts using Agent constructor with id 'chef-agent', name 'Chef Agent', model openai('gpt-4o'), and memory instance. The agent.logs responses by streaming text from agent.stream; example client usage in src/index.ts." .

:MemoryAgent dcterms:description "Constructed in src/mastra/agents/index.ts using Agent constructor with id 'memory-agent', name 'Memory Agent', model openai('gpt-4o'), and same memory instance. The agent supports long-lived conversations and recall behavior; example client usage in src/chat.ts demonstrates memory thread management." .

#################################################################
# End of instance data
#################################################################