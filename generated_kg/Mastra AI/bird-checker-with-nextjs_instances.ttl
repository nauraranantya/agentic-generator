# Execution time: 64.48 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks explicit properties to represent tool input schemas and execution code; I use Config instances (hasToolConfig) to store schema and descriptive executor information as string literals.
# - The ontology does not provide a property to capture the exact mapping of prompt outputs to structured output schemas. I store the output zod schema / expected structure as promptOutputIndicator on the prompt and as a Config on the analyzing task.
# - Runtime/UI elements (Next.js components, CSS, fonts, UI skeletons, etc.) and SDK-specific constructs (Mastra, Agent.generate, anthropic SDK calls) are intentionally NOT modeled; only their semantic roles (agent, tool, task, prompts, model) are represented.
# - Dynamic or runtime values (example Unsplash image results) are represented with a sample beam:Instance to preserve the data schema used (urls, alt text, user link). These are illustrative resources (instances), not exhaustive captures of all possible runtime images.
# - Some implementation details (e.g., random paging logic, cache directives, error handling branches) are not modeled as the ontology has no mechanism to represent procedural code. I preserve the important parameters and descriptions as config values and prompt/instruction literals.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# Individuals for Bird Checker solution
#################################################################

### Agent: birdAgent (LLMAgent)
:birdAgent rdf:type :LLMAgent ;
  rdfs:label "Bird Checker agent" ;
  :agentID "bird-checker" ;
  :agentRole "image analyst / bird identifier" ;
  rdfs:comment "An LLM-powered agent that inspects images, determines whether a bird is present, identifies species, and summarizes image location." ;
  :hasAgentCapability :cap_detect_bird , :cap_identify_species , :cap_summarize_location ;
  :useLanguageModel :anthropic_claude_3_haiku ;
  :agentPrompt :birdAgent_prompt ;
  :agentToolUsage :getRandomImageTool ;
  :hasAgentGoal :goal_identify_birds .

### Language Model used by agent
:anthropic_claude_3_haiku rdf:type :LanguageModel ;
  rdfs:label "anthropic/claude-3-haiku-20240307" ;
  rdfs:comment "The statistical language model used by the LLM agent (metadata preserved from configuration: anthropic('claude-3-haiku-20240307'))." .

### Agent capabilities
:cap_detect_bird rdf:type :Capability ;
  rdfs:label "detect bird" ;
  rdfs:comment "Determine whether an image contains a bird (boolean)." .

:cap_identify_species rdf:type :Capability ;
  rdfs:label "identify species (scientific name)" ;
  rdfs:comment "Identify the bird species, ideally returning scientific name as a string." .

:cap_summarize_location rdf:type :Capability ;
  rdfs:label "summarize location" ;
  rdfs:comment "Summarize the location of the photographed scene in one or two simple sentences." .

### Prompts
:birdAgent_prompt rdf:type :Prompt ;
  rdfs:label "Bird Checker agent prompt (global/instructional)" ;
  :promptContext "Agent instruction and purpose" ;
  :promptInstruction """You can view an image and figure out if it is a bird or not. You can also figure out the species of the bird and where the picture was taken.""" ;
  :promptOutputIndicator "Agent-level instructions do not include a single output schema; tasks define specific output schemas." .

:analyze_image_task_prompt rdf:type :Prompt ;
  rdfs:label "Analyze image prompt (Claude request)" ;
  :promptContext "User provides an image to analyze. The prompt employs an image element followed by a single-line instruction." ;
  :promptInstruction """view this image and let me know if it's a bird or not, and the scientific name of the bird without any explanation. Also summarize the location for this picture in one or two short sentences understandable by a high school student""" ;
  :promptInputData "image: an image URL or embedded image element; the prompt expects the agent to inspect the image content" ;
  :promptOutputIndicator """output: { bird: boolean, species: string, location: string } (structured object expected and validated in source by zod output schema)""" .

:get_image_task_prompt rdf:type :Prompt ;
  rdfs:label "Fetch image prompt / tool instruction" ;
  :promptContext "Tool invocation instruction to Unsplash-fetching tool" ;
  :promptInstruction "Get a random image from Unsplash using a selected query option" ;
  :promptInputData """{ "query": "one of [\"wildlife\",\"feathers\",\"flying\",\"birds\"]" }""" ;
  :promptOutputIndicator "Returns an Unsplash image object with urls (regular/raw), alt_description, and user metadata." .

### Tools
:getRandomImageTool rdf:type :Tool ;
  rdfs:label "Get a random image from Unsplash (tool)" ;
  rdfs:comment "Tool that queries Unsplash and returns a single image object selected from search results. Implemented in the code using a GET to https://api.unsplash.com/search/photos with a query param and optional paging/randomization." ;
  :hasToolConfig :getRandomImageTool_config_schema , :getRandomImageTool_config_metadata ;
  :hasCapability :cap_fetch_random_image .

:getRandomImageTool_config_schema rdf:type :Config ;
  rdfs:label "getRandomImage tool input schema" ;
  :configKey "inputSchema" ;
  :configValue """{ "type": "object", "properties": { "query": { "type": "string", "enum": ["wildlife","feathers","flying","birds"] } }, "required": ["query"] }""" .

:getRandomImageTool_config_metadata rdf:type :Config ;
  rdfs:label "getRandomImage tool metadata" ;
  :configKey "description" ;
  :configValue "Gets a random image from Unsplash based on the selected option. Uses a random page and order_by toggled between 'relevant' and 'latest'." .

:cap_fetch_random_image rdf:type :Capability ;
  rdfs:label "fetch random image" ;
  rdfs:comment "Capability to query Unsplash and return a representative image resource." .

### Tasks
:fetch_image_task rdf:type :Task ;
  rdfs:label "Fetch random image task" ;
  rdfs:comment "Task to retrieve an image from Unsplash using a user-selected query (wildlife, feathers, flying, birds)." ;
  :performedBy :getRandomImageTool ;
  :producedResource :unsplash_image_instance_example ;
  :contributesToObjective :objective_acquire_image ;
  :taskPrompt :get_image_task_prompt .

:analyze_image_task rdf:type :Task ;
  rdfs:label "Analyze image and produce bird metadata" ;
  rdfs:comment "Task to analyze the image content via the LLM agent and produce bird detection, species (scientific name), and a short human-readable location summary." ;
  :performedByAgent :birdAgent ;
  :requiresResource :unsplash_image_instance_example ;
  :producedResource :bird_metadata_instance_example ;
  :contributesToObjective :objective_identify_and_describe ;
  :taskPrompt :analyze_image_task_prompt .

### Objectives and Goal(s)
:objective_acquire_image rdf:type :Objective ;
  rdfs:label "Acquire representative image for inspection" ;
  rdfs:comment "Objective associated with fetching an image to analyze (UI-driven query selection)." .

:objective_identify_and_describe rdf:type :Objective ;
  rdfs:label "Identify bird presence/species and summarize location" ;
  rdfs:comment "Objective to determine bird presence, identify species, and provide a simple location summary." .

:goal_identify_birds rdf:type :Goal ;
  rdfs:label "Primary goal: Identify birds and contextual metadata" ;
  rdfs:comment "Overall user-facing goal assigned to the agent: classify images for bird presence and provide species and location information." .

### Workflow Pattern and Steps
:BirdCheckerWorkflow rdf:type :WorkflowPattern ;
  rdfs:label "Bird Checker workflow pattern" ;
  rdfs:comment "Two-step workflow: fetch image -> analyze image" ;
  :hasWorkflowStep :FetchStep , :AnalyzeStep ;
  :hasRelatedPattern :BirdCheckerWorkflow .  # self reference to indicate pattern (preserve structure)

:FetchStep rdf:type :StartStep ;
  rdfs:label "Fetch image step" ;
  :stepOrder 1 ;
  :hasAssociatedTask :fetch_image_task ;
  :nextStep :AnalyzeStep ;
  rdfs:comment "Start step where a user-selected query triggers fetching a random image." .

:AnalyzeStep rdf:type :EndStep ;
  rdfs:label "Analyze image step" ;
  :stepOrder 2 ;
  :hasAssociatedTask :analyze_image_task ;
  rdfs:comment "Final step where the agent analyzes the fetched image and returns structured metadata." .

### Resources (examples / produced outputs)
:unsplash_image_instance_example rdf:type beam:Instance ;
  rdfs:label "Example Unsplash image instance (sample resource produced by fetch task)" ;
  <http://purl.org/dc/terms/title> "Unsplash image (example)" ;
  <http://purl.org/dc/terms/description> """An image resource object with the fields used by the system: 
  alt_description: string,
  urls: { regular: string, raw: string },
  user: { first_name: string, links: { html: string } }.
  (This instance models the schema and an example image result; real images are produced at runtime.)""" ;
  rdfs:comment "Represents an image resource returned from Unsplash. The tool returns such a resource and the analyze task consumes it." .

:bird_metadata_instance_example rdf:type beam:Instance ;
  rdfs:label "Example bird metadata instance (example resource produced by analyze task)" ;
  <http://purl.org/dc/terms/description> """Structured metadata returned by analysis:
  { "bird": boolean, "species": string, "location": string }.
  Example semantics: bird=true, species='Corvus corax' (scientific name), location='a coastal cliff near (region/city)'. The exact scientific name and summary are derived by the agent from the image.""" ;
  rdfs:comment "Represents the structured output of the analyze task (bird detection, species, summarized location)." .

### Task <-> Objective relations preserved
:fetch_image_task :contributesToObjective :objective_acquire_image .
:analyze_image_task :contributesToObjective :objective_identify_and_describe .

### Agent <-> Goal
:birdAgent :hasAgentGoal :goal_identify_birds .

### Human-facing configuration (environment)
:WebEnvironment rdf:type :Environment ;
  rdfs:label "Web runtime environment" ;
  :envType "Next.js / browser + server (application) environment; uses Unsplash API via server-side call and LLM via configured model." ;
  :hasEnvironmentConfig :env_config_unsplash_key .

:env_config_unsplash_key rdf:type :Config ;
  rdfs:label "Environment: Unsplash API key config" ;
  :configKey "NEXT_PUBLIC_UNSPLASH_ACCESS_KEY" ;
  :configValue "REDACTED (provided at deployment time). The tool uses this key for Authorization: Client-ID <KEY> when calling Unsplash." .

#################################################################
# Cross-links for readability
#################################################################

# agent uses tool and model
:birdAgent :agentToolUsage :getRandomImageTool .
:birdAgent :useLanguageModel :anthropic_claude_3_haiku .

# task execution relationships (already added above)
:fetch_image_task :performedBy :getRandomImageTool .
:analyze_image_task :performedByAgent :birdAgent .

# prompts association with tasks (already added)
:fetch_image_task :taskPrompt :get_image_task_prompt .
:analyze_image_task :taskPrompt :analyze_image_task_prompt .

# record that the fetch task produces the Unsplash image resource
:fetch_image_task :producedResource :unsplash_image_instance_example .

# record that the analyze task consumes that image and produces metadata
:analyze_image_task :requiresResource :unsplash_image_instance_example ;
  :producedResource :bird_metadata_instance_example .

# Preserve the tool description and the developer-provided id/description stored as configs
:getRandomImageTool :hasToolConfig :getRandomImageTool_config_schema , :getRandomImageTool_config_metadata .

# End of instance descriptions.