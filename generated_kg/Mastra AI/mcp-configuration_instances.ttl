# Execution time: 81.53 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks an explicit Server/Service class to represent a server process (e.g., MCP server, SSE server). I model servers as Tool instances and capture server-specific details in Config and description literals. If a Server class were available, it would be more precise.
# - The ontology has no explicit class for transports or connection types (e.g., SSE, stdio). I represented transport and endpoint details in Config entries and resource descriptions.
# - The ontology does not provide a native structure for machine-readable input schema (e.g., zod schema). I encoded the input schema as literal strings inside Config entries (configKey/configValue). A richer schema class would be useful.
# - Dynamic runtime behaviors (streaming events, tool-call / tool-result event sequencing) and SDK-level constructs (MCPClient, server.connect, transports, spawn processes) are implementation-specific and not modeled as code. These are summarized descriptively in Config/description literals.
# - I did not include source code verbatim. Where logic is important (e.g., how tools fetch data, expected JSON output shape, or prompt text), I preserved those semantics as descriptive literals, prompts, and resource descriptions.
# - No issues detected with using the existing classes/properties to represent agents, tools, prompts, tasks, workflow patterns, configs, capabilities, and resources.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dct: <http://purl.org/dc/terms/> .

###############################################################################
# Agent
###############################################################################

:stockWeatherAgent rdf:type :LLMAgent ;
    dct:title "Stock + Weather Agent" ;
    :agentID "stock-weather-agent" ;
    :agentPrompt :stockWeatherAgentPrompt ;
    :hasAgentConfig :stockWeatherAgentConfig ;
    :useLanguageModel :gpt4oModel ;
    :agentToolUsage :stockPriceTool ,
                    :weatherTool ;
    :hasAgentGoal :stockWeatherGoal ;
    dct:description "An LLM agent that coordinates fetching stock prices and current weather when prompted by a user. It uses two external tools: a Stock Price tool and a Weather tool. The agent is instructed to prefer using the stock price tool for stock queries and to check weather when relevant." .

:stockWeatherAgentPrompt rdf:type :Prompt ;
    :promptInstruction """You are a helpful assistant that provides current stock prices. When asked about a stock, use the stock price tool to fetch the stock price. You also love to check the weather when your stock market buddies ask you what the weather is.""" ;
    :promptContext "Agent-level system instructions for independent operation (agent behavior and role)." ;
    :promptOutputIndicator "Follow tool call conventions: call tools for stock or weather lookup, include returned JSON results in final reply." .

:gpt4oModel rdf:type :LanguageModel ;
    dct:title "gpt-4o" ;
    dct:description "Language model selected for the agent (model: openai('gpt-4o')). Modeled as a LanguageModel used by the agent." .

:stockWeatherAgentConfig rdf:type :Config ;
    :configKey "model" ;
    :configValue "gpt-4o" ;
    :configKey "agent.name" ;
    :configValue "Stock + Weather Agent" ;
    dct:description "Configuration entries for the LLM agent: model selection and human-readable agent name." .

###############################################################################
# Tools (modeled as Tool individuals) and Capabilities
###############################################################################

:stockPriceTool rdf:type :Tool ;
    dct:title "Stock Price Tool (getStockPrice)" ;
    dct:description """Tool exposing a single capability 'getStockPrice'. It fetches the last day's closing stock price for a given symbol from https://mastra-stock-data.vercel.app/api/stock-data?symbol=<SYMBOL>. Returns JSON text object: { "symbol": "<SYMBOL>", "currentPrice": <price> } as tool content. The tool is made available to the agent via a toolset listing (server process that exposes tools). The server process also includes an environment variable FAKE_CREDS used during server launch; captured in tool config.""";
    :hasCapability :cap_getStockPrice ;
    :hasToolConfig :stockPriceToolConfig ;
    :resourceUsage :mastraStockApi .

:cap_getStockPrice rdf:type :Capability ;
    dct:description "Capability to fetch the most recent closing stock price for a provided stock symbol (getStockPrice)." ;
    dct:title "Fetch Stock Price" .

:stockPriceToolConfig rdf:type :Config ;
    :configKey "tool.name" ;
    :configValue "getStockPrice" ;
    :configKey "tool.description" ;
    :configValue "Fetches the last day's closing stock price for a given symbol" ;
    :configKey "inputSchema" ;
    :configValue "{ \"symbol\": \"string (stock symbol)\" }" ;
    :configKey "serverLaunch.env.FAKE_CREDS" ;
    :configValue "let me in!" ;
    dct:description "Configuration capturing the tool name, description, input schema (encoded as JSON-like string), and an environment variable used when launching the server process." .

:mastraStockApi rdf:type beam:Instance ;
    dct:title "Mastra Stock Data API" ;
    dct:description "External HTTP endpoint used by the stock price tool: https://mastra-stock-data.vercel.app/api/stock-data?symbol=<SYMBOL>. Tool parses JSON and extracts 'prices[\"4. close\"]' as the returned price." ;
    dct:reference "https://mastra-stock-data.vercel.app/api/stock-data" .

###############################################################################

:weatherTool rdf:type :Tool ;
    dct:title "Weather Tool (getWeather) - SSE-backed" ;
    dct:description """Tool exposing 'getWeather' capability. It resolves a location via a geocoding service, calls an external weather API (open-meteo) to get current conditions and returns a JSON structure containing temperature, feelsLike, humidity, windSpeed, windGust, conditions, and location. This tool is exposed over an SSE-backed server endpoint at http://localhost:8080/sse in the example environment. The tool expects a 'location' string (city name).""";
    :hasCapability :cap_getWeather ;
    :hasToolConfig :weatherToolConfig ;
    :resourceUsage :openMeteoApi ,
                   :openMeteoGeocodingApi .

:cap_getWeather rdf:type :Capability ;
    dct:description "Capability to get current weather for a specified location (getWeather). Performs geocoding, then queries a weather API, and returns a structured JSON response." ;
    dct:title "Get Current Weather" .

:weatherToolConfig rdf:type :Config ;
    :configKey "tool.name" ;
    :configValue "getWeather" ;
    :configKey "tool.description" ;
    :configValue "Get current weather for a location" ;
    :configKey "inputSchema" ;
    :configValue "{ \"location\": \"string (city name)\" }" ;
    :configKey "exposure" ;
    :configValue "SSE (server endpoint at http://localhost:8080/sse)" ;
    dct:description "Configuration for the weather tool: name, description, input schema, and exposure/transport info (SSE endpoint). Transport and runtime details are recorded textually because transport types are not first-class in the ontology." .

:openMeteoApi rdf:type beam:Instance ;
    dct:title "Open-Meteo Forecast API" ;
    dct:description "External weather API used to retrieve current weather values. The weather tool queries this API for fields: temperature_2m, apparent_temperature, relative_humidity_2m, wind_speed_10m, wind_gusts_10m, weather_code." ;
    dct:reference "https://api.open-meteo.com/v1/forecast" .

:openMeteoGeocodingApi rdf:type beam:Instance ;
    dct:title "Open-Meteo Geocoding API" ;
    dct:description "Geocoding service used to map a location name to latitude/longitude: https://geocoding-api.open-meteo.com/v1/search?name=<location>&count=1" ;
    dct:reference "https://geocoding-api.open-meteo.com/v1/search" .

###############################################################################
# Tasks (semantic actions that compose the workflow)
###############################################################################

:userRequestTask rdf:type :Task ;
    dct:title "User Request Task: Combined Stock + Weather Query" ;
    :taskPrompt :userRequestPrompt ;
    :contributesToObjective :fulfillUserRequestObjective ;
    dct:description "High-level task representing the incoming user prompt that asks for weather in Seattle and the current stock price of Apple (AAPL). This task triggers a workflow that coordinates tool calls to fetch weather and stock data." .

:userRequestPrompt rdf:type :Prompt ;
    :promptInstruction "Whats the weather in Seattle and what is the current stock price of Apple (AAPL)?" ;
    :promptInputData "location: Seattle; symbol: AAPL" ;
    :promptContext "User asked for both weather (Seattle) and stock price (AAPL) in a single query." ;
    :promptOutputIndicator "Agent should provide combined results for both parts (weather and stock price). Tool results should be incorporated into final agent response." .

:getWeatherTask rdf:type :Task ;
    dct:title "Get Weather Task" ;
    :performedBy :weatherTool ;
    :requiresCapability :cap_getWeather ;
    :producedResource :weatherDataResource ;
    :contributesToObjective :fulfillUserRequestObjective ;
    dct:description "Task representing the action to obtain current weather for a location. Executed by the Weather Tool which returns a structured JSON-like result with temperature, feelsLike, humidity, windSpeed, windGust, conditions, and location." .

:weatherDataResource rdf:type beam:Instance ;
    dct:title "Weather Data Resource (result)" ;
    dct:description """Resource produced by getWeather: JSON object with fields:
- temperature: number
- feelsLike: number
- humidity: number
- windSpeed: number
- windGust: number
- conditions: string (derived from weather_code)
- location: string
This resource is produced by the getWeather tool and consumed by the agent for final response composition.""";
    dct:reference "produced by weatherTool.getWeather" .

:getStockPriceTask rdf:type :Task ;
    dct:title "Get Stock Price Task" ;
    :performedBy :stockPriceTool ;
    :requiresCapability :cap_getStockPrice ;
    :producedResource :stockPriceResource ;
    :contributesToObjective :fulfillUserRequestObjective ;
    dct:description "Task representing the action to obtain the most recent stock close price for a given symbol. Executed by the Stock Price Tool which returns a JSON-like result with symbol and currentPrice." .

:stockPriceResource rdf:type beam:Instance ;
    dct:title "Stock Price Resource (result)" ;
    dct:description """Resource produced by getStockPrice: JSON object with fields:
- symbol: string
- currentPrice: number
This resource is produced by the getStockPrice tool and consumed by the agent for final response composition.""";
    dct:reference "produced by stockPriceTool.getStockPrice" .

:fulfillUserRequestObjective rdf:type :Objective ;
    dct:title "Fulfill user combined stock and weather request" ;
    :contributesToGoal :provideCombinedInfoGoal ;
    dct:description "Objective grouping the sub-tasks needed to respond to the user (get weather, get stock price, compose reply)." .

:provideCombinedInfoGoal rdf:type :Goal ;
    dct:title "Provide combined stock and weather information" ;
    dct:description "Goal representing the desired final state: a composed answer to the user that includes both current weather for requested location and current stock price for requested symbol." .

###############################################################################
# Workflow pattern and steps
###############################################################################

:StockWeatherWorkflow rdf:type :WorkflowPattern ;
    dct:title "Stock + Weather Workflow Pattern" ;
    :hasWorkflowStep :StartStockWeatherStep ,
                     :WeatherLookupStep ,
                     :StockLookupStep ,
                     :EndStockWeatherStep ;
    dct:description "A simple sequential workflow pattern: start -> weather lookup -> stock lookup -> end. The agent orchestrates tool calls to satisfy the incoming user request." .

:StartStockWeatherStep rdf:type :StartStep ;
    dct:title "Start Step" ;
    :stepOrder 1 ;
    :hasAssociatedTask :userRequestTask ;
    dct:description "Initial step which receives or recognizes the user prompt and decides required sub-tasks (weather and stock lookups)." .

:WeatherLookupStep rdf:type :WorkflowStep ;
    dct:title "Weather Lookup Step" ;
    :stepOrder 2 ;
    :hasAssociatedTask :getWeatherTask ;
    :nextStep :StockLookupStep ;
    dct:description "Step that triggers the weather tool to fetch current weather for specified location." .

:StockLookupStep rdf:type :WorkflowStep ;
    dct:title "Stock Lookup Step" ;
    :stepOrder 3 ;
    :hasAssociatedTask :getStockPriceTask ;
    :nextStep :EndStockWeatherStep ;
    dct:description "Step that triggers the stock price tool to fetch the stock price for the specified symbol." .

:EndStockWeatherStep rdf:type :EndStep ;
    dct:title "End Step" ;
    :stepOrder 4 ;
    dct:description "Completion step where the agent composes results from the produced resources and crafts the final reply to the user." .

###############################################################################
# Team / System-level config and relationships
###############################################################################

:mastraTeam rdf:type :Team ;
    dct:title "Mastra Example Team/System" ;
    :hasAgentMember :stockWeatherAgent ;
    :hasWorkflowPattern :StockWeatherWorkflow ;
    :hasSystemConfig :mastraSystemConfig ;
    dct:description "Conceptual team/system that contains the agent and the workflow pattern illustrating the runtime orchestration between the agent and tool servers." .

:mastraSystemConfig rdf:type :Config ;
    :configKey "mcp.servers" ;
    :configValue """stockPrice: launched via CLI 'npx -y tsx src/mastra/tools/stock-price.ts' (stdio transport); weather: SSE endpoint at http://localhost:8080/sse""";
    :configKey "note" ;
    :configValue "Tool servers are run as separate processes in the example runtime; their transport and launch details are recorded here textually." ;
    dct:description "System-level notes describing how tool servers are made available in the example environment (server launch and transport details are environment/runtime information)." .

###############################################################################
# Relations summarizing interactions and usage
###############################################################################

# Agent interacts with itself or other agents (none in this example)
# Agent operates in an environment (runtime) - captured as descriptive config
:localDevEnvironment rdf:type :Environment ;
    dct:title "Local Developer Environment (example)" ;
    :envType "local" ;
    :hasEnvironmentConfig :localDevEnvironmentConfig ;
    dct:description "Describes the example execution environment where servers are spawned locally and an SSE endpoint is used for the weather tool." .

:localDevEnvironmentConfig rdf:type :Config ;
    :configKey "sse.endpoint" ;
    :configValue "http://localhost:8080/sse" ;
    :configKey "stdio.launchedTool" ;
    :configValue "stock-price tool launched via stdio (npx -y tsx src/mastra/tools/stock-price.ts)" ;
    dct:description "Configuration describing the runtime environment used in the example." .

:stockWeatherAgent :operatesIn :localDevEnvironment .

# Tools require/consume external resources (APIs)
:getWeatherTask :requiresResource :openMeteoApi ,
                         :openMeteoGeocodingApi .

:getStockPriceTask :requiresResource :mastraStockApi .

# Tool usage linking (tools may use other tools in ontology; none in example)
# Agent directly uses tools (already declared via :agentToolUsage above)
# Task produced resources linked above (weatherDataResource, stockPriceResource)

###############################################################################
# Additional descriptive notes captured as descriptions (not executable code)
###############################################################################

:notes_example rdf:type :Context ;
    dct:title "Implementation notes (semantic summary)" ;
    dct:description """Runtime and implementation details summarized:
- An LLM agent (stockWeatherAgent) receives a user prompt and orchestrates two tool calls (weather and stock).
- The stock tool obtains the closing price for a given symbol from an external API and returns a JSON string with {symbol, currentPrice}.
- The weather tool performs geocoding and queries a weather API to return structured weather data; it is exposed over SSE in the example runtime.
- The agent is configured to use model 'gpt-4o'.
- Tool input schemas (symbol, location) are recorded in tool Config entries as JSON-like strings.
- Server and transport specifics are recorded textually in Config because the ontology does not have Server or Transport classes.
""".

# End of instance data.