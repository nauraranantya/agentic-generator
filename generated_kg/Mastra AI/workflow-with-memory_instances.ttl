# Execution time: 109.06 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology does not provide a dedicated property to represent workflow trigger schemas; trigger schemas are included in rdfs:comment / dc:description of the WorkflowPattern.
# - The ontology has no explicit property to represent variable bindings between workflow steps; variable mappings are represented in dc:description on WorkflowStep individuals.
# - Zod schemas (input/output schemas) and JS execution logic cannot be represented natively; they are preserved as literal strings (JSON or code-like text) in dc:description and Prompt properties.
# - The Postgres connection string is stored in an environment variable in the source (process.env.POSTGRES_URL). For security and fidelity, the ontology stores this as the placeholder "env:POSTGRES_URL" rather than an actual connection string.
# - There is no class/property to express "tool implementation details" or "SDK usage"; tool behavior is modelled semantically (id, description, input/output contract, produced resource) using existing classes/properties.
# - The Mastra system object (app-level) is modelled as a :Team to reuse hasAgentMember / hasWorkflowPattern semantics.
# - Conditional "when" expressions and cyclical behavior in workflows are stored as structured text inside dc:description of the affected WorkflowStep(s).

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# System / Team
#################################################################

:mastra-system a :Team ;
    rdfs:label "Mastra System" ;
    dc:title "Mastra" ;
    rdfs:comment "Agentic orchestration system containing agents, workflows, tools, and system configuration as defined in src/mastra/index.ts." ;
    :hasAgentMember :catOneAgent ;
    :hasWorkflowPattern :sequentialWorkflowPattern ,
                        :parallelWorkflowPattern ,
                        :branchedWorkflowPattern ,
                        :cyclicalWorkflowPattern ;
    :hasSystemConfig :mastra-logger-config , :mastra-env-config .

:mastra-logger-config a :Config ;
    :configKey "logger.name" ;
    :configValue "Mastra" ;
    rdfs:comment "Pino logger configuration used by the system (name & level)." .

:mastra-env-config a :Config ;
    :configKey "logger.level" ;
    :configValue "debug" ;
    rdfs:comment "Pino logger level configured to 'debug' in Mastra instantiation." .

#################################################################
# Agent: Cat One
#################################################################

:catOneAgent a :LLMAgent ;
    dc:title "Cat One" ;
    :agentID "cat-one" ;
    :agentRole "feline expert" ;
    rdfs:comment "LLM-based agent instance exported as catOne in src/mastra/agents/index.ts." ;
    :agentPrompt :catOne_agent_prompt ;
    :useLanguageModel :gpt4o_model ;
    :hasAgentConfig :catOne_model_config , :catOne_memory_config ;
    :hasKnowledge :catOne_memory .

:catOne_agent_prompt a :Prompt ;
    :promptInstruction """You are a feline expert with comprehensive knowledge of all cat species, from domestic breeds to wild big cats. As a lifelong cat specialist, you understand their behavior, biology, social structures, and evolutionary history in great depth.""" ;
    :promptContext "Agent role and long-form instructions provided in Agent instantiation (instructions in source code)." ;
    rdfs:label "Cat One Agent Instructions" .

:gpt4o_model a :LanguageModel ;
    dc:title "gpt-4o" ;
    dc:description "Language model selected by the Cat One agent via openai('gpt-4o'). Represents the LLM backend used by the agent." ;
    rdfs:label "gpt-4o Language Model" .

:catOne_model_config a :Config ;
    :configKey "model" ;
    :configValue "gpt-4o" ;
    rdfs:comment "Agent-level configuration pointing to the OpenAI model used." .

:catOne_memory_config a :Config ;
    :configKey "memory.storage" ;
    :configValue "PostgresStore (env:POSTGRES_URL)" ;
    rdfs:comment "Memory storage configured with PostgresStore; the connection string is provided via environment variable POSTGRES_URL." .

:catOne_memory a :Memory ;
    rdfs:label "Cat One Memory" ;
    dc:description """Persistent memory instance for Cat One. In source code constructed as Memory({ storage: new PostgresStore({ connectionString }) }), where connectionString is obtained from process.env.POSTGRES_URL.
Stored implementation detail: PostgresStore-based memory (placeholder: env:POSTGRES_URL).""" .

#################################################################
# Tool: Get cat facts
#################################################################

:catFactTool a :Tool ;
    dc:title "Get cat facts" ;
    dc:description "Tool that fetches a cat fact from https://catfact.ninja/fact. Exported as catFact in src/mastra/tools/index.ts." ;
    :hasToolConfig :catFact_tool_input_config ;
    :hasCapability :cap_fetch_cat_fact .

:catFact_tool_input_config a :Config ;
    :configKey "inputSchema" ;
    :configValue "{}" ;
    rdfs:comment "Zod input schema: z.object({}). Represented as empty input object." .

:cap_fetch_cat_fact a :Capability ;
    rdfs:label "fetch cat fact" ;
    rdfs:comment "Capability of the tool: retrieve a cat fact string from a remote API." .

:catFactResource a beam:Resource ;
    dc:title "cat-fact" ;
    dc:description "Resource produced by the Get cat facts tool/task. Schema: { catFact: string }." ;
    rdfs:label "Cat Fact Resource" .

# A Task that describes the semantic contract of using the tool (tool performs this task).
:fetchCatFactTask a :Task ;
    dc:title "fetch-cat-fact task" ;
    dc:description """Task representing the operation of fetching a cat fact.
Input schema: {} (no input).
Output schema: { catFact: string }.
Behavior: calls GET https://catfact.ninja/fact, returns the 'fact' string as 'catFact'. Implemented by catFact tool in source code.""" ;
    :performedBy :catFactTool ;
    :producedResource :catFactResource ;
    :requiresCapability :cap_fetch_cat_fact .

#################################################################
# Tasks: Step definitions (stepOne .. stepSix)
#################################################################

:stepOneTask a :Task ;
    dc:title "stepOne" ;
    dc:description """Doubles the input value.
inputSchema: { inputValue: number }
outputSchema: { doubledValue: number }
execute: doubledValue = inputValue * 2""" ;
    :requiresCapability :cap_double .

:cap_double a :Capability ;
    rdfs:label "double numeric value" .

:stepTwoTask a :Task ;
    dc:title "stepTwo" ;
    dc:description """Adds 1 to the input value.
inputSchema: { valueToIncrement: number }
outputSchema: { incrementedValue: number }
execute: incrementedValue = valueToIncrement + 1""" ;
    :requiresCapability :cap_increment .

:cap_increment a :Capability ;
    rdfs:label "increment numeric value by 1" .

:stepThreeTask a :Task ;
    dc:title "stepThree" ;
    dc:description """Squares the input value.
inputSchema: { valueToSquare: number }
outputSchema: { squaredValue: number }
execute: squaredValue = valueToSquare * valueToSquare""" ;
    :requiresCapability :cap_square .

:cap_square a :Capability ;
    rdfs:label "square numeric value" .

:stepFourTask a :Task ;
    dc:title "stepFour" ;
    dc:description """Gives the square root of the input value.
inputSchema: { valueToRoot: number }
outputSchema: { rootValue: number }
execute: rootValue = Math.sqrt(valueToRoot)""" ;
    :requiresCapability :cap_sqrt .

:cap_sqrt a :Capability ;
    rdfs:label "square root numeric value" .

:stepFiveTask a :Task ;
    dc:title "stepFive" ;
    dc:description """Triples the input value.
inputSchema: { inputValue: number }
outputSchema: { tripledValue: number }
execute: tripledValue = inputValue * 3""" ;
    :requiresCapability :cap_triple .

:cap_triple a :Capability ;
    rdfs:label "triple numeric value" .

:stepSixTask a :Task ;
    dc:title "stepSix" ;
    dc:description """Logs the input value to console and returns it as raw text.
inputSchema: { inputValue: number }
outputSchema: { rawText: string }
execute: console.log(inputValue); return { rawText: inputValue.toString() }""" ;
    :requiresCapability :cap_log .

:cap_log a :Capability ;
    rdfs:label "log numeric value and return raw text" .

#################################################################
# WorkflowPattern: sequential-workflow
#################################################################

:sequentialWorkflowPattern a :WorkflowPattern ;
    dc:title "sequential-workflow" ;
    dc:description """Trigger schema: { firstValue: number }.
Semantics: linear pipeline of six steps where each step consumes the previous step's output according to variable mapping described in each WorkflowStep's dc:description.""" ;
    :hasWorkflowStep :seq_wfs_step1 , :seq_wfs_step2 , :seq_wfs_step3 , :seq_wfs_step4 , :seq_wfs_step5 ;
    rdfs:label "sequential-workflow pattern" .

:seq_wfs_step1 a :StartStep ;
    rdfs:label "sequential stepOne (start)" ;
    :hasAssociatedTask :stepOneTask ;
    :stepOrder 1 ;
    dc:description """variables mapping:
- inputValue <- trigger.firstValue
(i.e., stepOne.inputValue is bound to workflow trigger 'firstValue').""" ;
    :nextStep :seq_wfs_step2 .

:seq_wfs_step2 a :WorkflowStep ;
    rdfs:label "sequential stepTwo" ;
    :hasAssociatedTask :stepTwoTask ;
    :stepOrder 2 ;
    dc:description """variables mapping:
- valueToIncrement <- stepOne.doubledValue""" ;
    :nextStep :seq_wfs_step3 .

:seq_wfs_step3 a :WorkflowStep ;
    rdfs:label "sequential stepThree" ;
    :hasAssociatedTask :stepThreeTask ;
    :stepOrder 3 ;
    dc:description """variables mapping:
- valueToSquare <- stepTwo.incrementedValue""" ;
    :nextStep :seq_wfs_step4 .

:seq_wfs_step4 a :WorkflowStep ;
    rdfs:label "sequential stepFour" ;
    :hasAssociatedTask :stepFourTask ;
    :stepOrder 4 ;
    dc:description """variables mapping:
- valueToRoot <- stepThree.squaredValue""" ;
    :nextStep :seq_wfs_step5 .

:seq_wfs_step5 a :EndStep ;
    rdfs:label "sequential stepFive (end)" ;
    :hasAssociatedTask :stepFiveTask ;
    :stepOrder 5 ;
    dc:description """variables mapping:
- inputValue <- stepFour.rootValue
End of pipeline produces tripledValue from stepFive as final output.""" .

#################################################################
# WorkflowPattern: parallel-workflow
#################################################################

:parallelWorkflowPattern a :WorkflowPattern ;
    dc:title "parallel-workflow" ;
    dc:description """Trigger schema: { firstValue: number }.
Semantics: starts multiple steps such that stepOne -> stepSix (uses stepOne output), and stepTwo and stepThree are started independently using the trigger value.""" ;
    :hasWorkflowStep :par_wfs_step1 , :par_wfs_step2 , :par_wfs_step3 , :par_wfs_step4 ;
    rdfs:label "parallel-workflow pattern" .

:par_wfs_step1 a :StartStep ;
    rdfs:label "parallel stepOne" ;
    :hasAssociatedTask :stepOneTask ;
    :stepOrder 1 ;
    dc:description """variables mapping:
- inputValue <- trigger.firstValue""" ;
    :nextStep :par_wfs_step2 .

:par_wfs_step2 a :WorkflowStep ;
    rdfs:label "parallel stepSix (after stepOne)" ;
    :hasAssociatedTask :stepSixTask ;
    :stepOrder 2 ;
    dc:description """variables mapping:
- inputValue <- stepOne.doubledValue""" .

:par_wfs_step3 a :WorkflowStep ;
    rdfs:label "parallel stepTwo (parallel branch)" ;
    :hasAssociatedTask :stepTwoTask ;
    :stepOrder 3 ;
    dc:description """variables mapping:
- valueToIncrement <- trigger.firstValue
(parallel independent execution)""" .

:par_wfs_step4 a :WorkflowStep ;
    rdfs:label "parallel stepThree (parallel branch)" ;
    :hasAssociatedTask :stepThreeTask ;
    :stepOrder 4 ;
    dc:description """variables mapping:
- valueToSquare <- trigger.firstValue
(parallel independent execution)""" .

#################################################################
# WorkflowPattern: branched-workflow
#################################################################

:branchedWorkflowPattern a :WorkflowPattern ;
    dc:title "branched-workflow" ;
    dc:description """Trigger schema: { firstValue: number }.
Semantics: main linear branch: stepOne -> stepTwo -> stepFour.
Concurrent/after branch: after(stepOne) start branch stepThree -> stepFive (dependent on stepThree).""" ;
    :hasWorkflowStep :br_wfs_step1 , :br_wfs_step2 , :br_wfs_step3 , :br_wfs_step4 , :br_wfs_step5 ;
    rdfs:label "branched-workflow pattern" .

:br_wfs_step1 a :StartStep ;
    rdfs:label "branched stepOne" ;
    :hasAssociatedTask :stepOneTask ;
    :stepOrder 1 ;
    dc:description """variables mapping:
- inputValue <- trigger.firstValue""" ;
    :nextStep :br_wfs_step2 ;
    :relatedStep :br_wfs_step3 .

:br_wfs_step2 a :WorkflowStep ;
    rdfs:label "branched stepTwo" ;
    :hasAssociatedTask :stepTwoTask ;
    :stepOrder 2 ;
    dc:description """variables mapping:
- valueToIncrement <- stepOne.doubledValue""" ;
    :nextStep :br_wfs_step4 .

:br_wfs_step3 a :WorkflowStep ;
    rdfs:label "branched stepThree (branch after stepOne)" ;
    :hasAssociatedTask :stepThreeTask ;
    :stepOrder 3 ;
    dc:description """variables mapping:
- valueToSquare <- stepOne.doubledValue
This step is started after stepOne (branch).""" ;
    :nextStep :br_wfs_step5 .

:br_wfs_step4 a :WorkflowStep ;
    rdfs:label "branched stepFour" ;
    :hasAssociatedTask :stepFourTask ;
    :stepOrder 4 ;
    dc:description """variables mapping:
- valueToRoot <- stepTwo.incrementedValue""" .

:br_wfs_step5 a :EndStep ;
    rdfs:label "branched stepFive (branch end)" ;
    :hasAssociatedTask :stepFiveTask ;
    :stepOrder 5 ;
    dc:description """variables mapping:
- inputValue <- stepThree.squaredValue
This completes the branch started after stepOne.""" .

#################################################################
# WorkflowPattern: cyclical-workflow (with conditional when)
#################################################################

:cyclicalWorkflowPattern a :WorkflowPattern ;
    dc:title "cyclical-workflow" ;
    dc:description """Trigger schema: { firstValue: number }.
Semantics: includes cycles and conditions:
- stepThree executes after stepOne only if stepOne.doubledValue <= 6.
- stepOne is re-invoked as a step with a 'when' condition to continue cycle while stepOne.doubledValue <= 120000, mapping inputValue <- stepOne.doubledValue to iterate growth.
This structure encodes a loop that repeatedly doubles until threshold reached, running conditional stepThree on small values.""" ;
    :hasWorkflowStep :cyc_wfs_step1 , :cyc_wfs_step2 , :cyc_wfs_step3 , :cyc_wfs_step4 ;
    rdfs:label "cyclical-workflow pattern" .

:cyc_wfs_step1 a :StartStep ;
    rdfs:label "cyclical stepOne (initial)" ;
    :hasAssociatedTask :stepOneTask ;
    :stepOrder 1 ;
    dc:description """variables mapping:
- inputValue <- trigger.firstValue
This step may be iterated (see cyclical step that references stepOne again).""" ;
    :nextStep :cyc_wfs_step2 .

:cyc_wfs_step2 a :WorkflowStep ;
    rdfs:label "cyclical stepTwo" ;
    :hasAssociatedTask :stepTwoTask ;
    :stepOrder 2 ;
    dc:description """variables mapping:
- valueToIncrement <- trigger.firstValue""" ;
    :nextStep :cyc_wfs_step3 .

:cyc_wfs_step3 a :WorkflowStep ;
    rdfs:label "cyclical stepThree (conditional after stepOne)" ;
    :hasAssociatedTask :stepThreeTask ;
    :stepOrder 3 ;
    dc:description """when condition:
- ref: { step: stepOne, path: doubledValue }
- query: { $lte: 6 }
variables mapping:
- valueToSquare <- stepOne.doubledValue
Interpretation: stepThree executes only if stepOne.doubledValue <= 6 (conditional branch).""" ;
    :nextStep :cyc_wfs_step4 .

:cyc_wfs_step4 a :WorkflowStep ;
    rdfs:label "cyclical stepOne (loop back instance)" ;
    :hasAssociatedTask :stepOneTask ;
    :stepOrder 4 ;
    dc:description """This is a repeated invocation of stepOne to implement a cycle.
when condition:
- ref: { step: stepOne, path: doubledValue }
- query: { $lte: 120000 }
variables mapping:
- inputValue <- stepOne.doubledValue
Interpretation: re-run stepOne with its own doubledValue as input while doubledValue <= 120000 to create an exponential growth loop.""" ;
    :nextStep :cyc_wfs_step2 .

#################################################################
# Relationships: Agent -> Tools & Team -> Resources
#################################################################

# The Cat One agent is aware of (can use) the catFact tool conceptually (tool exists in repository).
:catOneAgent :agentToolUsage :catFactTool .

# Environment / context: Mastra system environment contains the cat fact resource as available resource
:mastra-environment a :Environment ;
    dc:title "Mastra Runtime Environment" ;
    :containsResource :catFactResource ;
    :hasEnvironmentConfig :mastra-env-config ;
    rdfs:comment "Runtime environment that contains resources/tools available to agents and tasks." .

#################################################################
# Additional metadata for reconstructability
#################################################################

# Workflow trigger schemas and step variable bindings are preserved in descriptions above.
# Task contracts (input/output schemas and execution logic) are preserved in dc:description literals for each Task.
# Tool contract and produced resource are modelled as :Tool, :Task (semantic task performed by tool), and beam:Resource.

# End of instance data.