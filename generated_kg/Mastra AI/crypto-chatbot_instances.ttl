# Execution time: 109.47 seconds
# Model used: gpt-5-mini

Issues / Assumptions:
- The source excerpt references a variable `systemPrompt` but its content was not included in the provided code. I created a placeholder Prompt individual to record this missing content and noted it as missing.
- The code uses Zod input schemas (programmatic structures). The ontology does not have a dedicated structure for representing typed schema objects; I preserved the schema textually in promptInputData literals (Zod textual representation).
- The code contains imperative execution logic (HTTP request flow and conditional branching: exact match vs contains match). The ontology has no property to represent executable code or control flow. I preserved the logic as descriptive text in promptContext/promptInstruction for tools/tasks.
- Environment variable values are referenced (process.env.POSTGRES_URL, process.env.COINGECKO_API_KEY). The ontology cannot safely store secrets or runtime-resolved values; I stored the variable names as literal strings in Config individuals.
- The ontology does not distinguish implementation classes (e.g., PostgresStore, PinoLogger). I modeled these as Config descriptions and resource descriptions rather than as new classes.
- No new classes or properties were added. All modelling uses only classes and properties present in the provided ontology.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix dct: <http://purl.org/dc/terms/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# System / Team
#################################################################

:MastraSystem rdf:type :Team ;
    dct:title "Mastra" ;
    rdfs:label "Mastra system" ;
    :hasAgentMember :CryptoAgent ;
    :hasSystemConfig :MastraSystemConfigLoggerName , :MastraSystemConfigLoggerLevel ;
    :hasWorkflowPattern :CryptoWorkflowPattern .

:MastraSystemConfigLoggerName rdf:type :Config ;
    :configKey "logger.name" ;
    :configValue "CONSOLE" ;
    dct:description "Logger configuration for Mastra created in mastra/index.ts." .

:MastraSystemConfigLoggerLevel rdf:type :Config ;
    :configKey "logger.level" ;
    :configValue "debug" ;
    dct:description "Logger level for Mastra created in mastra/index.ts." .

#################################################################
# Agent and Model
#################################################################

:CryptoAgent rdf:type :LLMAgent ;
    dct:title "Crypto Agent" ;
    :agentID "crypto-agent" ;
    :agentRole "crypto-agent" ;
    :hasAgentConfig :CryptoAgentConfig_ModelProvider , :CryptoAgentConfig_ModelName , :CryptoAgentConfig_MemoryStorageConnStr , :CryptoAgentConfig_MemoryOptionsSemanticRecall ;
    :hasKnowledge :CryptoAgentMemory ;
    :useLanguageModel :GPT_4O_Mini ;
    :agentToolUsage :SearchCryptoCoinsTool , :GetCryptoPriceTool , :GetHistoricalCryptoPricesTool ;
    :hasAgentCapability :CapabilitySearchCoins , :CapabilityGetPrice , :CapabilityGetHistoricalPrices ;
    dct:description "Agent created by createCryptoAgent in mastra/agents/index.ts. Has tools and memory configured and uses a language model." .

:CryptoAgentConfig_ModelProvider rdf:type :Config ;
    :configKey "modelProvider" ;
    :configValue "OPEN_AI" ;
    dct:description "Model provider passed to createMastra/createCryptoAgent in mastra/index.ts." .

:CryptoAgentConfig_ModelName rdf:type :Config ;
    :configKey "modelName" ;
    :configValue "gpt-4o-mini" ;
    dct:description "Model name passed to createMastra/createCryptoAgent in mastra/index.ts." .

:CryptoAgentConfig_MemoryStorageConnStr rdf:type :Config ;
    :configKey "memory.storage.connectionString" ;
    :configValue "process.env.POSTGRES_URL" ;
    dct:description "Postgres connection string referenced in mastra/agents/index.ts (process.env.POSTGRES_URL)." .

:CryptoAgentConfig_MemoryOptionsSemanticRecall rdf:type :Config ;
    :configKey "memory.options.semanticRecall" ;
    :configValue "false" ;
    dct:description "Memory options.semanticRecall set to false in mastra/agents/index.ts." .

:CryptoAgentMemory rdf:type :Memory ;
    dct:title "Crypto Agent Memory (PostgresStore)" ;
    dct:description "Memory object backed by a PostgresStore (connection string referenced via process.env.POSTGRES_URL). See mastra/agents/index.ts." ;
    :hasConfig :CryptoAgentConfig_MemoryStorageConnStr , :CryptoAgentConfig_MemoryOptionsSemanticRecall .

:GPT_4O_Mini rdf:type :LanguageModel ;
    dct:title "gpt-4o-mini" ;
    dct:description "Language model referenced in mastra/index.ts and mastra/agents/index.ts. Model provider: OPEN_AI; modelName: gpt-4o-mini." .

#################################################################
# Capabilities
#################################################################

:CapabilitySearchCoins rdf:type :Capability ;
    dct:description "Search available crypto coins by keyword (implements searchCryptoCoins tool behavior)." .

:CapabilityGetPrice rdf:type :Capability ;
    dct:description "Get current crypto price by coin id (implements getCryptoPrice tool behavior)." .

:CapabilityGetHistoricalPrices rdf:type :Capability ;
    dct:description "Get historical crypto prices for chart (implements getHistoricalCryptoPrices tool behavior)." .

#################################################################
# Tools (Tool definitions and configuration)
#################################################################

:SearchCryptoCoinsTool rdf:type :Tool ;
    dct:title "Search crypto coins" ;
    dct:description "Tool to search all available crypto coins by a keyword. Implements logic: fetch coin list from CoinGecko, try exact match by name (case-insensitive), if not found return first coin whose name contains the keyword." ;
    :hasToolConfig :SearchCryptoCoinsConfig_ApiKey , :SearchCryptoCoinsConfig_Endpoint ;
    :hasCapability :CapabilitySearchCoins ;
    :resourceUsage :CoinGeckoCoinListAPI ;
    rdfs:label "Search crypto coins tool" .

:SearchCryptoCoinsConfig_ApiKey rdf:type :Config ;
    :configKey "x-cg-demo-api-key (header)" ;
    :configValue "process.env.COINGECKO_API_KEY" ;
    dct:description "CoinGecko API key referenced in tool implementation." .

:SearchCryptoCoinsConfig_Endpoint rdf:type :Config ;
    :configKey "endpoint" ;
    :configValue "https://api.coingecko.com/api/v3/coins/list" ;
    dct:description "Endpoint used by searchCryptoCoins tool." .

:GetCryptoPriceTool rdf:type :Tool ;
    dct:title "Get crypto price by id" ;
    dct:description "Tool to get crypto price by coin id. Fetches market data for a given id from CoinGecko markets endpoint." ;
    :hasToolConfig :GetCryptoPriceConfig_ApiKey , :GetCryptoPriceConfig_Endpoint ;
    :hasCapability :CapabilityGetPrice ;
    :resourceUsage :CoinGeckoMarketsAPI ;
    rdfs:label "Get crypto price tool" .

:GetCryptoPriceConfig_ApiKey rdf:type :Config ;
    :configKey "x-cg-demo-api-key (header)" ;
    :configValue "process.env.COINGECKO_API_KEY" ;
    dct:description "CoinGecko API key referenced in tool implementation." .

:GetCryptoPriceConfig_Endpoint rdf:type :Config ;
    :configKey "endpoint" ;
    :configValue "https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids={id}" ;
    dct:description "Endpoint template used by getCryptoPrice tool (replace {id} with coin id)." .

:GetHistoricalCryptoPricesTool rdf:type :Tool ;
    dct:title "Get historical crypto prices for use in a chart" ;
    dct:description "Tool to retrieve historical price data for a coin. Returns an array of {timestamp,price}. Calls CoinGecko market_chart endpoint." ;
    :hasToolConfig :GetHistoricalCryptoPricesConfig_ApiKey , :GetHistoricalCryptoPricesConfig_Endpoint ;
    :hasCapability :CapabilityGetHistoricalPrices ;
    :resourceUsage :CoinGeckoMarketChartAPI ;
    rdfs:label "Get historical crypto prices tool" .

:GetHistoricalCryptoPricesConfig_ApiKey rdf:type :Config ;
    :configKey "x-cg-demo-api-key (header)" ;
    :configValue "process.env.COINGECKO_API_KEY" ;
    dct:description "CoinGecko API key referenced in tool implementation." .

:GetHistoricalCryptoPricesConfig_Endpoint rdf:type :Config ;
    :configKey "endpoint" ;
    :configValue "https://api.coingecko.com/api/v3/coins/{id}/market_chart?vs_currency=usd&days={days}" ;
    dct:description "Endpoint template used by getHistoricalCryptoPrices tool (replace {id} and {days})." .

#################################################################
# External resources (APIs) modeled as Resources
#################################################################

:CoinGeckoCoinListAPI rdf:type beam:Resource ;
    dct:title "CoinGecko coin list API (coins/list)" ;
    dct:description "External REST resource used by SearchCryptoCoinsTool: https://api.coingecko.com/api/v3/coins/list. Requires x-cg-demo-api-key header; key referenced as process.env.COINGECKO_API_KEY." .

:CoinGeckoMarketsAPI rdf:type beam:Resource ;
    dct:title "CoinGecko markets API (coins/markets)" ;
    dct:description "External REST resource used by GetCryptoPriceTool: https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids={id}. Requires x-cg-demo-api-key header." .

:CoinGeckoMarketChartAPI rdf:type beam:Resource ;
    dct:title "CoinGecko market_chart API (market_chart)" ;
    dct:description "External REST resource used by GetHistoricalCryptoPricesTool: https://api.coingecko.com/api/v3/coins/{id}/market_chart?vs_currency=usd&days={days}. Requires x-cg-demo-api-key header." .

#################################################################
# Prompt and Task modeling
#################################################################

# System prompt placeholder (content not provided in the source excerpt)
:SystemPrompt_Placeholder rdf:type :Prompt ;
    dct:title "systemPrompt (placeholder)" ;
    :promptInstruction "systemPrompt variable referenced by createCryptoAgent, content not included in provided source excerpts. (Placeholder recorded here.)" ;
    :promptContext "The system prompt was passed into the Agent as 'instructions' in the Agent constructor in mastra/agents/index.ts. Actual content not available in provided files." ;
    :promptOutputIndicator "n/a" .

# Task: Search crypto coins
:SearchCryptoCoinsPrompt rdf:type :Prompt ;
    dct:title "SearchCryptoCoins input description" ;
    :promptInstruction "Search all available crypto coins by a keyword." ;
    :promptInputData "z.object({ keyword: z.string() })" ;
    :promptContext "Tool implementation: fetch list from CoinGecko coins/list; first try an exact name match (case-insensitive); if not found, return first coin whose name contains the keyword. Logs: 'searchCryptoCoins exactMatch' or 'searchCryptoCoins containsMatch'." ;
    :promptOutputIndicator "Returns an object for a coin (example fields: id, symbol, name) or null." .

:SearchCryptoCoinsTask rdf:type :Task ;
    dct:title "Search crypto coins task" ;
    :hasPrompt :SearchCryptoCoinsPrompt ;
    :performedBy :SearchCryptoCoinsTool ;
    :producedResource :CoinInfoResource ;
    :requiresResource :CoinGeckoCoinListAPI ;
    dct:description "Semantic task corresponding to the searchCryptoCoins tool." .

:CoinInfoResource rdf:type beam:Instance ;
    dct:title "Coin info" ;
    dct:description "Resource representing a coin record returned by CoinGecko (id, symbol, name, etc.). Produced by SearchCryptoCoinsTask." .

# Task: Get crypto price by id
:GetCryptoPricePrompt rdf:type :Prompt ;
    dct:title "GetCryptoPrice input description" ;
    :promptInstruction "Get crypto price by coin id" ;
    :promptInputData "z.object({ id: z.string() })" ;
    :promptContext "Tool implementation: call CoinGecko coins/markets endpoint with vs_currency=usd and ids={id}; returns array with market data. If the returned array is empty, tool returns null. Logs 'getCryptoPrice for {id}'." ;
    :promptOutputIndicator "Returns an object with market data for the coin (price, market cap, etc.) or null." .

:GetCryptoPriceTask rdf:type :Task ;
    dct:title "Get crypto price task" ;
    :hasPrompt :GetCryptoPricePrompt ;
    :performedBy :GetCryptoPriceTool ;
    :requiresResource :CoinGeckoMarketsAPI ;
    :producedResource :CoinPriceResource ;
    dct:description "Semantic task corresponding to the getCryptoPrice tool." .

:CoinPriceResource rdf:type beam:Instance ;
    dct:title "Coin price" ;
    dct:description "Resource representing current market data for a coin as returned by CoinGecko's markets endpoint." .

# Task: Get historical crypto prices
:GetHistoricalCryptoPricesPrompt rdf:type :Prompt ;
    dct:title "GetHistoricalCryptoPrices input description" ;
    :promptInstruction "Get historical crypto prices for use in a chart" ;
    :promptInputData "z.object({ id: z.string(), days: z.number() })" ;
    :promptContext "Tool implementation: call CoinGecko coins/{id}/market_chart?vs_currency=usd&days={days}; transform returned 'prices' array into array of { timestamp: <number>, price: <number> } objects. Logs 'getHistoricalCryptoPrices for {id}'." ;
    :promptOutputIndicator "Returns an array of objects with timestamp and price fields for the historical series." .

:GetHistoricalCryptoPricesTask rdf:type :Task ;
    dct:title "Get historical crypto prices task" ;
    :hasPrompt :GetHistoricalCryptoPricesPrompt ;
    :performedBy :GetHistoricalCryptoPricesTool ;
    :requiresResource :CoinGeckoMarketChartAPI ;
    :producedResource :HistoricalPricesResource ;
    dct:description "Semantic task corresponding to the getHistoricalCryptoPrices tool." .

:HistoricalPricesResource rdf:type beam:Instance ;
    dct:title "Historical prices series" ;
    dct:description "Resource representing a time series of prices produced by GetHistoricalCryptoPricesTask. Each element is {timestamp, price}." .

#################################################################
# Workflow pattern and steps
#################################################################

:CryptoWorkflowPattern rdf:type :WorkflowPattern ;
    dct:title "Crypto info retrieval workflow" ;
    rdfs:comment "A simple sequential workflow pattern that 1) searches coin by keyword, 2) fetches current price for selected coin, 3) fetches historical prices for charting." ;
    :hasWorkflowStep :CryptoStep1_Search , :CryptoStep2_GetPrice , :CryptoStep3_GetHistorical ;
    rdfs:label "Crypto workflow pattern" .

:CryptoStep1_Search rdf:type :StartStep ;
    :stepOrder "1"^^xsd:integer ;
    :hasAssociatedTask :SearchCryptoCoinsTask ;
    :nextStep :CryptoStep2_GetPrice ;
    dct:description "Start step: find coin by keyword." .

:CryptoStep2_GetPrice rdf:type :WorkflowStep ;
    :stepOrder "2"^^xsd:integer ;
    :hasAssociatedTask :GetCryptoPriceTask ;
    :nextStep :CryptoStep3_GetHistorical ;
    dct:description "Fetch current market data for the selected coin." .

:CryptoStep3_GetHistorical rdf:type :EndStep ;
    :stepOrder "3"^^xsd:integer ;
    :hasAssociatedTask :GetHistoricalCryptoPricesTask ;
    dct:description "Final step: fetch historical prices for charting." .

#################################################################
# Links connecting agent, tools, tasks, resources, capabilities
#################################################################

# Agent uses the language model
:CryptoAgent :useLanguageModel :GPT_4O_Mini .

# Agent capabilities (already declared above) are linked
:SearchCryptoCoinsTool :hasCapability :CapabilitySearchCoins .
:GetCryptoPriceTool :hasCapability :CapabilityGetPrice .
:GetHistoricalCryptoPricesTool :hasCapability :CapabilityGetHistoricalPrices .

# Agent has agent capabilities
:CryptoAgent :hasAgentCapability :CapabilitySearchCoins , :CapabilityGetPrice , :CapabilityGetHistoricalPrices .

# Agent tool usage
:CryptoAgent :agentToolUsage :SearchCryptoCoinsTool , :GetCryptoPriceTool , :GetHistoricalCryptoPricesTool .

# Tasks performed by tools (already linked via performedBy above), also link that agent participated in tasks conceptually (agent orchestrates)
:CryptoAgent :participatedIn :SearchCryptoCoinsTask , :GetCryptoPriceTask , :GetHistoricalCryptoPricesTask .

#################################################################
# Additional notes kept as literal descriptions (non-executable)
#################################################################

:SearchCryptoCoinsTool dct:description """
Implementation notes (preserved textually):
- Fetches coin list from https://api.coingecko.com/api/v3/coins/list
- Header: accept: application/json
- Header: x-cg-demo-api-key: process.env.COINGECKO_API_KEY
- Logic: try exact match (coin.name.toLowerCase() === keyword.toLowerCase()); if found, return it; else find first coin where name includes keyword (case-insensitive) and return it; otherwise return null.
""" .

:GetCryptoPriceTool dct:description """
Implementation notes (preserved textually):
- Fetches from https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids={id}
- Header: accept: application/json
- Header: x-cg-demo-api-key: process.env.COINGECKO_API_KEY
- If returned array length === 0, return null; else return first element.
""" .

:GetHistoricalCryptoPricesTool dct:description """
Implementation notes (preserved textually):
- Fetches from https://api.coingecko.com/api/v3/coins/{id}/market_chart?vs_currency=usd&days={days}
- Header: accept: application/json
- Header: x-cg-demo-api-key: process.env.COINGECKO_API_KEY
- Returns data.prices mapped to objects { timestamp: price[0], price: price[1] }.
""" .

#################################################################
# End of instance population
#################################################################