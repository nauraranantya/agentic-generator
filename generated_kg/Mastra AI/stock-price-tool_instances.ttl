# Execution time: 54.11 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The source code contains framework-specific and runtime constructs (e.g., Mastra class, createTool, openai('gpt-4o'), fetch calls, function bodies). These cannot be modeled as executable code in the ontology; they are represented as descriptive literals in Config, Prompt and description properties.
# - The code shows two different agent identifiers: mastra.getAgent('stockAgent') (index.ts) and new Agent({ id: 'stock-agent', ... }) (agents/index.ts). This mismatch is preserved as a noted inconsistency; the ontology models the agent using the declared agent id 'stock-agent' and records the retrieval identifier used in the main script as a literal where appropriate.
# - The ontology has no explicit property to represent API endpoints, HTTP methods, or runtime logs. These are modeled as Config key/value literals associated with the Tool or as descriptive dcterms:description values.
# - The ontology cannot model code-level input schemas (zod schemas) as structured typed objects; the input schema is represented as a literal string in a Tool Config to preserve fidelity.
# - Execution ordering, concurrency, and runtime ephemeral values (e.g., the numeric currentPrice returned at runtime) are represented as producedResource individuals and described in literals. The actual runtime numeric value is not available in the source and thus not provided.
# - No new classes or properties were added; only existing classes and properties from the provided ontology were used.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# Instances representing the Mastra-based stock price agent solution
#################################################################

### System / Team: Mastra orchestration
:MastraSystem rdf:type :Team ;
              dcterms:title "Mastra (agent orchestration system)" ;
              dcterms:description "The runtime/host system that registers and exposes agents (in source: new Mastra({ agents: { stockAgent } })). This representation models the system logically as a Team that contains agent members and workflow patterns." ;
              :hasAgentMember :stock_agent ;
              :hasWorkflowPattern :FetchStockPricePattern .

### LLMAgent: stock agent (constructed in agents/index.ts)
:stock_agent rdf:type :LLMAgent ;
             rdfs:label "Stock Agent" ;
             :agentID "stock-agent" ;
             :agentRole "price_provider" ;
             :hasAgentConfig :stockAgentConfig ;
             :agentPrompt :stockAgentInstructionsPrompt ;
             :useLanguageModel :gpt4o ;
             :agentToolUsage :stockPricesTool ;
             dcterms:description "LLM-based agent configured to provide current stock prices. Source code: id: 'stock-agent', name: 'Stock Agent', instructions: 'You are a helpful assistant that provides current stock prices. When asked about a stock, use the stock price tool to fetch the stock price.', model: openai('gpt-4o'), tools: { stockPrices }." .

### Language Model used by the agent
:gpt4o rdf:type :LanguageModel ;
       rdfs:label "gpt-4o" ;
       dcterms:title "gpt-4o" ;
       dcterms:description "Language model selected via openai('gpt-4o') in the agent configuration. Modeled here as a LanguageModel individual to indicate the agent-model binding." .

### Agent configuration (key / value literals to preserve settings)
:stockAgentConfig rdf:type :Config ;
                  rdfs:label "Stock Agent Config" ;
                  :configKey "id" ;
                  :configValue "stock-agent" ;
                  :configKey "name" ;
                  :configValue "Stock Agent" ;
                  :configKey "model" ;
                  :configValue "gpt-4o" ;
                  :configKey "tools" ;
                  :configValue "stockPrices" ;
                  dcterms:description "Configuration settings derived from agent constructor (keeps model, id/name, and tool list as literal key/value entries)." .

### Agent instruction prompt (agent-level)
:stockAgentInstructionsPrompt rdf:type :Prompt ;
                             rdfs:label "Stock Agent Instructions" ;
                             :promptInstruction "You are a helpful assistant that provides current stock prices. When asked about a stock, use the stock price tool to fetch the stock price." ;
                             :promptContext "Agent-level instruction used as the LLM system prompt / persona." ;
                             dcterms:description "Agent instructions from agents/index.ts 'instructions' field. This prompt directs the agent to use the stockPrices tool when asked about stocks." .

### Tool: stockPrices (created via createTool)
:stockPricesTool rdf:type :Tool ;
                 rdfs:label "Get Stock Price (stockPrices)" ;
                 dcterms:title "Get Stock Price" ;
                 dcterms:description "Fetches the last day's closing stock price for a given symbol. Source tool implementation uses an HTTP fetch to https://mastra-stock-data.vercel.app/api/stock-data?symbol={symbol} and returns { symbol, currentPrice } with currentPrice mapped from data.prices['4. close']." ;
                 :hasToolConfig :stockPricesConfig ;
                 :hasCapability :FetchStockPriceCapability ;
                 :resourceUsage :StockAPI_Endpoint_Instance .

### Tool capability
:FetchStockPriceCapability rdf:type :Capability ;
                           rdfs:label "Fetch stock price capability" ;
                           rdfs:comment "Capability to retrieve a last-close stock price for a given ticker symbol." .

### Tool configuration (preserves input schema and endpoint notes)
:stockPricesConfig rdf:type :Config ;
                   rdfs:label "stockPrices Tool Config" ;
                   :configKey "id" ;
                   :configValue "Get Stock Price" ;
                   :configKey "inputSchema" ;
                   :configValue "z.object({ symbol: z.string() })" ;
                   :configKey "description" ;
                   :configValue "Fetches the last day's closing stock price for a given symbol" ;
                   :configKey "apiEndpoint" ;
                   :configValue "https://mastra-stock-data.vercel.app/api/stock-data?symbol={symbol}" ;
                   :configKey "executeNotes" ;
                   :configValue "Returns { symbol, currentPrice } where currentPrice is data.prices['4. close'] from the remote API. Implementation logs a console message when executing." ;
                   dcterms:description "Configuration representing the tool's documented input schema, remote API endpoint used in implementation, and execution notes (implementation detail preserved as literal)." .

### Resource representing the remote stock-data API (modeled as a Resource instance)
:StockAPI_Endpoint_Instance rdf:type beam:Instance ;
                           dcterms:title "mastra-stock-data API" ;
                           dcterms:description "External HTTP API endpoint used by the tool: https://mastra-stock-data.vercel.app/api/stock-data?symbol={symbol}. Modeled as a Resource the tool consumes." .

### Input resource representing the stock symbol provided as input
:AAPL_Symbol_Resource rdf:type beam:Instance ;
                      dcterms:title "Stock symbol: AAPL" ;
                      dcterms:description "The ticker symbol used as input in the example query (AAPL). The task prompt contains promptInputData 'AAPL'." .

### Output resource representing the produced stock price value
:AAPL_Price_Resource rdf:type beam:Instance ;
                     dcterms:title "AAPL current price (produced)" ;
                     dcterms:description "A numeric price value produced by executing the FetchStockPriceTask via the stockPrices tool. The tool returns a JSON object with key currentPrice mapped from the remote API (data.prices['4. close']). Value at runtime is not part of source code; this individual models the produced resource shape and label 'currentPrice'." .

### Task representing the user query and the agent/tool interaction
:FetchStockPriceTask rdf:type :Task ;
                    rdfs:label "Fetch stock price for symbol (AAPL example)" ;
                    :hasPrompt :stockQueryPrompt ;
                    :performedBy :stockPricesTool ;
                    :performedByAgent :stock_agent ;
                    :requiresResource :AAPL_Symbol_Resource ;
                    :producedResource :AAPL_Price_Resource ;
                    dcterms:description "Task representing the user's invocation in src/index.ts where the agent is asked: 'What is the current stock price of Apple (AAPL)?'. The agent handles the query using its model and invokes the stockPrices tool to fetch the numeric price." .

### Task-level prompt (the actual question string used in the example main())
:stockQueryPrompt rdf:type :Prompt ;
                  rdfs:label "Example user query prompt (AAPL)" ;
                  :promptInstruction "What is the current stock price of Apple (AAPL)?" ;
                  :promptInputData "AAPL" ;
                  :promptOutputIndicator "currentPrice (numeric)" ;
                  dcterms:description "The example query passed to agent.generate(...) in src/index.ts. This prompt triggers the agent to call the tool and obtain the 'currentPrice' field from the returned object." .

### Workflow pattern describing the simple fetch flow (start -> fetch -> end)
:FetchStockPricePattern rdf:type :WorkflowPattern ;
                        rdfs:label "Fetch Stock Price Pattern" ;
                        dcterms:description "A simple workflow pattern that accepts a stock-symbol query, has the agent generate and delegate to the stockPrices tool, and produces a numeric price as output." ;
                        :hasWorkflowStep :StartStep_FetchStockPrice ,
                                         :Step_FetchStockPrice ,
                                         :EndStep_FetchStockPrice .

:StartStep_FetchStockPrice rdf:type :StartStep ;
                           rdfs:label "Start: Receive stock query" ;
                           :stepOrder 0 ;
                           dcterms:description "Initial step: receive user query. In the example this corresponds to the call agent.generate('What is the current stock price of Apple (AAPL)?'). The code calls mastra.getAgent('stockAgent') then generate(...). Note: agent retrieval id in code ('stockAgent') differs from declared agent.id ('stock-agent') â€” see Issues/Assumptions." .

:Step_FetchStockPrice rdf:type :WorkflowStep ;
                     rdfs:label "Fetch step: agent uses tool" ;
                     :stepOrder 1 ;
                     :hasAssociatedTask :FetchStockPriceTask ;
                     :nextStep :EndStep_FetchStockPrice ;
                     dcterms:description "Workflow step where the LLMAgent (stock_agent) processes the query using its LanguageModel and invokes the stockPrices tool to fetch the numeric price." .

:EndStep_FetchStockPrice rdf:type :EndStep ;
                        rdfs:label "End: Present price to user" ;
                        :stepOrder 2 ;
                        dcterms:description "Final step: format or present the fetched price. In src/index.ts this is represented by code that reads toolResults to find toolName === 'stockPrices' and then prints currentPrice to console." .

#################################################################
# Additional descriptive individuals to preserve code-level details
#################################################################

### Representation of the example main invocation (as a contextual Task-like description)
:MainInvocation rdf:type :Task ;
                rdfs:label "Example program invocation (src/index.ts)" ;
                dcterms:description "Sequence in source: const stockAgent = mastra.getAgent('stockAgent'); const response = await stockAgent.generate('What is the current stock price of Apple (AAPL)?'); The runtime inspects response.toolResults to find an entry where toolName === 'stockPrices' and reads result.currentPrice, then logs 'The current price of Apple (AAPL) is $<currentPrice>'." ;
                :hasPrompt :stockQueryPrompt ;
                :performedByAgent :stock_agent ;
                :producedResource :AAPL_Price_Resource .

#################################################################
# Cross-links / provenance hints
#################################################################

# The Mastra system contains the agent and the pattern that describes how fetch requests are handled.
:MastraSystem :hasAgentMember :stock_agent ;
              :hasWorkflowPattern :FetchStockPricePattern .

# Link the workflow pattern to the team/system that uses it (already above), and indicate the agent participates in the FetchStockPriceTask
:stock_agent beam:participatedIn :FetchStockPriceTask .
# The human user who initiated the example query is not present in the source; if available such an individual could be modeled as a HumanAgent and linked via humanParticipatedIn.

# End of instances.