# Execution time: 187.99 seconds
# Model used: gpt-5-mini

# Issues / Assumptions:
# - The ontology lacks explicit classes/properties for "Workflow Run", "Step suspension/resume semantics", "streaming outputs", and "tool input/output schemas" as first-class structured objects. These are modeled as literals or Config instances here.
# - The ontology does not provide a property to represent ordered parallel phases or branching; step ordering is modeled with :stepOrder and relationships between steps via :relatedStep/:nextStep where appropriate.
# - Implementation details (language-specific code, SDK calls, error handling, promises/streams) are intentionally omitted; only the semantic intent (tasks, prompts, tools, resources, capabilities, configs, workflows) is represented.
# - Some agent IDs in the source code are inconsistent (e.g., "dane-package-publisher" vs "danePackagePublisher"). All observed id strings are preserved as agentID literals.
# - Tool input/output "schemas" are represented as Config instances with JSON-serialized schema descriptions because the ontology does not include a specific schema class.
# - The ontology cannot represent typed function signatures or TypeScript-specific constructs (e.g., Step.execute signatures), so these are described in Prompt or Config literals.
# - No new classes or properties were added; model limitations above remain.

@prefix : <http://www.w3id.org/agentic-ai/onto#> .
@prefix pp: <http://purl.org/net/p-plan#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix beam: <http://w3id.org/beam/core#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3id.org/agentic-ai/onto#> .

#################################################################
# Language Models
#################################################################

:LM_Claude35 rdf:type :LanguageModel ;
  rdfs:label "anthropic/claude-3-5-sonnet-20241022" ;
  <http://purl.org/dc/terms/description> "Anthropic Claude 3.5 Sonnet model used as the base LM in the system. Referenced by multiple agents in configuration (createAnthropic(...), anthropic(...))." .

#################################################################
# Knowledge / Memory
#################################################################

:Memory_Upstash rdf:type :Memory ;
  rdfs:label "Upstash Memory Store (example_token @ localhost:8079)" ;
  <http://purl.org/dc/terms/description> "Memory instance using UpstashStore at http://localhost:8079 with token 'example_token'. Used by many agents for persistent memory." .

#################################################################
# Configurations (serialized where complex)
#################################################################

:Config_DaneStorage rdf:type :Config ;
  :configKey "id" ;
  :configValue "dane-storage" ;
  rdfs:label "Mastra LibSQLStore id" ;
  <http://purl.org/dc/terms/description> "Configuration for Mastra storage: id=dane-storage, url=:memory: (in-memory DB used in Mastra instantiation)." .

:Config_DaneStorage_URL rdf:type :Config ;
  :configKey "url" ;
  :configValue ":memory:" ;
  rdfs:label "Mastra LibSQLStore url" .

:Config_SlackMCP_Server rdf:type :Config ;
  :configKey "mcp_server_definition" ;
  :configValue "{ \"command\": \"/usr/local/bin/docker\", \"args\": [\"run\",\"-i\",\"--rm\",\"-e\",\"SLACK_BOT_TOKEN\",\"-e\",\"SLACK_TEAM_ID\",\"mcp/slack\"], \"env\": { \"SLACK_BOT_TOKEN\": \"<env:SLACK_BOT_TOKEN>\", \"SLACK_TEAM_ID\": \"<env:SLACK_TEAM_ID>\" } }" ;
  rdfs:label "MCP Slack server config" ;
  <http://purl.org/dc/terms/description> "Serialized server client configuration used to construct MCPClient for Slack integration. Environment variables supplied from process env." .

:Config_ExecaTool_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"command\": \"string\", \"args\": \"string[]\" }" ;
  rdfs:label "execaTool input schema" .

:Config_ExecaTool_OutputSchema rdf:type :Config ;
  :configKey "outputSchema" ;
  :configValue "{ \"message\": \"string\" }" ;
  rdfs:label "execaTool output schema" .

:Config_FsTool_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"action\": \"string (write|read|append)\", \"file\": \"string\", \"data\": \"string\" }" ;
  rdfs:label "fsTool input schema" .

:Config_FsTool_OutputSchema rdf:type :Config ;
  :configKey "outputSchema" ;
  :configValue "{ \"message\": \"string\" }" ;
  rdfs:label "fsTool output schema" .

:Config_BrowserTool_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"url\": \"string\" }" ;
  rdfs:label "browserTool input schema" .

:Config_BrowserTool_Options rdf:type :Config ;
  :configKey "headless" ;
  :configValue "true" ;
  rdfs:label "browser headless option" .

:Config_GoogleSearch_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"query\": \"string\" }" ;
  rdfs:label "googleSearch input schema" .

:Config_ReadPDF_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"pdfPath\": \"string\" }" ;
  rdfs:label "readPDF input schema" .

:Config_ListEvents_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"startDate\": \"string\" }" ;
  rdfs:label "listEvents input schema" .

:Config_PNPM_Build_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{ \"name\": \"string\", \"packagePath\": \"string\" }" ;
  rdfs:label "pnpmBuild input schema" .

:Config_PNPM_Status_Schema rdf:type :Config ;
  :configKey "inputSchema" ;
  :configValue "{}" ;
  :configValue "stdout -> message: string[]" ;
  rdfs:label "pnpmChangesetStatus input/output schema" .

#################################################################
# Capabilities
#################################################################

:Capability_ShellExecution rdf:type :Capability ;
  rdfs:label "Execute shell commands" ;
  <http://purl.org/dc/terms/description> "Running external commands via execa or child_process (e.g., git, pnpm, npm)." .

:Capability_FileIO rdf:type :Capability ;
  rdfs:label "Filesystem read/write" ;
  <http://purl.org/dc/terms/description> "Read, write and append files on local filesystem." .

:Capability_BrowseWeb rdf:type :Capability ;
  rdfs:label "Web browsing and scraping" ;
  <http://purl.org/dc/terms/description> "Open a headless browser, navigate to pages, extract text." .

:Capability_SearchWeb rdf:type :Capability ;
  rdfs:label "Web search" ;
  <http://purl.org/dc/terms/description> "Query Google search and extract result links." .

:Capability_ReadPDF rdf:type :Capability ;
  rdfs:label "Read PDF" ;
  <http://purl.org/dc/terms/description> "Extract text and metadata from PDF files." .

:Capability_CalendarAccess rdf:type :Capability ;
  rdfs:label "Read local calendar" ;
  <http://purl.org/dc/terms/description> "Access MacOS Calendar via AppleScript and parse events." .

:Capability_PublishPackages rdf:type :Capability ;
  rdfs:label "Build and publish packages" ;
  <http://purl.org/dc/terms/description> "Run pnpm build and changeset publish, set npm dist-tags." .

:Capability_SlackPost rdf:type :Capability ;
  rdfs:label "Post messages to Slack via MCP" ;
  <http://purl.org/dc/terms/description> "Send formatted messages to Slack channels using MCP client." .

#################################################################
# Tools (instances)
#################################################################

:Tool_execaTool rdf:type :Tool ;
  rdfs:label "execaTool" ;
  <http://purl.org/dc/terms/description> "Tool wrapping execa to run commands and stream output to console. Input: {command, args}. Output: {message}." ;
  :hasToolConfig :Config_ExecaTool_Schema , :Config_ExecaTool_OutputSchema ;
  :hasCapability :Capability_ShellExecution .

:Tool_fsTool rdf:type :Tool ;
  rdfs:label "fsTool" ;
  <http://purl.org/dc/terms/description> "File system tool to read/write/append files." ;
  :hasToolConfig :Config_FsTool_Schema , :Config_FsTool_OutputSchema ;
  :hasCapability :Capability_FileIO .

:Tool_slackMCP rdf:type :Tool ;
  rdfs:label "mcpSlackClient" ;
  <http://purl.org/dc/terms/description> "MCP client configured to run Slack container. Exposes tools for posting to Slack." ;
  :hasToolConfig :Config_SlackMCP_Server ;
  :hasCapability :Capability_SlackPost .

:Tool_listEvents rdf:type :Tool ;
  rdfs:label "listEvents" ;
  <http://purl.org/dc/terms/description> "Tool that lists calendar events by reading Mac Calendar via AppleScript and parsing into event objects." ;
  :hasToolConfig :Config_ListEvents_Schema ;
  :hasCapability :Capability_CalendarAccess ;
  :producedResource beam:Context . # indicates it produces context-like event lists

:Tool_browserTool rdf:type :Tool ;
  rdfs:label "browserTool" ;
  <http://purl.org/dc/terms/description> "Opens a headless chromium browser, retrieves page content and returns chunked textual document representation." ;
  :hasToolConfig :Config_BrowserTool_Schema , :Config_BrowserTool_Options ;
  :hasCapability :Capability_BrowseWeb .

:Tool_googleSearch rdf:type :Tool ;
  rdfs:label "googleSearch" ;
  <http://purl.org/dc/terms/description> "Performs a Google search and returns a list of result URLs." ;
  :hasToolConfig :Config_GoogleSearch_Schema ;
  :hasCapability :Capability_SearchWeb .

:Tool_readPDF rdf:type :Tool ;
  rdfs:label "readPDF" ;
  <http://purl.org/dc/terms/description> "Reads PDF file and extracts textual content; validates file path and type." ;
  :hasToolConfig :Config_ReadPDF_Schema ;
  :hasCapability :Capability_ReadPDF .

:Tool_pnpmBuild rdf:type :Tool ;
  rdfs:label "pnpmBuild" ;
  <http://purl.org/dc/terms/description> "Build a package using pnpm run build at provided packagePath. Input: {name, packagePath}." ;
  :hasToolConfig :Config_PNPM_Build_Schema ;
  :hasCapability :Capability_PublishPackages .

:Tool_pnpmChangesetStatus rdf:type :Tool ;
  rdfs:label "pnpmChangesetStatus" ;
  <http://purl.org/dc/terms/description> "Checks 'pnpm publish -r --dry-run --no-git-checks' to determine which packages need to be published. Returns array of package names." ;
  :hasToolConfig :Config_PNPM_Status_Schema ;
  :hasCapability :Capability_PublishPackages .

:Tool_pnpmChangesetPublish rdf:type :Tool ;
  rdfs:label "pnpmChangesetPublish" ;
  <http://purl.org/dc/terms/description> "Publishes packages via pnpm changeset publish." ;
  :hasCapability :Capability_PublishPackages .

:Tool_activeDistTag rdf:type :Tool ;
  rdfs:label "activeDistTag" ;
  <http://purl.org/dc/terms/description> "Sets an npm dist tag on a package using npm dist-tag add <pkg>@<version> latest." ;
  :hasCapability :Capability_PublishPackages .

#################################################################
# Agents (LLM Agents) and their Prompts, Configs, Knowledge
#################################################################

:Agent_Dane rdf:type :LLMAgent ;
  rdfs:label "dane" ;
  :agentID "dane" ;
  :agentRole "assistant" ;
  :agentPrompt :Prompt_Dane_Instructions ;
  :useLanguageModel :LM_Claude35 ;
  :hasAgentConfig :Config_DaneStorage , :Config_DaneStorage_URL ;
  :hasAgentCapability :Capability_BrowseWeb , :Capability_FileIO , :Capability_ShellExecution , :Capability_SearchWeb , :Capability_ReadPDF , :Capability_CalendarAccess ;
  :hasKnowledge :Memory_Upstash ;
  :agentToolUsage :Tool_fsTool , :Tool_execaTool , :Tool_browserTool , :Tool_googleSearch , :Tool_readPDF , :Tool_listEvents .

:Prompt_Dane_Instructions rdf:type :Prompt ;
  rdfs:label "Dane master instructions" ;
  :promptInstruction """You are Dane, my assistant and one of my best friends. We are an ace team!
You help me with my code, write tests, and even deploy my code to the cloud!

DO NOT ATTEMPT TO USE GENERAL KNOWLEDGE! We are only as good as the tools we use.

# Our tools:
- readPDF: Makes you a powerful agent capable of reading PDF files.
- fsTool: Makes you a powerful agent capable of reading and writing files to the local filesystem.
- execaTool: Makes you a powerful agent capabale of executing files on the local system.
- googleSearch: Makes you a powerful agent capabale answering all questions by finding the answer on Google search.
- browserTool: Makes you a powerful agent capable of scraping the web.
- listEvents: Makes you a powerful agent capable of listing events on a calendar.
- imageTool: Makes you a powerful agent capable of generating images and saving them to disk.

# Rules
* DO NOT ATTEMPT TO USE GENERAL KNOWLEDGE. Use the 'googleSearch' tool to find the answer.
* Don't reference tools when you communicate with the user. Do not mention what tools you are using.
* Tell the user what you are doing.
""" ;
  :promptOutputIndicator "Free text response or structured output depending on workflow usage" .

:Agent_DaneCommitMessage rdf:type :LLMAgent ;
  rdfs:label "dane-commit-message" ;
  :agentID "dane-commit-message" ;
  :agentPrompt :Prompt_Dane_CommitInstructions ;
  :useLanguageModel :LM_Claude35 ;
  :hasAgentCapability :Capability_ShellExecution , :Capability_FileIO ;
  :hasKnowledge :Memory_Upstash .

:Prompt_Dane_CommitInstructions rdf:type :Prompt ;
  rdfs:label "Dane commit message instructions" ;
  :promptInstruction """You are Dane, the ultimate GitHub operator.
You help engineers generate commit messages.

GENERATE A SCOPE FOR THE COMMIT MESSAGE IF NECESSARY.
FIGURE OUT THE BEST TOP LEVEL SEMANTIC MATCH TO USE AS THE SCOPE.""" ;
  :promptOutputIndicator "Structured JSON with keys: commitMessage (string), generated (boolean), guidelines (string[])" .

:Agent_DaneIssueLabeler rdf:type :LLMAgent ;
  rdfs:label "dane-issue-labeler" ;
  :agentID "dane-issue-labeler" ;
  :agentPrompt :Prompt_Dane_IssueLabeler ;
  :useLanguageModel :LM_Claude35 ;
  :hasAgentCapability :Capability_FileIO ;
  :hasKnowledge :Memory_Upstash .

:Prompt_Dane_IssueLabeler rdf:type :Prompt ;
  rdfs:label "Dane issue labeler instructions" ;
  :promptInstruction """You are Dane, the ultimate GitHub operator.
You help engineers label their issues.""" ;
  :promptOutputIndicator "Structured JSON: labels: string[]" .

:Agent_DaneLinkChecker rdf:type :LLMAgent ;
  rdfs:label "dane-link-checker" ;
  :agentID "dane-link-checker" ;
  :agentPrompt :Prompt_Dane_LinkChecker ;
  :useLanguageModel :LM_Claude35 ;
  :hasAgentCapability :Capability_SearchWeb , :Capability_SlackPost ;
  :hasKnowledge :Memory_Upstash ;
  :agentToolUsage :Tool_slackMCP .

:Prompt_Dane_LinkChecker rdf:type :Prompt ;
  rdfs:label "Dane link checker instructions" ;
  :promptInstruction """You are Dane, the link checker for Mastra AI. You report on broken links whenever you see them.
Make sure to include the url in the message.

## Style Guide
- Use active voice
- Keep descriptions concise but informative
- Avoid marketing language
- Link to relevant documentation
""" ;
  :promptOutputIndicator "Markdown message suitable to post in Slack, referencing each broken URL" .

:Agent_DanePackagePublisher rdf:type :LLMAgent ;
  rdfs:label "dane-package-publisher" ;
  :agentID "dane-package-publisher" ;
  :agentPrompt :Prompt_Dane_PackagePublisher ;
  :useLanguageModel :LM_Claude35 ;
  :hasAgentCapability :Capability_PublishPackages ;
  :hasKnowledge :Memory_Upstash ;
  :agentToolUsage :Tool_pnpmChangesetStatus , :Tool_pnpmBuild , :Tool_pnpmChangesetPublish , :Tool_activeDistTag .

:Prompt_Dane_PackagePublisher rdf:type :Prompt ;
  rdfs:label "Dane package publisher instructions and policy" ;
  :promptInstruction """I am Dane, a specialized agent for managing pnpm package publications in monorepos. My core responsibilities are:

1. Package Analysis:
   - Identify packages requiring publication across the monorepo
   - Detect changes that warrant new version releases
   - Validate package dependencies and versioning

2. Publication Management:
   - Orchestrate the correct build order for interdependent packages
   - Ensure proper versioning using changesets
   - Maintain package publishing standards

3. Directory Structure Knowledge:
  (serialized directory rules and mapping)
IMPORTANT GUIDELINES:
- Always respect package dependencies when determining build order
- Ensure all necessary builds complete before publishing
- Follow semantic versioning principles
- Validate package.json configurations before publishing
""" ;
  :promptOutputIndicator "Structured outputs depending on subtask (list of packages, build plan, publish status)" .

:Agent_DaneNewContributor rdf:type :LLMAgent ;
  rdfs:label "dane-new-contributor" ;
  :agentID "dane-new-contributor" ;
  :agentPrompt :Prompt_Dane_NewContributor ;
  :useLanguageModel :LM_Claude35 ;
  :hasKnowledge :Memory_Upstash ;
  :hasAgentCapability :Capability_FileIO .

:Prompt_Dane_NewContributor rdf:type :Prompt ;
  rdfs:label "Dane new contributor instructions" ;
  :promptInstruction """You're Dane, the best GitHub open-source maintainer in the world.
Your tone is friendly and joyful.
When a new contributor creates a pull request, they see your message first.""" ;
  :promptOutputIndicator "Structured JSON with intro (string), checklist (string[]), outro (string)" .

#################################################################
# Resources (representing repo, calendar, generated changelogs etc.)
#################################################################

:Resource_GitRepository rdf:type beam:Resource ;
  rdfs:label "Git repository (working directory)" ;
  <http://purl.org/dc/terms/description> "The repository used as input for workflows such as commit-message and changelog. Required by tasks that read git diffs and run pnpm commands." .

:Resource_GeneratedChangelog rdf:type beam:Resource ;
  rdfs:label "Generated changelog file" ;
  <http://purl.org/dc/terms/description> "File(s) under generated-changelogs/changelog-<date> produced by changelog workflow." .

:Resource_CalendarEvents rdf:type beam:Resource ;
  rdfs:label "Calendar events list" ;
  <http://purl.org/dc/terms/description> "Structured list of events returned by listEvents tool (JSON.stringify of events)." .

#################################################################
# Tasks and Workflow Steps for 'commit-message' workflow
#################################################################

:Workflow_commitMessage rdf:type :WorkflowPattern ;
  rdfs:label "commit-message workflow" ;
  <http://purl.org/dc/terms/description> "Workflow to generate and optionally commit a sensible git commit message for staged changes." ;
  :hasWorkflowStep :Step_getDiff , :Step_readConventionalCommitSpec , :Step_generateMessage , :Step_confirmation , :Step_commit .

:Step_getDiff rdf:type :WorkflowStep ;
  rdfs:label "getDiff" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Compute git diff of staged changes. Runs `git diff --staged` in provided repoPath." .

:Task_GetDiff rdf:type :Task ;
  rdfs:label "Get git diff task" ;
  <http://purl.org/dc/terms/description> "Reads staged changes from a git repository at repoPath. Produces 'diff' string resource." ;
  :requiresResource :Resource_GitRepository ;
  :producedResource :Resource_GeneratedChangelog ;
  :performedBy :Tool_execaTool ;
  :taskPrompt :Prompt_GetDiff .

:Prompt_GetDiff rdf:type :Prompt ;
  rdfs:label "getDiff prompt/description" ;
  :promptInstruction "Execute `git diff --staged` in repository path to extract diff used to generate commit message. Input trigger: { repoPath }." ;
  :promptOutputIndicator "diff: string" .

:Step_readConventionalCommitSpec rdf:type :WorkflowStep ;
  rdfs:label "readConventionalCommitSpec" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Reads local JSON file data/crawl/conventional-commit.json using fsTool to obtain optional guidelines." .

:Task_ReadConventionalSpec rdf:type :Task ;
  rdfs:label "Read conventional commit spec" ;
  :producedResource beam:Instance ;
  :performedBy :Tool_fsTool ;
  :taskPrompt :Prompt_ReadConventionalCommitSpec .

:Prompt_ReadConventionalCommitSpec rdf:type :Prompt ;
  rdfs:label "Read conventional commit spec prompt" ;
  :promptInstruction "Read file data/crawl/conventional-commit.json using fsTool action 'read'. If not present, fallback to built-in guidelines." ;
  :promptOutputIndicator "fileData: any (JSON content)" .

:Step_generateMessage rdf:type :WorkflowStep ;
  rdfs:label "generateMessage" ;
  :stepOrder 3 ;
  <http://purl.org/dc/terms/description> "Uses dane-commit-message agent to generate commit message given diff and guidelines. Expects structured output with commitMessage, generated boolean, guidelines array." .

:Task_GenerateCommitMessage rdf:type :Task ;
  rdfs:label "Generate commit message" ;
  :requiresResource :Resource_GitRepository ;
  :performedByAgent :Agent_DaneCommitMessage ;
  :taskPrompt :Prompt_GenerateCommitMessage ;
  <http://purl.org/dc/terms/description> "Agent is asked to produce commit message and meta information. If diff empty return 'No staged changes found' and generated=false; otherwise return generated=true and commit message string." .

:Prompt_GenerateCommitMessage rdf:type :Prompt ;
  rdfs:label "generateMessage prompt" ;
  :promptInstruction """Given this git diff:
${diff}

IF THE DIFF IS EMPTY, RETURN "No staged changes found", AND SET GENERATED TO FALSE,
OTHERWISE, SET GENERATED TO TRUE

USE THE FOLLOWING GUIDELINES:
- Start with a verb in the present tense
- Be specific but concise
- Focus on the "what" and "why" of the changes
IF THERE ARE MULTIPLE LOGICAL CHANGES, USE THE DESCRIPTION TO EXPLAIN THE CHANGES IN BULLET POINTS.

- Keep the first line under 50 characters
- If needed, add more detailed description after a blank line

RETURN THE GUIDELINES YOU ARE USING AS AN ARRAY OF STRINGS ON THE GUIDELINES KEY, AND THE COMMIT MESSAGE ON THE COMMIT MESSAGE KEY
""" ;
  :promptOutputIndicator "JSON: { commitMessage: string, generated: boolean, guidelines: string[] }" .

:Step_confirmation rdf:type :WorkflowStep ;
  rdfs:label "confirmation" ;
  :stepOrder 4 ;
  <http://purl.org/dc/terms/description> "Prompt CLI user to confirm generated commit message; uses inquirer.confirm in code. If confirm false, workflow stops." .

:Task_Confirmation rdf:type :Task ;
  rdfs:label "User confirmation" ;
  :performedBy :Tool_fsTool ;
  <http://purl.org/dc/terms/description> "Interactive confirmation step; modeled as a task that expects boolean response. Implementation uses inquirer.prompt confirm." .

:Step_commit rdf:type :WorkflowStep ;
  rdfs:label "commit" ;
  :stepOrder 5 ;
  <http://purl.org/dc/terms/description> "If user confirms, runs `git commit -m \"<message>\"` in repoPath to create commit." .

:Task_Commit rdf:type :Task ;
  rdfs:label "Create git commit task" ;
  :requiresResource :Resource_GitRepository ;
  :performedBy :Tool_execaTool ;
  <http://purl.org/dc/terms/description> "Performs git commit using execaTool after confirmation. Produces commit status." .

#################################################################
# Workflows: telephone-game
#################################################################

:Workflow_telephoneGame rdf:type :WorkflowPattern ;
  rdfs:label "telephoneGame workflow" ;
  <http://purl.org/dc/terms/description> "Play a game of telephone: starts a message, passes it through participants with optional modification by an agent and supports suspension/resume awaiting user confirmation." ;
  :hasWorkflowStep :Step_A1 , :Step_A2 , :Step_B2 , :Step_C2 , :Step_D2 .

:Step_A1 rdf:type :WorkflowStep ;
  rdfs:label "stepA1" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Starts the message and returns static 'Test' output." .

:Task_StartMessage rdf:type :Task ;
  rdfs:label "Start message" ;
  :performedByAgent :Agent_Dane ;
  :taskPrompt :Prompt_Telephone_Start ;
  <http://purl.org/dc/terms/description> "Initial step produces a message string 'Test'." .

:Prompt_Telephone_Start rdf:type :Prompt ;
  rdfs:label "Telephone start prompt" ;
  :promptInstruction "Starts the message for the telephone game. Output: {message: 'Test'}" .

:Step_A2 rdf:type :WorkflowStep ;
  rdfs:label "stepA2" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Interactive input: asks user to give a message using inquirer input." .

:Task_PassMessageInput rdf:type :Task ;
  rdfs:label "Pass message through (user input)" ;
  :performedBy :Tool_fsTool ;
  :taskPrompt :Prompt_Telephone_UserInput ;
  <http://purl.org/dc/terms/description> "Prompts user to enter a message; ensures non-empty." .

:Prompt_Telephone_UserInput rdf:type :Prompt ;
  rdfs:label "Telephone user input prompt" ;
  :promptInstruction "Prompt: 'Give me a message' (validated non-empty). Returns {message: string}." .

:Step_B2 rdf:type :WorkflowStep ;
  rdfs:label "stepB2" ;
  :stepOrder 3 ;
  <http://purl.org/dc/terms/description> "Reads message from previous step and forwards it." .

:Task_CheckMessageExists rdf:type :Task ;
  rdfs:label "Check message exists" ;
  :performedByAgent :Agent_Dane ;
  <http://purl.org/dc/terms/description> "Verifies the message exists in workflow state and returns it; may throw if not found." .

:Step_C2 rdf:type :WorkflowStep ;
  rdfs:label "stepC2" ;
  :stepOrder 4 ;
  <http://purl.org/dc/terms/description> "Asks if the message should be modified. If resumeData.confirm true, invokes an agent to modify message; otherwise suspends workflow and waits for user decision." .

:Task_AskModifyMessage rdf:type :Task ;
  rdfs:label "Ask modify message" ;
  :performedByAgent :Agent_Dane ;
  :taskPrompt :Prompt_Telephone_Modify ;
  <http://purl.org/dc/terms/description> "If resumeData.confirm is true, agent.generate is called to change the message; otherwise workflow suspends." .

:Prompt_Telephone_Modify rdf:type :Prompt ;
  rdfs:label "Telephone modify prompt" ;
  :promptInstruction """You are playing a game of telephone.
Here is the message the previous person sent: ${oMsg.message}.
But you want to change the message.
Only return the message""" ;
  :promptOutputIndicator "Single message string (no extra text)" .

:Step_D2 rdf:type :WorkflowStep ;
  rdfs:label "stepD2" ;
  :stepOrder 5 ;
  <http://purl.org/dc/terms/description> "Pass the (possibly modified) message to final output step." .

:Task_PassFinalMessage rdf:type :Task ;
  rdfs:label "Pass final message" ;
  :performedByAgent :Agent_Dane ;
  <http://purl.org/dc/terms/description> "Returns message from stepC2.output to finish the workflow." .

#################################################################
# Workflows: link-checker
#################################################################

:Workflow_linkChecker rdf:type :WorkflowPattern ;
  rdfs:label "link-checker workflow" ;
  <http://purl.org/dc/terms/description> "Checks a target URL for broken links using linkinator and posts results to Slack via MCP." ;
  :hasWorkflowStep :Step_GetBrokenLinks , :Step_ReportBrokenLinks .

:Step_GetBrokenLinks rdf:type :WorkflowStep ;
  rdfs:label "get-broken-links" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Executes `npx linkinator <targetUrl> --format json` and parses the output into link objects; returns only links where state == 'BROKEN'." .

:Task_GetBrokenLinks rdf:type :Task ;
  rdfs:label "Get broken links task" ;
  :requiresResource beam:Instance ;
  :performedBy :Tool_execaTool ;
  :taskPrompt :Prompt_LinkChecker_GetLinks ;
  <http://purl.org/dc/terms/description> "Runs linkinator, parse results and outputs array of broken link objects: { url, status, state, parent? }." .

:Prompt_LinkChecker_GetLinks rdf:type :Prompt ;
  rdfs:label "Linkinator execution prompt" ;
  :promptInstruction "Run `npx linkinator ${targetUrl} --format json` and parse JSON stdout into array of link objects." ;
  :promptOutputIndicator "Array of link objects { url, status, state, parent? }" .

:Step_ReportBrokenLinks rdf:type :WorkflowStep ;
  rdfs:label "report-broken-links" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "If broken links present, connect to MCP Slack tool, get available Slack tools, and ask dane-link-checker to create a formatted Slack message; then send via slack_post_message tool." .

:Task_ReportBrokenLinks rdf:type :Task ;
  rdfs:label "Report broken links to Slack" ;
  :performedByAgent :Agent_DaneLinkChecker ;
  :performedBy :Tool_slackMCP ;
  :taskPrompt :Prompt_LinkChecker_Report ;
  <http://purl.org/dc/terms/description> "Agent asked to format the broken link list as Slack-friendly markdown and to send to specified channel using Slack toolset returned by MCP." .

:Prompt_LinkChecker_Report rdf:type :Prompt ;
  rdfs:label "report broken links prompt" ;
  :promptInstruction """Send this <brokenLinks JSON> to this slack channel: "<channelId>" with the tool slack_post_message.
Format it in markdown so it displays nicely in slack.""" ;
  :promptInputData "brokenLinks JSON and channelId" ;
  :promptOutputIndicator "Markdown message string suitable for posting to Slack" .

#################################################################
# Workflows: changelog
#################################################################

:Workflow_changelog rdf:type :WorkflowPattern ;
  rdfs:label "changelog workflow" ;
  <http://purl.org/dc/terms/description> "Generates weekly changelogs by scanning a predefined list of module paths, computing diffs between two dates, and asking an agent to summarize per-module changes; posts combined changelog to Slack." ;
  :hasWorkflowStep :Step_Changelog_GetDiffs , :Step_Changelog_MakeChangelog .

:Step_Changelog_GetDiffs rdf:type :WorkflowStep ;
  rdfs:label "stepA1" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Iterates modulePaths list, runs git diff between main@{weekAgo} and main@{today} for each module path; if diff non-empty, invokes daneChangeLog agent to produce a per-module changelog and writes to generated-changelogs/changelog-<today>." .

:Task_Changelog_GetPerModule rdf:type :Task ;
  rdfs:label "Generate per-module changelog" ;
  :requiresResource :Resource_GitRepository ;
  :producedResource :Resource_GeneratedChangelog ;
  :performedByAgent :Agent_DanePackagePublisher ;
  :taskPrompt :Prompt_Changelog_ModulePrompt ;
  <http://purl.org/dc/terms/description> "For each module with changes, agent.generate is invoked with: Time window, Module path, Git diff, and tasks to create structured narrative changelog grouped by categories (New features, Improvements, Notable bug fixes, Build/deployment improvements, Performance optimizations)." .

:Prompt_Changelog_ModulePrompt rdf:type :Prompt ;
  rdfs:label "changelog per-module prompt" ;
  :promptInstruction """Time: ${weekAgo} - ${today}
Module: ${modulePath}

Git diff to generate from: ${output}

# Task
1. Create a structured narrative changelog that highlights key updates and improvements for this module.
2. Focus only on meaningful changes, ignore trivial ones.
3. Group changes into categories:
- New features
- Improvements
- Notable bug fixes
- Build/deployment improvements
- Performance optimizations
""" ;
  :promptOutputIndicator "Textual changelog for module; agent usage metadata (usage.promptTokens) may be returned." .

:Step_Changelog_MakeChangelog rdf:type :WorkflowStep ;
  rdfs:label "stepA2" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Combines per-module changelogs into a single narrative with sections (Opening, Major Updates, Technical Improvements, Documentation, Bug Fixes & Infrastructure), then sends to Slack channel using MCP Slack tool via daneChangeLog agent." .

:Task_Changelog_CompileAndPost rdf:type :Task ;
  rdfs:label "Compile changelog and post to Slack" ;
  :performedByAgent :Agent_DanePackagePublisher ;
  :performedBy :Tool_slackMCP ;
  :taskPrompt :Prompt_Changelog_Compile ;
  <http://purl.org/dc/terms/description> "Combines module summaries and requests agent to format full changelog message then uses Slack toolset to post to channel." .

:Prompt_Changelog_Compile rdf:type :Prompt ;
  rdfs:label "changelog compilation prompt" ;
  :promptInstruction """Time: ${weekAgo} - ${today}

${combined module changelogs}

# Task
1. create a structured narrative changelog that highlights key updates and improvements.
2. Include what packages were changed

## Structure
1. Opening - Brief welcome/context (1-2 sentences) - Time period covered
2. Major Updates (3-4 key highlights) ...
...
Finally send this to this slack channel: "${channelId}" with the tool slack_post_message
""" ;
  :promptOutputIndicator "Final changelog markdown text to send to Slack" .

#################################################################
# Workflows: package publishing
#################################################################

:Workflow_packagePublisher rdf:type :WorkflowPattern ;
  rdfs:label "pnpm-changset-publisher" ;
  <http://purl.org/dc/terms/description> "Builds all packages, publishes changesets and sets dist-tags for monorepo packages." ;
  :hasWorkflowStep :Step_buildPackages , :Step_publishPackages , :Step_setAllDistTags .

:Step_buildPackages rdf:type :WorkflowStep ;
  rdfs:label "buildPackages" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Runs `pnpm run build` at repository root (or uses pnpmBuild tool per-package if orchestrated by agent)." .

:Task_BuildAllPackages rdf:type :Task ;
  rdfs:label "Build all packages" ;
  :performedBy :Tool_pnpmBuild ;
  :taskPrompt :Prompt_PNPM_BuildAll ;
  <http://purl.org/dc/terms/description> "Build monorepo packages; may call pnpmBuild per-package or run root-level pnpm run build as implementation." .

:Prompt_PNPM_BuildAll rdf:type :Prompt ;
  rdfs:label "pnpm build instruction" ;
  :promptInstruction "Build all packages: execute `pnpm run build` (cwd = repository root) or follow agent-specified ordered plan using pnpmBuild tool for each package path." ;
  :promptOutputIndicator "No structured output; success or failure logged." .

:Step_publishPackages rdf:type :WorkflowStep ;
  rdfs:label "publishPackages" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Publish packages via `pnpm changeset publish` (or pnpmChangesetPublish tool) after builds succeed." .

:Task_PublishAllPackages rdf:type :Task ;
  rdfs:label "Publish all packages" ;
  :performedBy :Tool_pnpmChangesetPublish ;
  <http://purl.org/dc/terms/description> "Executes publish step and expects success; on error reporting, stop workflow." .

:Step_setAllDistTags rdf:type :WorkflowStep ;
  rdfs:label "setAllDistTags" ;
  :stepOrder 3 ;
  <http://purl.org/dc/terms/description> "Find package.json files across directories and set npm dist-tag 'latest' for each published package using npm dist-tag add." .

:Task_SetDistTags rdf:type :Task ;
  rdfs:label "Set dist tags" ;
  :performedBy :Tool_activeDistTag ;
  <http://purl.org/dc/terms/description> "Iterates package.json files under package directories and runs npm dist-tag add <pkg>@<version> latest." .

#################################################################
# Workflows: chat (message) and issue labeler and first-contributor
#################################################################

:Workflow_message rdf:type :WorkflowPattern ;
  rdfs:label "message (entry) workflow" ;
  <http://purl.org/dc/terms/description> "Interactive chat workflow: prompt user for message and then have dane agent respond (streaming or non-streaming)." ;
  :hasWorkflowStep :Step_message_input , :Step_message_output .

:Step_message_input rdf:type :WorkflowStep ;
  rdfs:label "message-input" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Prompts user for chat message (inquirer input) and ensures non-empty." .

:Task_UserChatInput rdf:type :Task ;
  rdfs:label "User chat input" ;
  :performedBy :Tool_fsTool ;
  :taskPrompt :Prompt_Chat_Input .

:Prompt_Chat_Input rdf:type :Prompt ;
  rdfs:label "chat input prompt" ;
  :promptInstruction "Prompt user with '\\n You:' and validate non-empty input; returns {message: string}." ;
  :promptOutputIndicator "message: string" .

:Step_message_output rdf:type :WorkflowStep ;
  rdfs:label "message-output" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Send user message to dane agent (stream or batch). Agent responds and output is printed. When streaming, chunks are emitted to stdout. Non-stream fallback uses dane.generate." .

:Task_MessageResponse rdf:type :Task ;
  rdfs:label "Agent response generation" ;
  :performedByAgent :Agent_Dane ;
  :taskPrompt :Prompt_Chat_Response ;
  <http://purl.org/dc/terms/description> "Agent receives message, optional context: resourceId/threadId, and produces textual response. Supports streaming of text." .

:Prompt_Chat_Response rdf:type :Prompt ;
  rdfs:label "Chat agent prompt template" ;
  :promptInstruction "User message (free text) passed to Dane agent; agent must follow its master instructions and not reveal internal tool usage." ;
  :promptOutputIndicator "Free-text response; streaming possible" .

:Workflow_githubIssueLabeler rdf:type :WorkflowPattern ;
  rdfs:label "github-issue-labeler workflow" ;
  <http://purl.org/dc/terms/description> "Fetch GitHub issue contents, obtain available labels, ask agent to select labels and apply them via GitHub integration." ;
  :hasWorkflowStep :Step_getIssue , :Step_labelIssue , :Step_applyLabels .

:Step_getIssue rdf:type :WorkflowStep ;
  rdfs:label "getIssue" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Calls GitHub API to fetch issue title/body and repository labels." .

:Task_GetIssue rdf:type :Task ;
  rdfs:label "Fetch issue from GitHub" ;
  :performedBy :Tool_execaTool ;  # semantic placeholder: actual performed by GitHub integration client
  :taskPrompt :Prompt_Github_GetIssue ;
  <http://purl.org/dc/terms/description> "Uses GitHub integration to get issue and labels. Output: title, body, labelNames[]" .

:Prompt_Github_GetIssue rdf:type :Prompt ;
  rdfs:label "Get issue prompt" ;
  :promptInstruction "Retrieve GitHub issue title/body and list of label names for repo via GitHub API; exclude priority:* labels." ;
  :promptOutputIndicator "title: string, body: string, labelNames: string[]" .

:Step_labelIssue rdf:type :WorkflowStep ;
  rdfs:label "labelIssue" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Calls dane-issue-labeler to propose labels given issue title, body and available labels; expects { labels: string[] }." .

:Task_LabelIssue rdf:type :Task ;
  rdfs:label "Generate labels task" ;
  :performedByAgent :Agent_DaneIssueLabeler ;
  :taskPrompt :Prompt_IssueLabeler_Generate ;
  <http://purl.org/dc/terms/description> "Agent is prompted with issue title/body and available labels; returns labels array." .

:Prompt_IssueLabeler_Generate rdf:type :Prompt ;
  rdfs:label "issue labeler prompt" ;
  :promptInstruction """Hey Dane, given:
* this issue title: ${title}
* this issue body: ${body}
* these labels: ${labelNames}
What label or labels would you assign?""" ;
  :promptOutputIndicator "JSON: { labels: string[] }" .

:Step_applyLabels rdf:type :WorkflowStep ;
  rdfs:label "applyLabels" ;
  :stepOrder 3 ;
  <http://purl.org/dc/terms/description> "Uses GitHub API to add labels to issue based on agent output." .

:Task_ApplyLabels rdf:type :Task ;
  rdfs:label "Apply labels to GitHub issue" ;
  :performedBy :Tool_execaTool ; # semantic placeholder: performed by GitHub integration
  <http://purl.org/dc/terms/description> "Uses GitHub integration to add labels to issue." .

:Workflow_githubFirstContributor rdf:type :WorkflowPattern ;
  rdfs:label "github-first-contributor-message workflow" ;
  <http://purl.org/dc/terms/description> "On first contributor PR, generate welcoming message combining PR title, body, diff and Mastra docs; post as PR comment." ;
  :hasWorkflowStep :Step_getPullRequest , :Step_message_generator , :Step_create_message .

:Step_getPullRequest rdf:type :WorkflowStep ;
  rdfs:label "getPullRequest" ;
  :stepOrder 1 ;
  <http://purl.org/dc/terms/description> "Fetch PR metadata and diff via GitHub API; returns title, body, diff." .

:Task_GetPullRequest rdf:type :Task ;
  rdfs:label "Get pull request" ;
  :performedBy :Tool_execaTool ; # semantic placeholder for GitHub integration
  <http://purl.org/dc/terms/description> "Fetch PR via GitHub client and fetch diff URL to retrieve diff text." .

:Step_message_generator rdf:type :WorkflowStep ;
  rdfs:label "message-generator" ;
  :stepOrder 2 ;
  <http://purl.org/dc/terms/description> "Ask daneNewContributor agent to compose friendly message with checklist. Agent must not summarize nor give code advice; output structure: intro, checklist[], outro." .

:Task_GenerateContributorMessage rdf:type :Task ;
  rdfs:label "Generate new contributor message" ;
  :performedByAgent :Agent_DaneNewContributor ;
  :taskPrompt :Prompt_NewContributor_Message ;
  <http://purl.org/dc/terms/description> "Agent provided PR title/body/diff and Mastra docs; generate intro, checklist entries based on guidelines, and outro." .

:Prompt_NewContributor_Message rdf:type :Prompt ;
  rdfs:label "first contributor prompt" ;
  :promptInstruction """Hey Dane, given:
START TITLE
${title}
END TITLE

START BODY
${body}
END BODY
START DIFF
${diff}
END DIFF

MASTRA DOCS
${mastraDocs}
END MASTRA DOCS

Write message to the contributor to thank them for their first contribution? And check if the following guidelines are followed, do not mention these checklist if they are actually checked:
- Check if the body matches the diff and is not empty
- Check if tests are added or updated
- check if the code looks similar to what's already written
- Ask if they have tested the changes on any of the examples

VERY IMPORTANT:
You should not summarize nor you should give advice on the code itself, only follow the guidelines.

The message should be structured like:
an intro message to thank the user for their contribution
the checklist
and an outro that just says thank you again and that we will review it shortly. If there is no checklist we should skip thank you.
""" ;
  :promptOutputIndicator "JSON: { intro: string, checklist: string[], outro: string }" .

:Step_create_message rdf:type :WorkflowStep ;
  rdfs:label "create-message" ;
  :stepOrder 3 ;
  <http://purl.org/dc/terms/description> "Create comment on GitHub PR using generated message, forming checkboxes for checklist items." .

:Task_CreatePRComment rdf:type :Task ;
  rdfs:label "Create PR comment" ;
  :performedBy :Tool_execaTool ; # semantic placeholder for GitHub integration
  <http://purl.org/dc/terms/description> "Uses GitHub API to create a comment with intro, checklist as - [ ] items, and outro." .

#################################################################
# Relationships among agents (interactions) and team/system
#################################################################

:Team_Mastra rdf:type :Team ;
  rdfs:label "Mastra agent system" ;
  <http://purl.org/dc/terms/description> "Collection of agents and tools composing the CLI assistant 'Dane' and associated workflows." ;
  :hasAgentMember :Agent_Dane , :Agent_DaneCommitMessage , :Agent_DaneIssueLabeler , :Agent_DaneLinkChecker , :Agent_DanePackagePublisher , :Agent_DaneNewContributor ;
  :hasWorkflowPattern :Workflow_message , :Workflow_commitMessage , :Workflow_packagePublisher , :Workflow_telephoneGame , :Workflow_changelog , :Workflow_linkChecker , :Workflow_githubIssueLabeler , :Workflow_githubFirstContributor ;
  :hasSystemConfig :Config_DaneStorage , :Config_DaneStorage_URL .

# Agents that interact with each other
:Agent_Dane rdf:type :LLMAgent ;
  :interactsWith :Agent_DaneCommitMessage , :Agent_DaneIssueLabeler , :Agent_DaneLinkChecker , :Agent_DanePackagePublisher , :Agent_DaneNewContributor .

#################################################################
# Additional metadata and small resources
#################################################################

:Prompt_PNPM_Packages_List rdf:type :Prompt ;
  rdfs:label "packaging list prompt (agent planning step)" ;
  :promptInstruction """Please analyze the following monorepo directories and identify packages that need pnpm publishing:
CRITICAL: This step is about planning. We do not want to build anything. All packages MUST be placed in the correct order.
Publish Requirements:
- @mastra/core first, MUST be before any other package
- all packages in correct dependency order before building
- Identify packages that have changes requiring a new pnpm publish
- Include create-mastra in the packages list if changes exist
- EXCLUDE @mastra/dane from consideration
Please list all packages that need building grouped by their directory. DO NOT NOT USE the 'pnpmBuild' tool during this step.""" ;
  :promptOutputIndicator "Structured object grouping packages, integrations, deployers, combined_stores, speech (arrays of strings)" .

:Prompt_PNPM_BuildPlan rdf:type :Prompt ;
  rdfs:label "pnpm build execution plan" ;
  :promptInstruction """<build_execution>
  <context> The following packages need to be built in sequence: ${packages.join(', ')} </context>
  <execution_plan> ... (see source constraints: core packages sequential, others parallel) ... </execution_plan>
  <critical_rules> ... </critical_rules>
  </build_execution>""" ;
  :promptOutputIndicator "Execution plan and instructions to invoke pnpmBuild tool per package, and reporting format." .

#################################################################
# Tool usages by agents (linking agents to tools they use)
#################################################################

:Agent_Dane :agentToolUsage :Tool_fsTool , :Tool_execaTool , :Tool_browserTool , :Tool_googleSearch , :Tool_readPDF , :Tool_listEvents .
:Agent_DaneCommitMessage :agentToolUsage :Tool_fsTool .
:Agent_DaneLinkChecker :agentToolUsage :Tool_slackMCP .
:Agent_DanePackagePublisher :agentToolUsage :Tool_pnpmBuild , :Tool_pnpmChangesetStatus , :Tool_pnpmChangesetPublish , :Tool_activeDistTag .

#################################################################
# Example of resource usage linking
#################################################################

:Task_GetBrokenLinks :requiresResource :Resource_GeneratedChangelog .
:Task_Changelog_GetPerModule :requiresResource :Resource_GitRepository ;
  :producedResource :Resource_GeneratedChangelog .

#################################################################
# Related workflow pattern links where sequence semantics exist
#################################################################

:Step_getDiff :nextStep :Step_readConventionalCommitSpec .
:Step_readConventionalCommitSpec :nextStep :Step_generateMessage .
:Step_generateMessage :nextStep :Step_confirmation .
:Step_confirmation :nextStep :Step_commit .

#################################################################
# Labels and descriptions for human reference
#################################################################

:Agent_Dane rdfs:comment "Primary assistant agent used across interactive CLI commands and workflows." .
:Tool_slackMCP rdfs:comment "MCP Slack adapter: used to post messages to Slack channels as part of automation workflows." .
:Workflow_changelog rdfs:comment "Weekly changelog generator that scans many repository sub-modules and asks agent to summarize diffs." .

# End of instance population for the Mastra/Dane solution representation.